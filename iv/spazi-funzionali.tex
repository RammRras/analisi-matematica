\chapter{Spazi funzionali}
\label{ch:spazi-funzionali}

\section{Spazi $\lclass[p]$}
\label{sec:spazi-lp}
Gli spazi $\lclass[p]$ contengono le classi di equivalenza, rispetto alla relazione di uguaglianza quasi ovunque, di funzioni la cui $p$-esima potenza è sommabile: dato un insieme $\Omega\subseteq\R^n$ aperto, sono definiti come
\begin{equation*}
    \leb[p]{\Omega}\defeq\biggl\{f\colon\Omega\to\R\text{ misurabili tali che }\int_\Omega\abs{f}^p\,\dd\mu<+\infty\biggr\}
\end{equation*}
per $1\le p<+\infty$.
Per $p=+\infty$ si definisce invece lo spazio $\leb[\infty]{\Omega}$ come l'insieme delle classi di equivalenza di funzioni $f\colon\Omega\to\R$ misurabili tali che $\abs{f}$ è limitata quasi ovunque in $\Omega$.

\newcommand{\eqc}[1]{\hat{#1}} % Classe di equivalenza
Per il momento, distinguiamo la funzione $f$ dalla sua classe di equivalenza che indichiamo con $\eqc{f}$; tale $f$ è un \emph{rappresentante} della classe $\eqc{f}$.
Questi spazi sono spazi vettoriali: se $u,v\in\leb[p]{\Omega}$ e $p<+\infty$ allora si ha che, puntualmente, 
\begin{equation}
    \abs{u+v}^p\le(\abs{u}+\abs{v})^p\le
    \begin{cases*}
        (2\abs{u})^p & se $\abs{u}\ge\abs{v}$\\
        (2\abs{v})^p & se $\abs{u}\le\abs{v}$
    \end{cases*}
\end{equation}
perciò in ogni caso $\abs{u+v}^p\le 2^p(\abs{u}^p+\abs{v}^p)$.
Integrando su $\Omega$ otteniamo
\begin{equation}
    \int_\Omega \abs{u+v}^p\,\dd\mu\le
    \int_\Omega 2^p(\abs{u}^p+\abs{v}^p)\,\dd\mu=
    2^p\biggl(\int_\Omega \abs{u}^p\,\dd\mu + \int_\Omega \abs{v}^p\,\dd\mu\biggr)<+\infty
\end{equation}
dunque $u+v\in\leb[p]{\Omega}$.
È ovvio invece che per ogni $\alpha\in\R$ si ha che $\alpha f\in\leb[p]{\Omega}$ se $f\in\leb[p]{\Omega}$, per $1\le p\le+\infty$.

Introduciamo dunque una norma in questi spazi (chiamata spesso $p$-norma) definita come
\begin{equation}
    \norm{f}_p\defeq\biggl(\int_\Omega \abs{f}^p\,\dd\mu\biggr)^{\frac1{p}}
    \label{eq:p-norma-finita}
\end{equation}
per $1\le p<+\infty$ e per il caso $p=+\infty$ invece
\begin{equation}
    \norm{f}_\infty\defeq\esssup_{\vec x\in\Omega}\abs{f(\vec x)}=\inf\bigl\{M\colon\mu\bigl(\{\vec x\in\Omega\colon f(\vec x)>M\}\bigr)=0\bigr\}
    \label{eq:p-norma-infinita}
\end{equation}
Tali norme sono chiaramente ben definite, cioè sono sempre limitate, per $f\in\leb[p]{\Omega}$.
Verifichiamone le proprietà necessarie.
\begin{proprieta} \label{pr:norma}
    Per ogni $p\in[1,+\infty]$, $f,g\in\leb[p]{\Omega}$ e $\alpha\in\R$ valgono le seguenti proprietà:
    \begin{enumerate}
        \item $\norm{f}_p=0$ se e solo se $\eqc{f}=0$, ossia $f=0$ quasi ovunque;
        \item $\norm{\alpha f}_p=\abs{\alpha}\norm{f}_p$;
        \item $\norm{f+g}_p\le\norm{f}_p+\norm{g}_p$ (nota come \emph{disuguaglianza di Minkowski}).
    \end{enumerate}
\end{proprieta}
\begin{proof}
    Le prime due sono banali, quindi saltiamo direttamente alla terza.
    Se $p=+\infty$ è ancora elementare, cos\`i come i casi $\eqc{f}=0$ o $\eqc{g}=0$; siano dunque $\alpha\defeq\norm{f}_p$ e $\beta\defeq\norm{g}_p$, che assumiamo entrambi positivi.
    Siano $f_0$ e $g_0$ le ``normalizzazioni'' delle due funzioni date, ossia tali che $\abs{f}=\alpha f_0$ e $\abs{g}=\beta g_0$ e $\norm{f}_p=\norm{g}_p=1$.
    Detto $\lambda\defeq\frac{\alpha}{\alpha+\beta}$ abbiamo
    \begin{equation}
        \abs{f+g}^p\le
        \abs[\big]{\abs{f}+\abs{g}}^p=
        \abs{\alpha f_0+\beta g_0}^p=
        (\alpha+\beta)^p\bigl[\lambda f_0+(1-\lambda)g_0\bigr]^p
    \end{equation}
    (si noti che $1-\lambda=\frac{\beta}{\alpha+\beta}$).
    Dato che la mappa $t\mapsto t^p$ è convessa per $p\ge 1$, la combinazione convessa $(\alpha+\beta)^p\bigl[\lambda f_0+(1-\lambda)g_0\bigr]^p$ risulta minore o uguale a $\lambda f_0^p+(1-\lambda)g_0^p$, poich\'e il valore in un punto intermedio di $t^p$ è minore o uguale del corrispondente punto sulla retta secante la funzione.
    Con ciò risulta
    \begin{equation}
        \abs{f+g}^p\le
        (\alpha+\beta)^p\bigl[\lambda f_0^p+(1-\lambda)g_0^p\bigr]
    \end{equation}
    e integrando su $\Omega$ otteniamo
    \begin{equation}
        \begin{split}
            \norm{f+g}_p^p=&
            \int_\Omega \abs{f+g}^p\,\dd\mu\le\\\le&
            (\alpha+\beta)^p\int_\Omega\bigl[\lambda f_0^p+(1-\lambda)g_0^p\bigr]\,\dd\mu=\\=&
            (\alpha+\beta)^p\biggl[\lambda\int_\Omega f_0^p\,\dd\mu+(1-\lambda)\int_\Omega g_0^p\,\dd\mu\biggr]=\\=&
            (\alpha+\beta)^p\bigl[\lambda\norm{f_0}_p^p+(1-\lambda)\norm{g_0}_p^p\bigr]=\\=&
            (\alpha+\beta)^p=(\norm{f}_p+\norm{g}_p)^p
        \end{split}
    \end{equation}
    che prova la disuguaglianza.
\end{proof}
La grandezza definita dalle \eqref{eq:p-norma-finita} e \eqref{eq:p-norma-infinita} è dunque a tutti gli effetti una norma.
Vediamo ora un'altra disuguaglianza fondamentale.
Definiamo l'\emph{esponente coniugato} (o \emph{coniugato di H\"older}) di un numero reale $p>1$ il numero $p'$ tale che
\begin{equation}
    \frac1{p}+\frac1{p'}=1,
    \label{eq:coniugato-holder}
\end{equation}
o equivalentemente $p+p'=pp'$.
Se $p=1$ si definisce $1'=+\infty$, e viceversa $+\infty'=1$.
\begin{proprieta}[disuguaglianza di H\"older] \label{pr:disuguaglianza-holder}
    Sia $p\in[1,+\infty]$: per ogni $f\in\leb[p]{\Omega}$ e $g\in\leb[p']{\Omega}$ si ha che $fg\in\leb[1]{\Omega}$ e inoltre vale
    \begin{equation}
        \abs[\bigg]{\int_\Omega fg\,\dd\mu} \le \norm{f}_p\norm{g}_{p'}
        \label{eq:disuguaglianza-holder}
    \end{equation}
\end{proprieta}
\begin{proof}
    Se $p=1$ allora risulta
    \begin{equation}
        \abs[\bigg]{\int_\Omega fg\,\dd\mu}\le
        \int_\Omega\abs{fg}\,\dd\mu\le
        \int_\Omega\abs{f}\esssup_\Omega\abs{g}\,\dd\mu=
        \esssup_\Omega\abs{g}\int_\Omega\abs{f}\,\dd\mu=
        \norm{g}_\infty\norm{f}_1<+\infty
    \end{equation}
    e analogamente per $p=+\infty$, scambiando i ruoli di $p$ e $p'$.
    Se $p\in(1,+\infty)$, invece, è sufficiente considerare i casi $f\ge 0$ e $g\ge 0$ (tanto dobbiamo calcolare il valore assoluto dell'integrale).
    Sia dunque $h\defeq g^{p'-1}$, che equivale a $g^{p'/p}$: risulta anche
    \begin{equation}
        g=h^{\frac1{p'-1}}=h^{p-1}=h^{p/p'}.
    \end{equation}
    Consideriamo ora $t>0$ e la grandezza $tpfg$, che è poi $tpfh^{p-1}$: risulta\footnote{
        Per ogni $a,b\ge 0$ e $1\le p<+\infty$ si ha $a^p+pba^{p-1}\le(a+b)^p$.
        Prendiamo infatti le due funzioni $\alpha(b)\defeq a^p+pba^{p-1}$ e $\beta(b)\defeq (a+b)^p$: vale $\alpha(0)=\beta(0)=a^p$, ma $\beta'(b)=p(a+b)^{p-1}\ge pa^{p-1}=\alpha'(b)$ $\forall b\ge 0$, dunque $\alpha(b)\le\beta(b)$ $\forall b\ge 0$.
    }
    \begin{equation}
        ptfh^{p-1} \le (h-tf)^p-h^p
    \end{equation}
    e integrando troviamo
    \begin{multline}
        pt\int_\Omega fg\,\dd\mu\le
        \int_\Omega (h+tf)^p\dd\mu-\int_\Omega h^p\,\dd\mu=
        \int_\Omega \abs{h+tf}^p\dd\mu-\int_\Omega \abs{h}^p\,\dd\mu=\\=
        \norm{h+tf}_p^p-\norm{h}_p^p\le
        \bigl(\norm{h}_p+t\norm{f}_p\bigr)^p-\norm{h}_p^p
    \end{multline}
    Osserviamo che entrambi i membri della disuguaglianza, come funzioni di $t$, assumono lo stesso valore (zero) per $t\to 0$.
    Affinch\'e la disuguaglianza sia vera dovrà allora essere che la derivata del primo membro, per $t=0$, sia minore o uguale della derivata del secondo membro, ossia
    \begin{multline}
        p\int_\Omega fg\,\dd\mu\le
        p\bigl(\norm{h}_p+t\norm{f}_p\bigr)^{p-1}\norm{f}_p\Big\rvert_{t=0}=
        p\norm{h}_p^{p-1}\norm{f}_p=\\=
        p\norm{f}_p\biggl(\int_\Omega \abs{h}^p\,\dd\mu\biggr)^{\frac{p-1}{p}}=
        p\norm{f}_p\biggl(\int_\Omega \abs{g}^{p'}\,\dd\mu\biggr)^{\frac1{p'}}=p\norm{f}_p\norm{g}_{p'}
    \end{multline}
    da cui segue la tesi.
\end{proof}

\section{Convergenza}
Dato uno spazio vettoriale normato $X$ (come gli $\lclass[p]$, ma ne esistono altri) e una successione $\{u_n\}_{n\in\N}\subset X$, diciamo che essa \emph{converge in norma} al limite $u\in X$ se $\norm{u_n-u}_X\to 0$ per $n\to +\infty$.
Pe spazi di funzioni possiamo anche trovare la convergenza puntuale, per cui $u_n\to u$ se vale $u_n(\vec x)\to u(\vec x)$ per ogni $\vec x$ (eventualmente quasi ovunque) nel dominio delle funzioni.
Riserveremo il simbolo $\to$ per la convergenza in norma, se non indicato altrimenti.

Lo spazio $\leb[1]{\Omega}$ contiene classi di equivalenza di funzioni sommabili, quindi per tali funzioni si applica tutto ciò che abbiamo visto nella sezione \ref{sec:integrale-lebesgue}, in particolare i teoremi della convergenza dominata e monotona.
Questi due teoremi hanno una facile generalizzazione agli spazi $\lclass[p]$ per $p>1$: innanzitutto è necessaria una versione raffinata del teorema di Beppo Levi, di cui non diamo la dimostrazione.
\begin{teorema}[Beppo-Levi; della convergenza monotona] \label{t:convergenza-monotona-L1}
    Sia $\Omega\in\mis(\R^n)$ e $\{f_n\}_{n\in\N}$ una successione di funzioni tali che $f_n\in\leb[1]{\Omega}$ per ogni $n\in\N$, $f_n(\vec x)\le f_{n+1}(\vec x)$ quasi ovunque in $\Omega$, e la successione $\norm{f_n}_1$ sia limitata.
    Allora $f_n$ converge in norma e puntualmente quasi ovunque in $\Omega$ a una funzione $f\in\leb[1]{\Omega}$.
\end{teorema}
La funzione limite sarà, per il teorema di permanenza del segno, quasi ovunque non negativa.
\begin{teorema} \label{t:convergenza-monotona-Lp}
    Sia $\Omega\in\mis(\R^n)$ e $\{f_n\}_{n\in\N}\subset\leb[p]{\Omega}$ una successione di funzioni a valori non negativi quasi ovunque non decrescente, ossia per cui $f_n(\vec x)\le f_{n+1}(\vec x)$ quasi ovunque in $\Omega$ per ogni $n\in\N$, e tale che la successione $\norm{f_n}_p$ sia limitata.
    Allora $f_n$ converge in norma e puntualmente quasi ovunque in $\Omega$ a una funzione $f\in\leb[p]{\Omega}$.
\end{teorema}
\begin{proof}
    Dato che $f_n\in\leb[p]{\Omega}$ si ha $f_n^p\in\leb[1]{\Omega}$, e perciò $\norm{f_n^p}_1$ forma, per $n\in\N$, una successione limitata dato che
    \begin{equation}
        \norm{f_n^p}_1=\int_\Omega\abs{f_n^p}\,\dd\mu=\int_\Omega\abs{f_n}^p\,\dd\mu=\norm{f_n}_p^p.
    \end{equation}
    Per il teorema della convergenza monotona appena visto allora esiste $g\in\leb[1]{\Omega}$, a valori non negativi, tale che $f_n^p\to g$ e anche puntualmente quasi ovunque in $\Omega$.
    Sia dunque $f\defeq g^{1/p}$, che appartiene ovviamente a $\leb[p]{\Omega}$; per quanto appena visto $\norm{f^p-f_n^p}_1\to 0$ per $n\to +\infty$.
    Dato che la successione $\{f_n\}$ è non decrescente, $f_n\le f$ quasi ovunque da cui\footnote{
        Se $0\le a\le b$ e $p\ge 1$ allora $(b-a)^p\le b^p-a^p$: infatti, presa la funzione $\gamma(b)\defeq b^p-a^p-(b-a)^p$, troviamo che $\gamma'(b)=pb^{p-1}-p(b-a)^{p-1}$ è non negativa per $a\le b$, e $\gamma(a)=0$, si ha per tutti gli $a\le b$ che $\gamma(b)\ge 0$ ossia $b^p-a^p\ge(b-a)^p$.
    }
    \begin{equation}
        \norm{f-f_n}_p^p=
        \int_\Omega(f-f_n)^p\,\dd\mu\le
        \int_\Omega(f^p-f_n^p)\,\dd\mu=
        \norm{f^p-f_n^p}_1
    \end{equation}
    che tende a zero per $n\to+\infty$, quindi si ha anche $\lim_{n\to+\infty}\norm{f-f_n}_p=0$.
\end{proof}
\begin{teorema} \label{t:convergenza-dominata-Lp}
    Sia $\Omega\in\mis(\R^n)$ e $\{f_n\}_{n\in\N}\subset\leb[p]{\Omega}$ una successione di funzioni convergente quasi ovunque in $\Omega$ a un limite (misurabile) $f$.
    Se esiste una funzione $g\in\leb[p]{\Omega}$ tale che per ogni $n\in\N$ si abbia $\abs{f_n}\le g$ quasi ovunque in $\Omega$, allora $\lim_{n\to+\infty}\norm{f_n-f}_p=0$.
\end{teorema}
\begin{proof}
    Se $f_n\in\leb[p]{\Omega}$ allora $f_n^p\in\leb[1]{\Omega}$.
    Per il teorema di permanenza del segno si ha, quasi ovunque in $\Omega$, che $\abs{f}\le g$, e ovviamente $\abs{f_n}^p\le g^p$ e $\abs{f}^p\le g^p$.
    Allora per la disuguaglianza triangolare $\abs{f_n-f}^p\le(\abs{f_n}-\abs{f})^p\le(2g)^p$.
    La successione $h_n\defeq\abs{f_n-f}^p$ è, per le ipotesi, convergente quasi ovunque puntualmente a zero, ed è maggiorata da $(2g)^p$ che è sommabile.
    Per il teorema \ref{t:convergenza-dominata} della convergenza dominata allora
    \begin{equation}
        0=\lim_{n\to+\infty}\int_\Omega\abs{h_n-0}\,\dd\mu=
        \lim_{n\to+\infty}\int_\Omega\abs{h_n}\,\dd\mu=
        \lim_{n\to+\infty}\int_\Omega\abs{f_n-f}^p\,\dd\mu=
    \end{equation}
    ossia $\norm{f_n-f}_p\to 0$.
\end{proof}

Uno spazio normato completo è uno \emph{spazio di Banach}, e gli spazi $\lclass[p]$ ne sono un esempio fondamentale.
\begin{teorema}[Riesz-Fischer] \label{t:riesz-fischer}
    Per ogni insieme aperto $\Omega\subseteq\R^n$ e per ogni $p\in[1,+\infty]$ lo spazio $\leb[p]{\Omega}$ è completo.
\end{teorema}
\begin{proof}
    Prendiamo una successione $\{f_n\}_{n\in\N}\subset\leb[p]{\Omega}$ di Cauchy: fissato $\epsilon>0$ esiste $\bar{n}=\bar{n}(\epsilon)$ tale che $\norm{f_n-f_m}_p>\epsilon$ per ogni $n,m>\bar{n}$.
    Sarà sufficiente dimostrare che esiste una sottosuccessione $\{f_{n_k}\}\subset\{f_n\}$ convergente in norma a un limite $f$ affinch\'e $f_n$ converga in norma alla stessa $f$: infatti se $\norm{f_{n_k}-f}_p\to 0$ allora risulta
    \begin{equation}
        \norm{f_n-f}_p \le \norm{f_n-f_{n_k}}_p+\norm{f_{n_k}-f}_p<2\epsilon
    \end{equation}
    se $n,n_k>\bar{n}$, per la condizione di Cauchy e per la convergenza di $f_{n_k}$.

    Costruiamo dunque una buona sottosuccessione: sia $k_1$ tale che $\norm{f_{k_1}-f_n}_p<\frac12$ per ogni $n\ge k_1$, il che è possibile se $k_1$ è sufficientemente grande scegliendo $\epsilon=\frac12$ nella condizione di Cauchy; sia poi $k_2$ tale che $\norm{f_{k_2}-f_n}_p<\frac14$ per ogni $n\ge k_2$, e cos\`i via prendendo $k_i$ tale che $\norm{f_{k_i}-f_n}_p<2^{-i}$ per ogni $n\ge k_i$.
    In particolare, risulta che $\norm{f_{k_i}-f_{k_{i+1}}}_p\le 2^{-i}$ poich\'e $k_{i+1}\ge k_i$ per ogni $i$.
    Definiamo ora la funzione
    \begin{equation}
        F_j\defeq\abs{f_{k_1}}+\sum_{i=1}^j\abs{f_{k_i}-f_{k_{i+1}}}
    \end{equation}
    (se $j=1$ si ha $F_1=\abs{f_{k_1}}$, e via via si aggiungono i termini della somma): risulta per la disuguaglianza triangolare che
    \begin{equation}
        \norm{F_j}_p \le \norm{f_{k_1}}_p+\sum_{i=1}^j\norm{f_{k_i}-f_{k_{i+1}}}_p = \norm{f_{k_1}}_p+\sum_{i=1}^j\frac1{2^i} = \norm{f_{k_1}}_p+1,
    \end{equation}
    per ogni $j\in\N$, e notiamo che $\{F_j\}_{j\in\N}$ è una successione crescente di funzioni non negative: per il teorema \ref{t:convergenza-monotona-Lp} della convergenza monotona allora $F_j$ converge a un limite $F\in\leb[p]{\Omega}$, dato che $\norm{F_j}_p$ è una successione (in $j$) limitata.
    
    Tornando alla sottosuccessione $\{f_{n_k}\}$, abbiamo che per ogni $i\in\N$
    \begin{equation}
        f_{k_{i+1}}=f_{k_1}+f_{k_2}-f_{k_1}+\dotsb+f_{k_{i+1}}-f_{k_i}
    \end{equation}
    quindi con la disuguaglianza triangolare si ha quasi ovunque che
    \begin{equation}
        \abs{f_{k_{i+1}}} \le \abs{f_{k_1}}+\abs{f_{k_2}-f_{k_1}}+\dotsb+\abs{f_{k_{i+1}}-f_{k_i}} = \abs{f_{k_1}}+\sum_{l=1}^i\abs{f_{l+1}-f_l} \le F
    \end{equation}
    dunque la sottosuccessione è limitata e non decrescente, per cui converge puntualmente (sempre quasi ovunque) ad un certo limite $f$; ma ogni $f_{n_k}$ è limitata da $F\in\leb[p]{\Omega}$ quindi per il teorema \ref{t:convergenza-dominata-Lp} della convergenza dominata si ha che anche il limite $f$ appartiene a $\leb[p]{\Omega}$, da cui la tesi.
\end{proof}

Se $f\in\leb[p]{\Omega}$, dimostriamo ora che $f$ è ``vicina'' a una funzione semplice, ma anche a una funzione continua, vale a dire che gli insiemi di tali funzioni sono densi in $\leb[p]{\Omega}$: per ogni $\epsilon>0$ esiste una funzione semplice $s$ o una funzione continua $\phi$ definite su $\Omega$ tali che $\norm{f-s}_p<\epsilon$ e $\norm{f-\phi}_p<\epsilon$.
\begin{teorema} \label{t:funzioni-semplici-dense}
    L'insieme delle funzioni semplici $s\colon\Omega\to\R$ è denso in $\leb[p]{\Omega}$.
\end{teorema}
\begin{proof}
    È sufficiente considerare le funzioni semplici a valori non negativi: per il caso generale, si scomponga la funzione nelle sue parti positiva e negativa.
    Sia $\mathcal{S}$ tale insieme: possiamo rappresentare una generica $s\in\mathcal{S}$ come $\sum_{j=1}^mc_j\chi_{A_j}$ per $c_j\ge 0$ e $A_j\in\mis(\R^n)$ disgiunti.
    Se $\Omega$ è limitato allora $s\in\leb[p]{\Omega}$ poich\'e
    \begin{multline}
        \norm{s}_p^p=
        \int_\Omega\abs[\bigg]{\sum_{j=1}^mc_j\chi_{A_j}}^p\dd\mu\le
        \int_\Omega\sum_{j=1}^mc\abs{c_j\chi_{A_j}}^p\dd\mu\le
        \sum_{j=1}^m\int_\Omega(\abs{c_j}\chi_{A_j})^p\dd\mu=\\=
        \sum_{j=1}^m\int_\Omega\abs{c_j}^p\chi_{A_j}\dd\mu=
        \sum_{j=1}^m\abs{c_j}^p\int_\Omega\chi_{A_j}\dd\mu=
        \sum_{j=1}^m\abs{c_j}^p\mu(A_j)<
        +\infty.
    \end{multline}
    Sappiamo già dal teorema \ref{t:funzione-semplice-misurabile} che per ogni $f\colon\Omega\to[0,+\infty)$ misurabile esiste una successione $\{s_n\}_{n\in\N}\subset\mathcal{S}$ tale che $s_n\le s_{n+1}\le f$ in $\Omega$ e che converge a $f$ quasi ovunque: detti $E_{n,i}\defeq f^{-1}\Bigl(\bigl[\frac{i-1}{2^n},\frac{i}{2^n}\bigr]\Bigr)$ e $F_n\defeq f^{-1}\bigl([n,+\infty)\bigr)$ si ha che la successione
        \begin{equation}
            s_n\defeq\sum_{i=1}^{n2^n}\frac{i-1}{2^n}\chi_{E_{n,i}}+n\chi_{F_n}
        \end{equation}
        soddisfa queste proprietà e pertanto $\abs{f-s_n}^p\le\abs{f}^p\in\leb[1]{\Omega}$, ma allora per il teorema \ref{t:convergenza-dominata-Lp} della convergenza dominata si ha $\norm{s_n-f}_p\to 0$ per $n\to+\infty$.
\end{proof}
Per le funzioni continue dobbiamo porre qualche restrizione: l'affermazione che $\cont{\Omega}$ è denso in $\leb[p]{\Omega}$ è evidentemente falsa, perch\'e non ne è nemmeno un sottoinsieme; è sufficiente prendere $\Omega=(0,1)$ e la funzione $x\mapsto\frac1{x}$, che è continua ma non sommabile.
Introduciamo allora il \emph{supporto} di una funzione $f\colon\Omega\to\R$, ossia l'insieme
\begin{equation*}
    \supp f\defeq\clos{\{\vec x\in\Omega\colon f(\vec x)\ne 0\}}
\end{equation*}
e con esso l'insieme delle \emph{funzioni a supporto compatto}, ossia l'insieme
\begin{equation*}
    \contsc{\Omega}\defeq\{f\in\cont{\Omega}\colon \supp f\subset\Omega\}
\end{equation*}
delle cui funzioni il supporto è chiuso --- per definizione --- e limitato perch\'e sottoinsieme di $\Omega$, quindi compatto: tali funzioni sono nulle in un intorno dei punti di $\boundary\Omega$.
\begin{teorema}[Lusin] \label{t:lusin}
    Sia $f\colon\Omega\to\R$ misurabile, e $A\subset\Omega$ con $\mu(A)<+\infty$ e $\supp f\subset A$.
    Per ogni $\epsilon>0$ esiste $g_\epsilon\in\contsc{\Omega}$ tale che $\mu\bigl(\{\vec x\in\Omega\colon f(\vec x)\ne g_\epsilon(\vec x)\}\bigr)<\epsilon$, inoltre la si può scegliere tale che $\sup_\Omega\abs{g_\epsilon}\le\norm{f}_{\infty}$.
\end{teorema}
\begin{teorema} \label{t:funzioni-continue-supporto-compatto-dense}
    L'insieme $\contsc{\Omega}$ è denso in $\leb[p]{\Omega}$.
\end{teorema}
\begin{proof}
    Una volta dimostrata la densità nell'insieme delle funzioni semplici, per il teorema \ref{t:funzioni-semplici-dense} il risultato vale anche per tutto $\leb[p]{\Omega}$.
    Sia $s\colon\Omega\to\R$ semplice: per il teorema precedente, $\forall\epsilon>0$ $\exists g_\epsilon\in\contsc{\Omega}$ tale che $g_\epsilon=s$ tranne che su un insieme $A_\epsilon$ con $\mu(A_\epsilon)<\epsilon$, e per la quale $\abs{g_\epsilon}\le\norm{s}_\infty=\sup_\Omega s$.
    Allora
    \begin{multline}
        \norm{g_\epsilon-s}_p=
        \biggl(\int_\Omega\abs{g_\epsilon-s}^p\,\dd\mu\biggr)^\frac1{p}=
        \biggl(\int_{A_\epsilon}\abs{g_\epsilon-s}^p\,\dd\mu\biggr)^\frac1{p}\le
        \biggl(\int_{A_\epsilon}(\abs{g_\epsilon}+\abs{s})^p\,\dd\mu\biggr)^\frac1{p}\le\\ \le
        \biggl(\int_{A_\epsilon}2^p\norm{s}_\infty^p\,\dd\mu\biggr)^\frac1{p}=
        2\norm{s}_\infty\bigl(\mu(A_\epsilon)\bigr)^\frac1{p}<
        2\norm{s}_\infty\epsilon^\frac1{p}.
    \end{multline}
    Per $f\in\leb[p]{\Omega}$, si ha quindi
    \begin{equation}
        \norm{f-g_\epsilon}_p\le
        \norm{f-s}_p+\norm{s-g_\epsilon}_p<
        \epsilon+\epsilon=
        2\epsilon.\qedhere
    \end{equation}
\end{proof}
La densità di $\contsc{\Omega}$ si può anche scrivere come $\clos{\contsc{\Omega}}\equiv\leb[p]{\Omega}$, dove la chiusura è presa rispetto alla distanza data da $\norm{\cdot}_p$: in altre parole, ``aggiungendo i limiti'' nella norma $\norm{\cdot}_p$ a $\contsc{\Omega}$ (che, da solo, non è completo) si ottiene $\leb[p]{\Omega}$.

\section{Spazi duali}
Vediamo ora alcune generalità sugli spazi duali a spazi normati, che poi applicheremo agli insiemi $\lclass[p]$.
\begin{definizione} \label{d:mappa-lineare-continua-limitata}
    Siano $(X,\norm{\cdot}_X)$ e $(Y,\norm{\cdot}_Y)$ due spazi normati: una mappa $f\colon X\to Y$ è detta
    \begin{itemize}
        \item \emph{lineare} se $f(ax+by)=af(x)+bf(y)$ per ogni $x,y\in X$ e $a,b\in\R$;
        \item \emph{limitata} se esiste $M>0$ tale per cui $\norm{f(x)}_Y\le M\norm{x}_X$ per ogni $x\in X$;
        \item \emph{continua} in un punto $x_0\in X$ se $\forall\epsilon>0$ $\exists\delta>0$ tale che se $\norm{x-x_0}_X<\delta$ allora $\norm{f(x)-f(x_0)}_Y<\epsilon$.
    \end{itemize}
\end{definizione}
\begin{teorema} \label{t:continuita-limitatezza-linearita}
    Se $(X,\norm{\cdot}_X)$ e $(Y,\norm{\cdot}_Y)$ sono due spazi normati e $f\colon X\to Y$ è una mappa lineare, allora le seguenti sono equivalenti:
    \begin{enumerate}
        \item $f$ è limitata;
        \item $f$ è continua in un punto;
        \item $f$ è continua ovunque.
    \end{enumerate}
\end{teorema}
\begin{proof}
    Sia $f$ limitata: se esiste $M>0$ per cui $\norm{f(x)}_Y\le M\norm{x}_X$ per ogni $x\in X$, allora $\forall\epsilon>0$, per $x\in X$ tali che $\norm{x}_X<\delta\defeq\frac{\epsilon}{M}$ si ha
    \begin{equation}
        \norm{f(x)}_Y<M\frac{\epsilon}{M}=\epsilon
    \end{equation}
    quindi $f$ è continua in $0$ ($\in X$).

    Sia ora $f$ continua in $x_0$: preso $\epsilon>0$ esiste $\delta>0$ per cui $\norm{x-x_0}_X<\delta$ implica $\norm{f(x)-f(x_0)}_Y<\epsilon$.
    Sia $x_1$ un qualsiasi altro punto di $X$: se $\norm{x-x_1}_X<\delta$, allora $\delta>\norm{x-x_1-x_0+x_0}_X=\norm{(x+x_0-x_1)-x_0}_X$ e di conseguenza
    \begin{equation}
        \epsilon>\norm{f(x+x_0-x_1)-f(x_0)}_Y=
        \norm{f(x)-f(x_1)}_Y
    \end{equation}
    per linearità, perciò $f$ è continua anche in $x_1$.

    Sia infine $f$ continua ovunque: sfrutando la continuità in $0\in X$, $\forall\epsilon>0$ $\exists\delta>0$ per cui $\norm{x}_X<\delta$ implica $\norm{f(x)}_Y<\epsilon$.
    Scelto $\epsilon=1$, si ha
    \begin{equation}
        \norm{f(x)}_Y=
        \norm[\bigg]{\frac{2\norm{x}_X}{\delta}f\biggl(\frac{\delta x}{2\norm{x}_X}\biggr)}_Y=
        \frac{2\norm{x}_X}{\delta}\norm[\bigg]{f\biggl(\frac{\delta x}{2\norm{x}_X}\biggr)}_Y<
        \frac{2\norm{x}_X}{\delta}
    \end{equation}
    data la continuità in $0$, siccome $\norm[\big]{\frac{\delta x}{2\norm{x}_X}}_X=\frac{\delta}2<\delta$: allora $f$ è limitata (con $M=\frac2{\delta}$).
\end{proof}
Di conseguenza una mappa lineare continua è sempre anche lipschitziana, dato che $M$ non dipende da $x$.

Di particolare interesse sono le mappe di questo tipo in cui $Y$ è $\R$ con la distanza euclidea, ossia i \emph{funzionali lineari e continui}; lo spazio di queste funzioni è lo \emph{spazio duale} di $X$, indicato con $\dual{X}$.
Dotato delle operazioni di somma e moltiplicazione per scalare
\begin{equation}
    \begin{gathered}
        f+g\colon x\mapsto (f+g)(x)=f(x)+g(x)\\
        \alpha f\colon x\mapsto (\alpha f)(x)=\alpha f(x)
    \end{gathered}
\end{equation}
l'insieme $\dual{X}$ è uno spazio vettoriale su $\R$.
Definiamo la seguente funzione da $\dual{X}$ a $\R$:
\begin{equation}
    \norm{f}\defeq\sup_{x\in X\setminus\{0\}}\frac{\abs{f(x)}}{\norm{x}_X}
    \label{eq:norma-funzionale}
\end{equation}
che per la linearità è equivalente a $\sup_{x\in X\colon \norm{x}_X=1}\abs{f(x)}$.
Questa quantità è evidentemente sempre finita per i funzionali limitati.
\begin{proprieta} \label{pr:norma-funzionale}
    La funzione $\norm{\cdot}\colon\dual{X}\to\R$ definita dalla \eqref{eq:norma-funzionale} è una norma.
\end{proprieta}
\begin{proof}
    Dimostriamo le tre proprietà date nella \ref{d:norma}.
    \begin{itemize}
        \item Se $f\in\dual{X}$ è il funzionale nullo, allora $\norm{f}=\sup_{x\in X\setminus\{0\}}\abs{f(x)}=\sup_{x\in X\setminus\{0\}}0=0$; viceversa, se $\norm{f}=0$ allora $\sup_{x\in X\setminus\{0\}}\abs{f(x)}=0$ e di conseguenza, siccome chiaramente $\abs{f(x)}>0$, si ha $f(x)=0$ $\forall x\in X$ da cui $f=0$.
        \item Per $\alpha\in\R$ e $f\in\dual{X}$ si ha
            \begin{equation}
                \norm{\alpha f}=
                \sup_{x\in X\setminus\{0\}}\abs{\alpha f(x)}=
                \abs{\alpha}\sup_{x\in X\setminus\{0\}}\abs{f(x)}=
                \abs{\alpha}\norm{f}.
            \end{equation}
        \item Per ogni $f,g\in\dual{X}$ si ha
            \begin{multline}
                \norm{f+g}=
                \sup_{x\in X\setminus\{0\}}\abs{f(x)+g(x)}\le
                \sup_{x\in X\setminus\{0\}}\bigl(\abs{f(x)}+\abs{g(x)}\bigr)\le\\ \le
                \sup_{x\in X\setminus\{0\}}\abs{f(x)}+\sup_{x\in X\setminus\{0\}}\abs{g(x)}=
                \norm{f}+\norm{g}.\qedhere
            \end{multline}
    \end{itemize}
\end{proof}
Lo spazio duale è quindi, con questa funzione, anche uno spazio normato.

Grazie ai funzionali lineari continui possiamo definire una nuova nozione di convergenza.
\begin{definizione} \label{d:convergenza-debole}
    Sia $\{x_n\}_{n\in\N}$ una successione in $X$: diciamo che essa \emph{converge debolmente} a un elemento $\bar{x}\in X$, e indichiamo ciò con $x_n\weakto\bar{x}$, se per ogni $f\in\dual{X}$ si ha
    \begin{equation}
        \lim_{n\to+\infty}f(x_n)=f(\bar{x}).
        \label{eq:convergenza-debole}
    \end{equation}
\end{definizione}
In contrasto, la convergenza in norma è detta \emph{convergenza forte}.
Questo suggerisce qualche proprietà.
\begin{proprieta} \label{pr:convergenza-forte-implica-debole}
    Sia $\{x_n\}_{n\in\N}\subset X$ una successione tale che $x_n\to\bar{x}$ per un $\bar{x}\in X$.
    Allora $x_n\weakto\bar{x}$.
\end{proprieta}
\begin{proof}
    Sia $f\in\dual{X}$: risulta dalla definizione della norma di $f$ che
    \begin{equation}
        \abs{f(x_n)-f(\bar{x})}=
        \abs{f(x_n-\bar{x})}\le
        \norm{f}\norm{x_n-\bar{x}}_X
    \end{equation}
    che tende a zero per $n\to+\infty$, perciò $x_n$ converge anche debolmente (e \emph{al medesimo limite}).
\end{proof}
Non vale invece l'implicazione inversa: può esistere un limite debole senza che la successione converga in norma (vedremo qualche esempio più tardi).
Questo è un comportamento tipico degli spazi di dimensione infinita: in spazi di dimensione finita convergenza forte e debole sono del tutto equivalenti.

Specializziamo ora la teoria agli spazi di funzioni: prendiamo $\Omega\subset\R^n$ aperto e $X=\leb[p]{\Omega}$.
Un naturale funzionale lineare su questi spazi è dato da una funzione $f\in\leb[q]{\Omega}$ con $q=p'$ (il coniugato di Hölder, come nella \eqref{eq:coniugato-holder}), tramite la quale si definisce il funzionale\label{pag:norma-funzionale-lineare}
\begin{equation}
    F_f\colon g\mapsto\int_\Omega fg\,\dd\mu.
\end{equation}
È ovviamente lineare, ed è limitato poich\'e, dalla disuguaglianza di Hölder,
\begin{equation}
    \abs{F_f(g)}=
    \abs[\bigg]{\int_\Omega fg\,\dd\mu}\le
    \norm{f}_q\norm{g}_p
\end{equation}
da cui otteniamo
\begin{equation}
    \norm{F_f}=
    \sup_{g\in\leb[p]{\Omega}\setminus\{0\}}\frac{\abs{F_f(g)}}{\norm{g}_p}\le
    \sup_{g\in\leb[p]{\Omega}\setminus\{0\}}\norm{f}_q=
    \norm{f}_q.
\end{equation}
In particolare, se prendiamo $\tilde{g}\defeq\abs{f}^{q/p}\sgn f$ (con $\sgn f\defeq 0$ se $f=0$) risulta
\begin{multline}
    F_f(\tilde{g})=
    \int_\Omega f\tilde{g}\,\dd\mu=
    \int_\Omega \abs{f}^{q/p+1}\,\dd\mu=
    \int_\Omega \abs{f}^q\,\dd\mu=
    \norm{f}_q^q=
    \norm{f}_q\norm{f}_q^{q-1}=\\=
    \norm{f}_q\norm{\tilde{g}^{p/q}}_q^{q-1}=
    \norm{f}_q\biggl(\int_\Omega \abs{\tilde{g}}^p\,\dd\mu\biggr)^{\frac{q-1}{q}}=
    \norm{f}_q\biggl(\int_\Omega \abs{\tilde{g}}^p\,\dd\mu\biggr)^{\frac1{p}}=
    \norm{f}_q\norm{\tilde{g}}_p
\end{multline}
perciò
\begin{equation}
    \frac{\abs{F_f(\tilde{g})}}{\norm{\tilde{g}}_p}=\norm{f}_q
\end{equation}
e si ha l'uguaglianza $\norm{F_f}=\norm{f}_q$.
A questo punto è naturale chiedersi se \emph{tutti} i funzionali di $\dual{\leb[p]{\Omega}}$ siano di questa forma: la risposta è \emph{s\`i}, ma solo per $1\le p<+\infty$.
Lo spazio $\leb[\infty]{\Omega}$ è un caso particolare, su cui torneremo più avanti.

Vediamo ora alcuni esempi di successioni di $\leb[p]{\Omega}$ che convergono debolmente ma non in norma.
\begin{esempio} \label{es:convergenza-debole-ma-non-forte}
   Sia $\Omega=(0,1)$.
   \begin{itemize}
       \item Consideriamo $f_k(x)=\sin(k\pi x)$: sono funzioni che, al crescere di $k$, oscillano sempre di più.
           La successione $\{f_k\}_{k\in\N}$ converge debolmente a zero, ma $\norm{f_k}_p\not\to 0$.
       \item Possiamo considerare una successione che ``esplode'' in un certo punto, come $f_k(x)=k^\frac1{p}g(kx)$ per una funzione $g\in\leb[p]{\Omega}$ fissata.
           Chiaramente $\{f_k\}_{k\in\N}\subset\leb[p]{\Omega}$, e si dimostra che $f_k\weakto 0$, ma $\norm{f_k}_p=\norm{g}_p$ che certamente non tende a zero.
           Se entrambi i limiti esistessero, dovrebbero coincidere, e qui non accade.
           In un certo senso, la $f_k$ converge alla delta di Dirac, che però non è un elemento di $\leb[p]{\Omega}$ (non è nemmeno una funzione!).
       \item Fissata $g\in\leb[p]{\Omega}$, consideriamo la successione delle ``traslate'' $f_k(x)=g(x+k)$.
           Anche qui $f\weakto 0$ e $\norm{f_k}_p=\norm{g}_p\not\to 0$.
   \end{itemize}
\end{esempio}

\begin{lemma} \label{l:funzionali-separano-Lp}
    Sia $g\in\leb[p]{\Omega}$ tale che $F(g)=0$ per ogni $F\in\dual{\leb[p]{\Omega}}$: allora $g=0$.
\end{lemma}
\begin{proof}
    Fissiamo $g\in\leb[p]{\Omega}$ con $p\in(1,+\infty)$ e definiamo $h\defeq\abs{g}^{p-2}g$; risulta per $q=p'$
    \begin{equation}
        \int_\Omega \abs{f}^q\,\dd\mu=
        \int_\Omega \abs{g}^{(p-1)q}\,\dd\mu=
        \int_\Omega \abs{g}^p\,\dd\mu<
        +\infty
    \end{equation}
    perciò $f\in\leb[q]{\Omega}$.
    Associamo dunque a $f$ il funzionale lineare continuo $F\colon g\mapsto\int_\Omega fg\,\dd\mu$: per ipotesi deve essere $F(g)=0$, ma questo significa che $0=\int_\Omega\abs{g}^p\,\dd\mu=\norm{g}_p^p$ ossia $g=0$.
\end{proof}
In altre parole si dice che i funzionali lineari continui «separano» gli elementi di $\leb[p]{\Omega}$, poich\'e se $g,h\in\leb[p]{\Omega}$ sono tali per cui $F(g)=F(h)$ per ogni $F\in\dual{\leb[p]{\Omega}}$ allora $g=h$, mentre se esiste anche un solo elemento $F$ del duale per cui $F(g)\ne F(h)$ allora deve essere $g\ne h$.
\begin{teorema}[principio di limitatezza uniforme] \label{t:limitatezza-uniforme}
    Sia $\{f_n\}_{n\in\N}\subset\leb[p]{\Omega}$ una successione tale che per ogni $F\in\dual{\leb[p]{\Omega}}$ esista $M_F>0$ tale per cui $\abs{F(f_n)}\le M_F$ $\forall n\in\N$.
    Allora esiste $c>0$ tale per cui $\norm{f_n}_p<c$, $\forall n\in\N$, ossia la successione delle norme è limitata.
\end{teorema}
\begin{proof}
    Supponiamo per assurdo che $\norm{f_n}_p\to+\infty$ per $n\to+\infty$: possiamo assumere allora che esista una sottosuccessione, che indichiamo ancora con $\{f_n\}$, tale per cui $\norm{f_n}_p=4^n$.
    Infatti esiste certamente una sottosuccessione $\{f_n\}$ per cui $\norm{f_n}_p\ge 4^n$, ma allora possiamo ``rinormalizzarla'' ponendo
    \begin{equation}
        \tilde{f}_n\defeq\frac{4^n}{\norm{f_n}_p}f_n,
    \end{equation}
    che è tale per cui $F(\tilde{f}_n)=\frac{4^n}{\norm{f_n}_p}F(f_n)$; dato che $\frac{4^n}{\norm{f_n}_p}\le 1$ e $F(f_n)\le M_F$, si ha allora $F(\tilde{f}_n)\le M_F$, quindi $\tilde{f}_n$ soddisfa ancora le ipotesi e ovviamente $\norm{\tilde{f}_n}_p=4^n$.

    Definiamo dunque la successione
    \begin{equation}
        g_n\defeq\frac{\abs{f_n}^{p-2}f_n}{\norm{f_n}_p^{p-1}}
    \end{equation}
    per la quale risulta, per $q=p'$,
    \begin{equation}
        \norm{g_n}_q^q=
        \frac1{\norm{f_n}_p^{(p-1)q}}\int_\Omega \abs{f_n}^{(p-1)q}\,\dd\mu
        \norm{f_n}_p^{-p}\int_\Omega \abs{f_n}^{p}\,\dd\mu=
        1.
    \end{equation}
    Definiamo una successione $\{\sigma_i\}$ tale che $\sigma_1=1$ e per $i\ge 2$ sia tale che $\sigma_n\int_\Omega f_ng_n\,\dd\mu$ abbia lo stesso segno di $\sum_{k=1}^{n-1}\frac{\sigma_k}{3^k}\int_\Omega f_ng_k\,\dd\mu$.
    Possiamo allora effettuare la seguente stima:
    \begin{equation}
        \abs[\bigg]{\sum_{k=1}^n\frac{\sigma_k}{3^k}\int_\Omega f_ng_k\,\dd\mu}=
        \abs[\bigg]{\frac{\sigma_n}{3^n}\int_\Omega f_ng_n\,\dd\mu+\sum_{k=1}^{n-1}\frac{\sigma_k}{3^k}\int_\Omega f_ng_k\,\dd\mu}\ge
        \frac1{3^n}\abs[\bigg]{\int_\Omega f_ng_n\,\dd\mu}
    \end{equation}
    poich\'e i due addendi, per costruzione, hanno lo stesso segno: siccome
    \begin{equation}
        \abs[\bigg]{\int_\Omega f_ng_n\,\dd\mu}=
        \norm{f_n}_p^{1-p}\abs[\bigg]{\int_\Omega \abs{f_n}^{p-2}f_nf_n\,\dd\mu}=
        \norm{f_n}_p^{1-p}\norm{f_n}_p^p=
        \norm{f_n}_p
    \end{equation}
    si ha allora che
    \begin{equation}
        \frac1{3^n}\abs[\bigg]{\int_\Omega f_ng_n\,\dd\mu}=
        \frac{\norm{f_n}_p}{3^n}=\biggl(\frac43\biggr)^n.
    \end{equation}
    Consideriamo ora il funzionale
    \begin{equation}
        F\colon h\in\leb[p]{\Omega}\mapsto\sum_{k=1}^{+\infty}\frac{\sigma_k}{3^k}\int_\Omega g_kh\,\dd\mu.
    \end{equation}
    Risulta per ogni $h\in\leb[p]{\Omega}$ che
    \begin{equation}
        \abs{F(h)}\le
        \sum_{k=1}^{+\infty}\frac1{3^k}\abs[\bigg]{\int_\Omega g_kh\,\dd\mu}\le
        \sum_{k=1}^{+\infty}\frac1{3^k}\norm{g_k}_q\norm{h}_p=
        \norm{h}_p\sum_{k=1}^{+\infty}\frac{\norm{g_k}_q}{3^k}\le
        c\norm{h}_p
    \end{equation}
    per un certo $c>0$, dunque $F$ è limitato.
    Per la sottosuccessione $\{f_n\}$ si ottiene però
    \begin{equation}
        \begin{split}
            \abs{F(f_n)}&=
            \abs[\bigg]{\sum_{k=1}^{+\infty}\frac{\sigma_k}{3^k}\int_\Omega f_ng_k\,\dd\mu}=\\&=
            \abs[\bigg]{\sum_{k=1}^{n}\frac{\sigma_k}{3^k}\int_\Omega f_ng_k\,\dd\mu+\sum_{k=n+1}^{+\infty}\frac{\sigma_k}{3^k}\int_\Omega f_ng_k\,\dd\mu}\ge\\&\ge
            % Questo passaggio è molto sospetto, solitamente la disuguaglianza dovrebbe essere nel verso opposto.
            \abs[\bigg]{\sum_{k=1}^{n}\frac{\sigma_k}{3^k}\int_\Omega f_ng_k\,\dd\mu}+\abs[\bigg]{\sum_{k=n+1}^{+\infty}\frac{\sigma_k}{3^k}\int_\Omega f_ng_k\,\dd\mu}\ge\\&\ge
            \biggl(\frac43\biggr)^n-\sum_{k=n+1}^{+\infty}\frac1{3^k}\norm{g_k}_q\norm{f_n}_p=\\&=
            \biggl(\frac43\biggr)^n-\sum_{k=n+1}^{+\infty}\frac{4^n}{3^k}=\\&=
            \biggl(\frac43\biggr)^n-\biggl(\frac43\biggr)^n\sum_{k=n+1}^{+\infty}\frac1{3^{k-n}}=\\&=
            \biggl(\frac43\biggr)^n\biggl(1-\sum_{l=1}^{+\infty}\frac1{3^l}\biggr)=\\&=
            \biggl(\frac43\biggr)^n\biggl(1-\frac{\frac13}{1-\frac13}\biggr)=\\&=
            \frac12\biggl(\frac43\biggr)^n\to+\infty
        \end{split}
    \end{equation}
    che contraddice l'ipotesi di limitatezza di $\abs{F(f_n)}$.
    Di conseguenza deve essere che $\norm{f_n}_p$ è limitata.
\end{proof}
Come conseguenza troviamo che ogni successione debolmente convergente è limitata: infatti, per $\{f_n\}_{n\in\N}\subset\leb[p]{\Omega}$, se $f_n\weakto f$ si ha per qualsiasi $F\in\dual{\leb[p]{\Omega}}$ che la successione $\{F(f_n)\}_{n\in\N}\subset\R$ è limitata, in quanto convergente.
Allora anche $\norm{f_n}_p$ è limitata per il teorema appena dimostrato.
\begin{lemma}[disuguaglianza di Clarkson] \label{l:disuguaglianza-clarkson}
    Per ogni $a,b\in\R$ e $p\ge 2$ vale la relazione
    \begin{equation}
        \abs[\bigg]{\frac{a+b}2}^p+\abs[\bigg]{\frac{a-b}2}^p \le \frac12(\abs{a}^p+\abs{b}^p).
        \label{eq:disuguaglianza-clarkson}
    \end{equation}
\end{lemma}
\begin{proof}
    Per prima cosa, prendiamo $\alpha,\beta>0$: si ha
    \begin{equation}
        \alpha^p+\beta^p\le(\alpha^2+\beta^2)^{p/2}.
        \label{eq:disuguaglianza-clarkson-1}
    \end{equation}
    Dividendo per $\beta^p$ e ponendo $x\defeq\frac{\alpha}{\beta}$ tale disequazione è equivalente a $x^p+1\le(x^2+1)^{p/2}$ ossia $(x^2+1)^{p/2}-x^p-1\ge 0$: in $x=0$ il primo membro è nullo dunque la disuguaglianza è verificata, mentre la sua derivata è $px(x^2+1)^{p/2-1}-px^{p-1}$ che non è negativa se $(x^2+1)^{p/2-1}\ge x^{p-2}$, il che è sempre vero dato che $x$ e $p$ sono positivi.
    Questo dimostra che la \eqref{eq:disuguaglianza-clarkson-1} è vera per ogni $\alpha,\beta>0$.

    Posti dunque $\alpha=\abs[\big]{\frac{a+b}2}$ e $\beta=\abs[\big]{\frac{a-b}2}$ in tale espressione otteniamo che
    \begin{equation}
        \abs[\bigg]{\frac{a+b}2}^p+\abs[\bigg]{\frac{a-b}2}^p\le
        \biggl(\abs[\bigg]{\frac{a+b}2}^2+\abs[\bigg]{\frac{a-b}2}^2\biggr)^{p/2}=
        \biggl(\frac{a^2}2+\frac{b^2}2\biggr)^{p/2}\le
        \frac12(\abs{a}^p+\abs{b}^p)
    \end{equation}
    per la convessità della funzione $x\mapsto x^{p/2}$ per $p\ge 2$.
\end{proof}
\begin{lemma}
    Sia $f\in\leb[p]{\Omega}$ e $\mathcal{M}$ un sottoinsieme convesso di $\leb[p]{\Omega}$.
    Detta $d(f,\mathcal{M})\defeq\inf_{g\in\mathcal{M}}\norm{f-g}_p$, se $\mathcal{M}$ è chiuso allora $\exists h\in\mathcal{M}$ per cui $d(f,\mathcal{M})=\norm{f-h}_p$, e vale per ogni $g\in\mathcal{M}$ che $\int_\Omega (g-h)\abs{f-h}^{p-2}(f-h)\,\dd\mu\le 0$.
\end{lemma}
\begin{proof}
    Dimostriamo solo il caso in cui $p\ge 2$.
    A meno di traslazioni, possiamo supporre che $f=0$.
    Prendiamo una successione $\{h_n\}_{n\in\N}\subset\mathcal{M}$ tale che $\norm{0-h_n}_p=\norm{h}_p\to d$ dall'alto (dato che $d=\inf_{h\in\mathcal{M}}\norm{h}_p$).
    Dimostriamo che esiste $h\in\mathcal{M}$ tale che $h_n\to h$; è sufficiente mostrare che $\{h_n\}$ è di Cauchy, al resto ci pensa la completezza di $\mathcal{M}$.
    Se $p\ge 2$, grazie alla disuguaglianza di Clarkson \ref{l:disuguaglianza-clarkson} abbiamo
    \begin{equation}
        \norm[\bigg]{\frac{h_j+h_k}2}_p^p+\norm[\bigg]{\frac{h_j-h_k}2}_p^p \le \frac12(\norm{h_j}_p^p+\norm{h_k}_p^p).
    \end{equation}
    Siccome $\mathcal{M}$ è convesso, abbiamo che $\frac12(h_j+h_k)\in\mathcal{M}$ e di conseguenza la sua norma non è maggiore di $d$.
    Allo stesso tempo, $\forall\epsilon>0$ esiste $N\in\N$ tale che $\norm{h_n}_p^p<d^p+\epsilon$ per $n>N$, quindi la disuguaglianza precedente diventa
    \begin{equation}
        d^p+\norm[\bigg]{\frac{h_j-h_k}2}_p^p \le \frac12(d^p+\epsilon+d^p+\epsilon)
        \qqq
        \norm[\bigg]{\frac{h_j-h_k}2}_p^p < \epsilon
    \end{equation}
    cioè $\{h_n\}$ è di Cauchy.
    Detto $h$ il suo limite, e presa $g\in\mathcal{M}$, definiamo le funzioni $\tilde{g}(t)\defeq(1-t)h+tg$ e $n(t)\defeq\norm{\tilde{g}(t)}_p^p$ per $t\in[0,1]$ (per la convessità di $\mathcal{M}$ si ha $\tilde{g}(t)\in\mathcal{M}$).
    Per quanto visto finora sappiamo che $n(t)\ge d^p$, e derivando $n$ in $t=0$ risulta
    \begin{equation}
        \begin{split}
            n'(0)&=
            \lim_{t\to 0}\frac{n(t)-n(0)}{t}=\\&=
            \lim_{t\to 0}\frac1{t}\biggl(\int_\Omega \abs{\tilde{g}(t)}^p\,\dd\mu-\int_\Omega \abs{\tilde{g}(0)}^p\,\dd\mu\biggr)=\\&=
            \lim_{t\to 0}\frac1{t}\int_\Omega\bigl(\abs{\tilde{g}(t)}^p-\abs{\tilde{g}(0)}^p\bigl)\,\dd\mu=\\&=
            p\int_\Omega\abs{\tilde{g}(0)}^{p-2}\tilde{g}(0)(g-h)\,\dd\mu=\\&=
            p\int_\Omega\abs{h}^{p-2}h(g-h)\,\dd\mu\ge
            0
        \end{split}
    \end{equation}
    come volevasi dimostrare.
\end{proof}
\begin{teorema} \label{t:duale-Lp}
    Per ogni $p\in[1,+\infty)$ si ha $\dual{\leb[p]{\Omega}}=\leb[p']{\Omega}$, ossia ogni elemento $F\in\dual{\leb[p]{\Omega}}$ si può scrivere come $F\colon g\mapsto\int_\Omega vg\,\dd\mu$ per un \emph{unico} $v\in\leb[p']{\Omega}$; inoltre $\norm{F}=\norm{v}_q$.
\end{teorema}
\begin{proof}
    Siano $p\in(1,+\infty)$ e $\ell\in\dual{\leb[p]{\Omega}}$.
    Il suo nucleo è convesso, poich\'e è uno spazio vettoriale; è anche chiuso, dato che se $g_n\to g$ e $\ell(g_n)=0$ allora $\ell(g_n)\to 0$, e per la continuità di $\ell$ risulta allora $\ell(g)=0$ ossia $g\in\ker\ell$.
    Se $\ell=0$, banalmente possiamo prendere $v=0$ e il teorema è dimostrato.
    Sia dunque $\ell\ne 0$, e prendiamo una $f\notin\ker\ell$: evidentemente $d(f,\ker\ell)>0$, per cui dal lemma precedente abbiamo che $\exists h\in\ker\ell$ tale per cui
    \begin{equation}
        \int_\Omega (f-h)\abs{f-h}^{p-2}(g-h)\,\dd\mu\le 0\quad\forall g\in\ker\ell.
    \end{equation}
    Siccome $g,h\in\ker\ell$ però anche $-(g-h)\in\ker\ell$ quindi l'equazione precedente vale anche sostituendo $g$ con $-(g-h)$, ottenendo cos\`i che $\int_\Omega(f-h)\abs{f-h}^{p-2}(g-h)\,\dd\mu=0$.
    Abbreviamo con $u\defeq\abs{f-h}^{p-2}(f-h)$, e prendiamo un elemento arbitrario $g\in\leb[p]{\Omega}$ scrivendolo come somma $g_1+g_2$ con
    \begin{equation}
        g_1\defeq\frac{\ell(g)}{\ell(f-h)}(f-h)
        \qtext{e}
        g_2\defeq g-g_1.
    \end{equation}
    Ora, dalla definizione di $f$ si ha $\ell(f-h)=\ell(f)\ne 0$, quindi
    \begin{equation}
        \ell(g_2)=
        \ell(g-g_1)=
        \ell(g)-\frac{\ell(g)}{\ell(f-h)}\ell(f-h)=
        0
    \end{equation}
    perciò $g_2\in\ker\ell$.
    Di conseguenza $\int_\Omega ug_2\,\dd\mu=0$, e
    \begin{equation}
        \int_\Omega ug\,\dd\mu=
        \int_\Omega ug_1\,\dd\mu=
        \int_\Omega u\frac{\ell(g)}{\ell(f-h)}(f-h)\,\dd\mu=
        \ell(g)\int_\Omega \frac{(f-h)u}{\ell(f-h)}\,\dd\mu=
        \alpha\ell(g)
    \end{equation}
    con $\alpha\ne 0$ poich\'e $\int_\Omega (f-h)u\,\dd\mu=\norm{f-h}_p^p>0$.
    Ma allora
    \begin{equation}
        \ell(g)=
        \frac1{\alpha}\int_\Omega ug\,\dd\mu=
        \int_\Omega\frac{u}{\alpha}g\,\dd\mu
    \end{equation}
    e la funzione $v\in\leb[p']{\Omega}$ cercata è $\frac{u}{\alpha}$.
    Abbiamo già visto a pagina \ref{pag:norma-funzionale-lineare} che $\norm{\ell}=\norm{v}_{p'}$.

    Per quanto riguarda l'unicità, infine, sia $w\in\leb[p']{\Omega}$ un altra funzione tale per cui $\ell(g)=\int_\Omega wg\,\dd\mu$ per ogni $g\in\leb[p]{\Omega}$: scegliendo $g=\abs{v-w}^{q-2}(v-w)$ --- che, si dimostra, è un elemento di $\leb[p]{\Omega}$ --- troviamo $\int_\Omega \abs{v-w}^q\,\dd\mu=0$ ossia $v=w$.
\end{proof}
Questo teorema mostra che, per $p\in(1,+\infty)$, lo spazio $\leb[p]{\Omega}$ è riflessivo, ossia $\dual{(\dual{\leb[p]{\Omega}})}=\leb[p]{\Omega}$.
