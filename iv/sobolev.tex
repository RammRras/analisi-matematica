\chapter{Spazi di Sobolev}
\label{ch:spazi-sobolev}

\section{Derivata debole}
\label{sec:derivata-debole}
Sia $I\subset\R$ un aperto: indichiamo con il simbolo $\locleb[1]{I}$ lo spazio delle funzioni da $I$ a $\R$ che sono in $\leb[1]{K}$ per ogni sottoinsieme $K$ compatto di $I$, vale a dire l'insieme
\begin{equation}
    \biggl\{u\colon I\to\R\colon \int_K\abs{u}\,\dd\mu<+\infty\quad\forall K\subset I\text{ compatto}\biggr\}.
\end{equation}
\begin{definizione} \label{d:derivata-debole}
    Data una funzione $u\in\locleb[1]{I}$, diciamo che $v\in\locleb[1]{I}$ è la \emph{derivata debole} di $u$ se
    \begin{equation}
        \int_I v\phi\,\dd\mu=-\int_I u\phi'\,\dd\mu
    \end{equation}
    per ogni $\phi\in\contsc[\infty]{I}$.
\end{definizione}
\begin{osservazione} \label{o:unicita-derivata-debole}
    La derivata debole, se esiste, è unica: se infatti $v_1$ e $v_2$ sono derivate deboli di $u\in\locleb[1]{I}$, allora detta $\tilde{v}\defeq v_1-v_2$ si ha che
    \begin{equation}
        \int_I \tilde{v}\phi\,\dd\mu=0
    \end{equation}
    per ogni $\phi\in\contsc[\infty]{I}$, da cui $\tilde{v}=0$ per il lemma \ref{t:fondamentale-calcolo-variazioni}.
\end{osservazione}
\begin{osservazione} \label{o:corrispondenza-derivata-debole}
    Se $u\in\cont[1]{I}$, allora ammette sempre una derivata debole, che coincide con la derivata ordinaria: integrando per parti si ha chiaramente che
    \begin{equation}
        \int_I u'\phi\,\dd\mu=-\int_I u\phi'\,\dd\mu
    \end{equation}
    quindi la derivata debole è proprio $u'$.
\end{osservazione}
In più variabili, preso $\Omega$ aperto in $\R^n$, abbiamo l'insieme $\locleb[1]{\Omega}$ definito in modo analogo, e questa volta possiamo calcolare la derivata debole per ciascuna variabile: la derivata debole di $u\in\locleb[1]{\Omega}$, se esiste, è la funzione $(v_1,\dotsc,v_n)\in\locleb[1]{\Omega}^n$ tale che
\begin{equation}
    \int_\Omega v_i\phi\,\dd\mu=-\int_\Omega u\drp{\phi}{x_i}\,\dd\mu
\end{equation}
sempre per ogni $\phi\in\contsc[\infty]{\Omega}$.

Le derivate deboli di ordine superiore a uno si definiscono in modo analogo.
Se $f$ è una funzione a $n$ variabili, associamo a ogni derivata una lista di $n$ indici $i_1,\dotsc,i_n$, tali per cui l'indice $i_k$ indica quante volte si è derivato rispetto alla $k$-esima variabile: una derivata di ordine $d$ è dunque tale che $i_1+\dotsb+i_n=d$.
Usiamo perciò la notazione con i \emph{multiindici}, ossia delle $n$-uple di numeri interi non negativi $\alpha=(\alpha_1,\dotsc,\alpha_n)\in\N_0^n$ per cui è definita (tra altre proprietà) il valore assoluto $\abs{\alpha}\defeq\alpha_1+\dotsb+\alpha_n$.
Indicheremo dunque le derivate parziali come
\begin{equation}
    D^\alpha f\defeq\frac{\partial^{\abs{\alpha}}f}{\partial^{\alpha_1}x_1\dotsm\partial^{\alpha_n}x_n},
\end{equation}
e $\abs{\alpha}$ è l'ordine di derivazione.
Detto ciò, data una funzione $f\in\leb[p]{\Omega}$, se esiste una $g$ tale che
\begin{equation}
    \int_\Omega fD^\alpha\,\dd\mu=(-1)^{\abs{\alpha}}\int_\Omega g\phi\,\dd\mu
\end{equation}
per ogni $\phi\in\contsc[\infty]{\Omega}$ allora $g$ è la $\alpha$-esima derivata debole di $f$.

\section{Spazi di Sobolev}
Da qui in avanti, quanto parleremo di derivate (di qualsiasi tipo) intenderemo sempre le derivate deboli, e useremo la notazione classica $\drv{f}{x}$, $\drp{f}{x}$ etc. anche per le derivate deboli.
Sia $1\le p<+\infty$ e $\Omega\in\R^n$ aperto.
Lo spazio delle funzioni in $\leb[p]{\Omega}$ che possiedono una derivata debole $(v_1,\dotsc,v_n)\in\leb[p]{\Omega}^n$, ossia tali per cui la funzione e tutte le sue derivate parziali sono in $\leb[p]{\Omega}$, è detto \emph{spazio di Sobolev $1,p$} ed è indicato con $\sobW[1,p]{\Omega}$.
In esso possiamo definire una norma come
\begin{equation}
    \norm{u}_{1,p}\defeq\biggl(\norm{u}_p^p+\sum_{i=1}^n\norm[\bigg]{\drp{u}{x_i}}_p^p\biggr)^{1/p}.
    \label{eq:norma-W1p}
\end{equation}
Questi spazi si generalizzano poi per le derivate di ordine superiore: lo \emph{spazio di Sobolev} $k,p$, indicato con $\sobW[k,p]{\Omega}$, è lo spazio delle funzioni $u\in\leb[p]{\Omega}$ le cui derivate deboli $D^\alpha u$ per ogni $\alpha$ tale che $\abs{\alpha}\le k$ sono ancora in $\leb[p]{\Omega}$.
Alternativamente si può definire induttivamente come
\begin{equation}
    \sobW[k,p]=\biggl\{u\in\sobW[k-1,p]{\Omega}\colon \drp{u}{x_i}\in\sobW[k-1,p]{\Omega}\biggr\}.
\end{equation}
In questi spazi si può definire la norma
\begin{equation}
    \norm{u}_{k,p}\defeq\sum_{\abs{\alpha}\le k}\norm{D^\alpha u}_p.
    \label{eq:norma-Wkp}
\end{equation}
\begin{proprieta}
    Lo spazio $\sobW[1,p]{\Omega}$ ha le seguenti proprietà:
    \begin{itemize}
        \item è uno spazio di Banach per $1\le p<+\infty$ (e si può estendere anche per $p=+\infty$);
        \item è riflessivo per $1<p<+\infty$;
        \item è separabile per $1\le p<+\infty$.
    \end{itemize}
\end{proprieta}
\begin{proof}
    La dimostrazione si basa sulle proprietà analoghe degli spazi $\lclass[p]$ già viste.
    \begin{itemize}
        \item Sia $\{u_n\}_{n\in\N}\subset\sobW[1,p]{\Omega}$ una successione di Cauchy: allora scelto arbitrariamente $\epsilon>0$ esiste $\bar{n}\in\N$ tale che per ogni $n,m>\bar{n}$ si ha
            \begin{equation}
                \norm{u_n-u_m}_p^p+\sum_{i=1}^n\norm[\bigg]{\drp{u_n}{x_i}-\drp{u_m}{x_i}}_p^p<\epsilon
            \end{equation}
            Questo significa, dato che tutti gli addendi sono positivi, che $\epsilon$ è maggiore di ciascuno di essi, ossia la funzione $u_n$ e le sue derivate parziali formano, una per una, successioni di Cauchy; per la completezza di $\leb[p]{\Omega}$ ciò significa che esistono $u,g_i$ con $i\in\{1,\dotsc,n\}$ tali che $u_n\to u$ e $\drp{u_n}{x_i}\to g_i$.
            Allo stesso tempo, dalla definizione di derivata debole, $\forall\phi\in\contsc[\infty]{\Omega}$
            \begin{equation}
                \int_\Omega u_n\drp{\phi}{x_i}\,\dd\mu=-\int_\Omega\phi\drp{u_n}{x_i}\,\dd\mu
            \end{equation}
            perciò prendendo il limite per $n\to +\infty$ si ottiene
            \begin{equation}
                \int_\Omega u\drp{\phi}{x_i}\,\dd\mu=-\int_\Omega \phi g_i\,\dd\mu
            \end{equation}
            che mostra che $(g_1,\dotsc,g_n)$ è la derivata debole di $u$.
        \item Sappiamo che $\leb[p]{\Omega}$ è riflessivo se $p\in(1,+\infty)$: sia $E\defeq\leb[p]{\Omega}^{n+1}$ (anch'esso ovviamente rilessivo) e definiamo la mappa $T\colon\sobW[1,p]{\Omega}\to E$ data da $u\mapsto(u,\grad u)$.
            Essa è un'ovvia isometria rispetto alla norma $\norm{u}_{1,p}\defeq\norm{u}_p+\norm{\grad u}_p$, dato che la definizione di norma rimane proprio uguale, e poich\'e si dimostra che $T(\sobW[1,p]{\Omega})\subset E$ si ha che $\sobW[1,p]{\Omega}$ è riflessivo.
            \footnote{La norma qui definita è \emph{equivalente} alla precedente: due norme $f$ e $g$ su uno spazio $X$ sono equivalenti se esistono $c_1,c_2>0$ tali che per ogni $x\in X$ si ha $c_1f(x)\le g(x)\le c_2 f(x)$.}
            \footnote{Abbreviamo con $\norm{\grad u}_p$ la quantità
            \begin{equation}
                \norm[\big]{\bigl(\norm{\grad u}\bigr)}_p=\Bigl(\int_\Omega\Bigl[\sum_{i=1}^n\Bigl(\drp{u}{x_i}\Bigr)^2\Bigr]^{p/2}\,\dd\mu\Bigr)^{1/p}
            \end{equation}}
        \item Come prima, siccome $E$ è separabile e $T(\sobW[1,p]{\Omega})\subset E$ allora è separabile anche $\sobW[1,p]{\Omega}$.\qedhere
    \end{itemize}
\end{proof}
Gli stessi risultati valgono anche, con le medesime condizioni su $p$, per gli spazi $\sobW[k,p]{\Omega}$.

Nel caso di $p=2$, abbiamo visto che lo spazio $\lclass[2]$ è uno spazio di Hilbert: per il corrispondente spazio di Sobolev, la norma \eqref{eq:norma-funzionale} può essere fatta discendere dal prodotto interno
\begin{equation}
    \inner{f}{g}_{k,2}\defeq
    \sum_{\abs{\alpha}\le k}\int_\Omega D^\alpha fD^\alpha g\,\dd\mu
    \label{eq:prodotto-interno-Wk2}
\end{equation}
da cui $\norm{f}_{k,2}=\sqrt{\inner{f}{f}_{k,2}}$; per $k=1$ si ha in particolare
\begin{equation}
    \inner{f}{g}_{1,2}\defeq
    \int_\Omega (fg+\scalar{\grad f}{\grad g})\,\dd\mu.
    \label{eq:prodotto-interno-W12}
\end{equation}
Con ciò anche lo spazio $\sobW[k,2]{\Omega}$ è uno spazio di Hilbert: per questo fatto questi spazi sono denotati anche come $\sobH[k]{\Omega}$, sottintendendo $p=2$.
