\chapter{Spazi di Sobolev}
\label{ch:spazi-sobolev}

\section{Derivata debole}
\label{sec:derivata-debole}
Sia $I\subset\R$ un aperto: indichiamo con il simbolo $\locleb[1]{I}$ lo spazio delle funzioni da $I$ a $\R$ che sono in $\leb[1]{K}$ per ogni sottoinsieme $K$ compatto di $I$, vale a dire l'insieme
\begin{equation}
    \biggl\{u\colon I\to\R\colon \int_K\abs{u}\,\dd\mu<+\infty\quad\forall K\subset I\text{ compatto}\biggr\}.
\end{equation}
\begin{definizione} \label{d:derivata-debole}
    Data una funzione $u\in\locleb[1]{I}$, diciamo che $v\in\locleb[1]{I}$ è la \emph{derivata debole} di $u$ se
    \begin{equation}
        \int_I v\phi\,\dd\mu=-\int_I u\phi'\,\dd\mu
    \end{equation}
    per ogni $\phi\in\contsc[\infty]{I}$.
\end{definizione}
\begin{osservazione} \label{o:unicita-derivata-debole}
    La derivata debole, se esiste, è unica: se infatti $v_1$ e $v_2$ sono derivate deboli di $u\in\locleb[1]{I}$, allora detta $\tilde{v}\defeq v_1-v_2$ si ha che
    \begin{equation}
        \int_I \tilde{v}\phi\,\dd\mu=0
    \end{equation}
    per ogni $\phi\in\contsc[\infty]{I}$, da cui $\tilde{v}=0$ per il lemma \ref{t:fondamentale-calcolo-variazioni}.
\end{osservazione}
\begin{osservazione} \label{o:corrispondenza-derivata-debole}
    Se $u\in\cont[1]{I}$, allora ammette sempre una derivata debole, che coincide con la derivata ordinaria: integrando per parti si ha chiaramente che
    \begin{equation}
        \int_I u'\phi\,\dd\mu=-\int_I u\phi'\,\dd\mu
    \end{equation}
    quindi la derivata debole è proprio $u'$.
\end{osservazione}
In più variabili, preso $\Omega$ aperto in $\R^n$, abbiamo l'insieme $\locleb[1]{\Omega}$ definito in modo analogo, e questa volta possiamo calcolare la derivata debole per ciascuna variabile: la derivata debole di $u\in\locleb[1]{\Omega}$, se esiste, è la funzione $(v_1,\dotsc,v_n)\in\locleb[1]{\Omega}^n$ tale che
\begin{equation}
    \int_\Omega v_i\phi\,\dd\mu=-\int_\Omega u\drp{\phi}{x_i}\,\dd\mu
\end{equation}
sempre per ogni $\phi\in\contsc[\infty]{\Omega}$.

Le derivate deboli di ordine superiore a uno si definiscono in modo analogo.
Se $f$ è una funzione a $n$ variabili, associamo a ogni derivata una lista di $n$ indici $i_1,\dotsc,i_n$, tali per cui l'indice $i_k$ indica quante volte si è derivato rispetto alla $k$-esima variabile: una derivata di ordine $d$ è dunque tale che $i_1+\dotsb+i_n=d$.
Usiamo perciò la notazione con i \emph{multiindici}, ossia delle $n$-uple di numeri interi non negativi $\alpha=(\alpha_1,\dotsc,\alpha_n)\in\N_0^n$ per cui è definita (tra altre proprietà) il valore assoluto $\abs{\alpha}\defeq\alpha_1+\dotsb+\alpha_n$.
Indicheremo dunque le derivate parziali come
\begin{equation}
    D^\alpha f\defeq\frac{\partial^{\abs{\alpha}}f}{\partial^{\alpha_1}x_1\dotsm\partial^{\alpha_n}x_n},
\end{equation}
e $\abs{\alpha}$ è l'ordine di derivazione.
Detto ciò, data una funzione $f\in\leb[p]{\Omega}$, se esiste una $g$ tale che
\begin{equation}
    \int_\Omega fD^\alpha\,\dd\mu=(-1)^{\abs{\alpha}}\int_\Omega g\phi\,\dd\mu
\end{equation}
per ogni $\phi\in\contsc[\infty]{\Omega}$ allora $g$ è la $\alpha$-esima derivata debole di $f$.

\section{Spazi di Sobolev}
Da qui in avanti, quanto parleremo di derivate (di qualsiasi tipo) intenderemo sempre le derivate deboli, e useremo la notazione classica $\drv{f}{x}$, $\drp{f}{x}$ etc. anche per le derivate deboli.
Sia $1\le p<+\infty$ e $\Omega\in\R^n$ aperto.
Lo spazio delle funzioni in $\leb[p]{\Omega}$ che possiedono una derivata debole $(v_1,\dotsc,v_n)\in\leb[p]{\Omega}^n$, ossia tali per cui la funzione e tutte le sue derivate parziali sono in $\leb[p]{\Omega}$, è detto \emph{spazio di Sobolev $1,p$} ed è indicato con $\sobW[1,p]{\Omega}$.
In esso possiamo definire una norma come
\begin{equation}
    \norm{u}_{1,p}\defeq\biggl(\norm{u}_p^p+\sum_{i=1}^n\norm[\bigg]{\drp{u}{x_i}}_p^p\biggr)^{1/p}.
    \label{eq:norma-W1p}
\end{equation}
Questi spazi si generalizzano poi per le derivate di ordine superiore: lo \emph{spazio di Sobolev} $k,p$, indicato con $\sobW[k,p]{\Omega}$, è lo spazio delle funzioni $u\in\leb[p]{\Omega}$ le cui derivate deboli $D^\alpha u$ per ogni $\alpha$ tale che $\abs{\alpha}\le k$ sono ancora in $\leb[p]{\Omega}$.
Alternativamente si può definire induttivamente come
\begin{equation}
    \sobW[k,p]=\biggl\{u\in\sobW[k-1,p]{\Omega}\colon \drp{u}{x_i}\in\sobW[k-1,p]{\Omega}\biggr\}.
\end{equation}
In questi spazi si può definire la norma
\begin{equation}
    \norm{u}_{k,p}\defeq\sum_{\abs{\alpha}\le k}\norm{D^\alpha u}_p.
    \label{eq:norma-Wkp}
\end{equation}
\begin{proprieta}
    Lo spazio $\sobW[1,p]{\Omega}$ ha le seguenti proprietà:
    \begin{itemize}
        \item è uno spazio di Banach per $1\le p<+\infty$ (e si può estendere anche per $p=+\infty$);
        \item è riflessivo per $1<p<+\infty$;
        \item è separabile per $1\le p<+\infty$.
    \end{itemize}
\end{proprieta}
\begin{proof}
    La dimostrazione si basa sulle proprietà analoghe degli spazi $\lclass[p]$ già viste.
    \begin{itemize}
        \item Sia $\{u_n\}_{n\in\N}\subset\sobW[1,p]{\Omega}$ una successione di Cauchy: allora scelto arbitrariamente $\epsilon>0$ esiste $\bar{n}\in\N$ tale che per ogni $n,m>\bar{n}$ si ha
            \begin{equation}
                \norm{u_n-u_m}_p^p+\sum_{i=1}^n\norm[\bigg]{\drp{u_n}{x_i}-\drp{u_m}{x_i}}_p^p<\epsilon
            \end{equation}
            Questo significa, dato che tutti gli addendi sono positivi, che $\epsilon$ è maggiore di ciascuno di essi, ossia la funzione $u_n$ e le sue derivate parziali formano, una per una, successioni di Cauchy; per la completezza di $\leb[p]{\Omega}$ ciò significa che esistono $u,g_i$ con $i\in\{1,\dotsc,n\}$ tali che $u_n\to u$ e $\drp{u_n}{x_i}\to g_i$.
            Allo stesso tempo, dalla definizione di derivata debole, $\forall\phi\in\contsc[\infty]{\Omega}$
            \begin{equation}
                \int_\Omega u_n\drp{\phi}{x_i}\,\dd\mu=-\int_\Omega\phi\drp{u_n}{x_i}\,\dd\mu
            \end{equation}
            perciò prendendo il limite per $n\to +\infty$ si ottiene
            \begin{equation}
                \int_\Omega u\drp{\phi}{x_i}\,\dd\mu=-\int_\Omega \phi g_i\,\dd\mu
            \end{equation}
            che mostra che $(g_1,\dotsc,g_n)$ è la derivata debole di $u$.
        \item Sappiamo che $\leb[p]{\Omega}$ è riflessivo se $p\in(1,+\infty)$: sia $E\defeq\leb[p]{\Omega}^{n+1}$ (anch'esso ovviamente rilessivo) e definiamo la mappa $T\colon\sobW[1,p]{\Omega}\to E$ data da $u\mapsto(u,\grad u)$.
            Essa è un'ovvia isometria rispetto alla norma $\norm{u}_{1,p}\defeq\norm{u}_p+\norm{\grad u}_p$, dato che la definizione di norma rimane proprio uguale, e poich\'e si dimostra che $T(\sobW[1,p]{\Omega})\subset E$ si ha che $\sobW[1,p]{\Omega}$ è riflessivo.
            \footnote{La norma qui definita è \emph{equivalente} alla precedente: due norme $f$ e $g$ su uno spazio $X$ sono equivalenti se esistono $c_1,c_2>0$ tali che per ogni $x\in X$ si ha $c_1f(x)\le g(x)\le c_2 f(x)$.}
            \footnote{Abbreviamo con $\norm{\grad u}_p$ la quantità
            \begin{equation}
                \norm[\big]{\bigl(\norm{\grad u}\bigr)}_p=\Bigl(\int_\Omega\Bigl[\sum_{i=1}^n\Bigl(\drp{u}{x_i}\Bigr)^2\Bigr]^{p/2}\,\dd\mu\Bigr)^{1/p}
            \end{equation}}
        \item Come prima, siccome $E$ è separabile e $T(\sobW[1,p]{\Omega})\subset E$ allora è separabile anche $\sobW[1,p]{\Omega}$.\qedhere
    \end{itemize}
\end{proof}
Gli stessi risultati valgono anche, con le medesime condizioni su $p$, per gli spazi $\sobW[k,p]{\Omega}$.

Nel caso di $p=2$, abbiamo visto che lo spazio $\lclass[2]$ è uno spazio di Hilbert: per il corrispondente spazio di Sobolev, la norma \eqref{eq:norma-funzionale} può essere fatta discendere dal prodotto interno
\begin{equation}
    \inner{f}{g}_{k,2}\defeq
    \sum_{\abs{\alpha}\le k}\int_\Omega D^\alpha fD^\alpha g\,\dd\mu
    \label{eq:prodotto-interno-Wk2}
\end{equation}
da cui $\norm{f}_{k,2}=\sqrt{\inner{f}{f}_{k,2}}$; per $k=1$ si ha in particolare
\begin{equation}
    \inner{f}{g}_{1,2}\defeq
    \int_\Omega (fg+\scalar{\grad f}{\grad g})\,\dd\mu.
    \label{eq:prodotto-interno-W12}
\end{equation}
Con ciò anche lo spazio $\sobW[k,2]{\Omega}$ è uno spazio di Hilbert: per questo fatto questi spazi sono denotati anche come $\sobH[k]{\Omega}$, sottintendendo $p=2$.

\section{Teoremi di immersione}
È evidente dalla definizione che $\sobW[k,p]{\Omega}\subset\leb[p]{\Omega}$ per $k\ge 1$ e $\sobW[0,p]{\Omega}=\leb[p]{\Omega}$.
In questo capitolo vediamo come sia invece possibile trovare delle inclusioni (o immersioni) tra spazi di Sobolev di ordini differenti, e come queste immersioni possono essere continue o compatte.
Ma prima, alcune definizioni.
\begin{definizione} \label{d:bordo-regolare}
    Sia $\Omega\subset\R^n$ aperto.
    Il suo bordo $\boundary\Omega$ è detto di classe $\cclass[k]$ ($k\ge 1$) se per ogni punto $\vec p\in\boundary\Omega$ esistono degli intorni $U\defeq B_r(\vec p)$ e $B_\delta(\vec 0)$ in $\R^n$ e un diffeomorfismo $\Phi\colon U\to B_\delta(\vec 0)$ di classe $\cclass[k]$ tale che $\Phi\colon U\cap\boundary\Omega\to B_\delta(\vec 0)\cap\R^{n-1}\times\{0\}$; in altre parole $\Phi$, ristretto al bordo di $\Omega$, lo mappa in ``$\R^n$ meno una coordinata'', cioè raddrizzandolo in un iperpiano di $\R^n$.
    Diciamo inoltre che $\boundary\Omega$ è \emph{lipschitziano} se lo è $\Phi$.
\end{definizione}
Ricordiamo ora che, se $A$ è un sottoinsieme di $B$, la mappa da $A$ a $B$ che porta ogni elemento $x\in A$ in s\'e stesso visto come elemento di $B$ è detta \emph{inclusione}.
\begin{definizione} \label{d:immersione-continua}
    Siano $X$ e $Y$ due spazi normati, con $X\subseteq Y$.
    Lo spazio $X$ si dice \emph{immerso con continuità} in $Y$, e si indica con $X\emb Y$, se la mappa di inclusione $\iota\colon X\to Y$ (quindi $X\subseteq Y$) è continua, ossia esiste $c>0$ tale per cui $\norm{x}_Y\le c\norm{\iota(x)}_Y$ per ogni $x\in X$.
\end{definizione}
\begin{definizione} \label{d:insieme-relativamente-compatto}
    Sia $X$ uno spazio di Banach.
    Un sottoinsieme $K\subset X$ è detto \emph{relativamente compatto} se la sua chiusura è compatta in $X$.
\end{definizione}
\begin{definizione} \label{d:immersione-compatta}
    Siano $X$ e $Y$ due spazi di Banach, con $X\subseteq Y$.
    Lo spazio $X$ si dice \emph{immerso con compattezza} in $Y$, e si indica con $X\cemb Y$, se $X\emb Y$ e ogni insieme limitato in $X$ è relativamente compatto in $Y$.
\end{definizione}
Se $X\cemb Y$, per ogni insieme limitato di $X$ esiste una successione tale da possedere una sottosuccessione di Cauchy in $Y$.
Si dice anche che la mappa di inclusione (continua e lineare) $\iota\colon X\to Y$ è un \emph{operatore compatto} tra $X$ e $Y$.
\begin{teorema} \label{t:relativamente-compatto-sse-totalmente-limitato}
    Dato uno spazio $X$ di Banach, un suo sottoinsieme $K$ è relativamente compatto se e solo se $\forall\delta>0$ esiste $n=n(\delta)\in\N$ e un insieme di punti $\{a_1,\dotsc,a_n\}\in X$ tale che $\bigcup_{i=1}^n B_\delta(a_i)\supset K$.
\end{teorema}
In altre parole, fissato un raggio $\delta$ l'insieme $K$ può essere ricoperto con un numero finito di palle aventi tale raggio; un insieme con questa proprietà si dice anche \emph{totalmente limitato}.

A partire dalle funzioni liscie a supporto compatto, definiamo lo spazio $\sobWc[k,p]{\Omega}$ come la chiusura di $\contsc[\infty]{\Omega}$, rispetto alla $k,p$-norma: esso è completo per definizione e di conseguenza è uno spazio di Banach.
\begin{teorema}[Sobolev] \label{t:sobolev}
    Sia $\Omega\subset\R^n$ aperto, limitato e con bordo lipschitziano, e siano $k,p\in\N$ tali che $kp<n$: allora $\sobW[k,p]{\Omega}\emb\leb[q]{\Omega}$ per ogni $q$ tale che $1\le q\le\frac{np}{n-kp}$.
\end{teorema}
\begin{proof}
    Dimostriamo il teorema solo nel caso $\sobWc[1,p]{\Omega}\emb\leb[q]{\Omega}$, per cui si ha $p<n$ e $1\le q\le\frac{np}{n-p}$.
    Dobbiamo mostrare che esiste una costante $c$, dipendente al più da $n$, $p$, e $\Omega$ tale che
    \begin{equation}
        \norm{u}_\frac{np}{n-p}\le c(\norm{u}_p+\norm{\grad u}_p).
        \label{eq:dim-sobolev-obiettivo}
    \end{equation}
    Sia $u\in\contsc[1]{\Omega}$, che possiamo estendere, siccome $\supp u\subset\Omega$, a tutto $\R^n$ ponendo $u=0$ in $\R^n\setminus\Omega$.
    Dato che si ha dalla definizione di $u$ che $\lim_{\norm{\vec x}\to+\infty}u(\vec x)=0$ (e in particolare per ciascuna $x_i\to+\infty$), per il teorema fondamentale del calcolo integrale possiamo scrivere per $i\in\{1,\dotsc,n\}$
    \begin{equation}
        u(\vec x)=\int_{-\infty}^{x_i}\drp{u}{x_i}(x_1,\dotsc,x_{i-1},\xi,x_{i+1},\dotsc,x_n)\,\dd\xi.
    \end{equation}
    Allora troviamo
    \begin{multline}
        \abs{u(\vec x)}^\frac1{n-1}=
        \abs[\bigg]{\int_{-\infty}^{x_i}\drp{u}{x_i}(x_1,\dotsc,x_{i-1},\xi,x_{i+1},\dotsc,x_n)\,\dd\xi}^\frac1{n-1}\le\\ \le
        \biggl[\int_{-\infty}^{x_i}\abs[\bigg]{\drp{u}{x_i}(x_1,\dotsc,x_{i-1},\xi,x_{i+1},\dotsc,x_n)}\,\dd\xi\biggr]^\frac1{n-1}
        \biggl[\int_\R\abs[\bigg]{\drp{u}{x_i}(x_1,\dotsc,x_{i-1},\xi,x_{i+1},\dotsc,x_n)}\,\dd\xi\biggr]^\frac1{n-1}
    \end{multline}
    e considerando tutte le $n$ variabili
    \begin{equation}
        \abs{u(\vec x)}^\frac{n}{n-1}\le
        \prod_{i=1}^n\biggl[\int_\R\abs[\bigg]{\drp{u}{x_i}(x_1,\dotsc,x_{i-1},\xi,x_{i+1},\dotsc,x_n)}\,\dd\xi\biggr]^\frac1{n-1}.
    \end{equation}
    Ora, integrando in $x_1$ otteniamo
    \begin{equation}
        \int_\R\abs{u}^\frac{n}{n-1}\,\dd x_1\le
        \biggl(\int_\R\abs[\bigg]{\drp{u}{x_1}}\,\dd x_1\biggr)^\frac1{n-1}
        \int_\R\biggl[
            \biggl(\int_\R\abs[\bigg]{\drp{u}{x_2}}\,\dd x_2\biggr)^\frac1{n-1}
            \dotsm
            \biggl(\int_\R\abs[\bigg]{\drp{u}{x_n}}\,\dd x_n\biggr)^\frac1{n-1}
        \biggr]\,\dd x_1.
    \end{equation}
    Usando iterativamente la disuguaglianza di Hölder su tutti i fattori, per $p_1,\dotsc,p_n$ tali che $\frac1{p_1}+\dotsb+\frac1{p_n}=1$ si ha
    \begin{equation}
        \int_\R\abs{u}^\frac{n}{n-1}\,\dd x_1\le
        \biggl(\int_\R\abs[\bigg]{\drp{u}{x_1}}\,\dd x_1\biggr)^\frac1{n-1}
        \biggl(\int_\R\int_\R\abs[\bigg]{\drp{u}{x_2}}\,\dd x_2\,\dd x_1\biggr)^\frac1{n-1}
        \dotsm
        \biggl(\int_\R\int_\R\abs[\bigg]{\drp{u}{x_n}}\,\dd x_n\,\dd x_1\biggr)^\frac1{n-1}.
    \end{equation}
    Iterando e integrando sulle restanti variabili, allora,
    \begin{equation}
        \int_\R\dotsi\int_\R\abs{u}^\frac{n}{n-1}\,\dd x_1\dotsm\dd x_n\le
        \prod_{i=1}^n\biggl(\int_\R\dotsi\int_\R\abs[\bigg]{\drp{u}{x_i}}\,\dd x_1\dotsm\dd x_n\biggr)^\frac1{n-1}
    \end{equation}
    ma dato che $\supp u\subset\Omega$ questo è equivalente a dire
    \begin{equation}
        \int_\Omega\abs{u}^\frac{n}{n-1}\,\dd\mu\le
        \prod_{i=1}^n\biggl(\int_\Omega\abs[\bigg]{\drp{u}{x_i}}\,\dd\mu\biggr)^\frac1{n-1}
    \end{equation}
    da cui ricaviamo
    \begin{multline}
        \norm{u}_\frac{n}{n-1}\le
        \biggl[\prod_{i=1}^n\biggl(\int_\Omega\abs[\bigg]{\drp{u}{x_i}}\,\dd\mu\biggr)^\frac1{n-1}\biggr]^\frac{n-1}{n}=
        \biggl[\prod_{i=1}^n\biggl(\int_\Omega\abs[\bigg]{\drp{u}{x_i}}\,\dd\mu\biggr)\biggr]^\frac1{n}\le\\ \le
        \frac1{n}\sum_{i=1}^n\int_\Omega\abs[\bigg]{\drp{u}{x_i}}\,\dd\mu=
        \frac1{n}\int_\Omega\sum_{i=1}^n\abs[\bigg]{\drp{u}{x_i}}\,\dd\mu=
        \frac1{n}\norm{\grad u}_1,
    \end{multline}
    dato che la media geometrica di un insieme di quantità non negative non è mai maggiore della rispettiva media aritmetica.

    Ora sostituiamo $u$ con la funzione $\abs{u}^\gamma$, con $\gamma>0$, nella disuguaglianza trovata $\norm{u}_\frac{n}{n-1}\le\frac1{n}\norm{\grad u}_1$: in questo modo troviamo
    \begin{equation}
        \norm{\abs{u}^\gamma}_\frac{n}{n-1}\le
        \frac1{n}\int_\Omega\norm[\big]{\grad\big(\abs{u}^\gamma)}\,\dd\mu\le
        \frac{\gamma}{n}\int_\Omega\abs{u}^{\gamma-1}\norm{\grad u}\,\dd\mu
    \end{equation}
    perciò dalla disuguaglianza di Hölder abbiamo
    \begin{equation}
        \norm{\abs{u}^\gamma}_\frac{n}{n-1}\le
        \frac{\gamma}{n}\norm[\big]{\abs{u}^{\gamma-1}}_\frac{p}{p-1}\norm{\grad u}_p.
    \end{equation}
    Infine,
    \begin{equation}
        \norm{u}_{\gamma\frac{n}{n-1}}^\gamma\le
        \frac{\gamma}{n}\norm{u}^{\gamma-1}_{(\gamma-1)\frac{p}{p-1}}\norm{\grad u}_p
    \end{equation}
    e per individuare il valore di $\gamma$ imponiamo che le due norme di $u$ siano sul medesimo spazio, in modo che si possano semplificare, ossia che
    \begin{equation}
        \gamma\frac{n}{n-1}=(\gamma-1)\frac{p}{p-1}
        \qqq
        \gamma=\frac{(n-1)p}{n-p}.
    \end{equation}
    Inserendo questo valore nella disuguaglianza, dato che $\gamma\frac{n}{n-1}=\frac{np}{n-p}$, risulta allora
    \begin{equation}
        \norm{u}_\frac{np}{n-p}\le\frac{\gamma}{n}\norm{\grad u}_p
    \end{equation}
    da cui segue in modo ovvio la \eqref{eq:dim-sobolev-obiettivo} con $c=\frac{\gamma}{n}$.
\end{proof}
Ad esempio, per $\Omega\subset\R^3$ abbiamo con $k=1$ e $p=2$ che il massimo valore che $q$ può assumere è $6$, perciò $\sobW[1,2]{\Omega}\emb\leb[q]{\Omega}$ per $q=1,\dotsc,6$, dato che siccome $\mu(\Omega)<+\infty$ si ha $\leb[q]{\Omega}\subset\leb[q']{\Omega}$ se $q<q'$.
L'immersione data in questo teorema è ottimale, nel senso che non è possibile immergere con continuità lo spazio di Sobolev in spazi più grandi.
Per vedere da dove deriva il valore critico $\frac{np}{n-kp}$ per $q$ possiamo prendere il seguente ragionamento.
Consideriamo $f\in\sobW[1,p]{\R^n}\cap\leb[q]{\R^n}$, ed effettuiamo un riscalamento definendo $f_\lambda(\vec y)\defeq f(\vec y/\lambda)=f(\vec x)$ per $\lambda>0$.
Risulta
\begin{multline}
    \biggl(\int_{\R^n}\norm{\grad f_\lambda(\vec y)}^p\,\dd\mu(\vec y)\biggr)^\frac1{p}=
    \biggl(\int_{\R^n}\frac1{\lambda^p}\norm{\grad f(\vec y/\lambda)}^p\,\dd\mu(\vec y)\biggr)^\frac1{p}=\\=
    \biggl(\int_{\R^n}\frac1{\lambda^p}\norm{\grad f(\vec x)}^p\lambda^n\,\dd\mu(\vec x)\biggr)^\frac1{p}=
    \lambda^\frac{n-p}{p}\biggl(\int_{\R^n}\norm{\grad f(\vec x)}^p\,\dd\mu(\vec x)\biggr)^\frac1{p}
\end{multline}
e con la $q$-norma abbiamo invece
\begin{equation}
    \biggl(\int_{\R^n}\abs{f_\lambda(\vec y)}^q\,\dd\mu(\vec y)\biggr)^\frac1{q}=
    \lambda^\frac{n}{q}\biggl(\int_{\R^n}\abs{f(\vec x)}^q\,\dd\mu(\vec x)\biggr)^\frac1{q}
\end{equation}
di conseguenza $\lambda^\frac{n}{q}\norm{f}_q\le c\lambda^{\frac{n}{p}-1}\norm{\grad f}_p$, e se vogliamo che la costante che limita le norme (rendendo cos\`i continua l'inclusione) non dipenda da $\lambda$, cioè sia indipendente dalla funzione, allora dobbiamo prendere $\frac{n}{q}=\frac{n}{p}-1$ vale a dire $q=\frac{np}{n-p}$, che è l'esponente critico del teorema per $k=1$.

Introduciamo ora un altro spazio di funzioni, le funzioni Hölder-continue, e vediamo come includere gli spazi di Sobolev in essi.
\begin{definizione} \label{d:continuita-holder}
    Una funzione $f\colon\Omega\subset\R^n\to\R$ si dice \emph{Hölder-continua} di ordine $\alpha\in(0,1]$ se esiste $c>0$ tale per cui per ogni $\vec x,\vec y\in\Omega$  con $\vec x\ne\vec y$ si ha
    \begin{equation}
        \abs{f(\vec x)-f(\vec y)}\le c\norm{\vec x-\vec y}^\alpha.
    \end{equation}
\end{definizione}
Tutte le funzioni di questo tipo, per ogni $\alpha\in(0,1]$, sono anche continue; se $\alpha=1$ la definizione è equivalente a quella di lipschitzianità.
Un esempio veloce: la funzione $x\mapsto\sqrt{x}$ è Hölder-continua di ordine $\frac12$.
Definiamo inoltre la quantità
\begin{equation}
    [f]_\alpha\defeq\sup_{\substack{\vec x,\vec y\in\Omega\\\vec x\ne\vec y}}\frac{\abs{f(\vec x)-f(\vec y)}}{\norm{\vec x-\vec y}^\alpha}
    \label{eq:seminorma-holder}
\end{equation}
che è finita se $f$ è Hölder-continua di ordine $\alpha$.
A questo punto consideriamo lo spazio delle funzioni $f\in\cont[k]{\Omega}$ tali che le derivate $D^\alpha f$ con $\abs{\alpha}=k$ sono Hölder-continue di ordine $\beta\in(0,1]$: esso è indicato come $\cont[k,\beta]{\Omega}$, ed è uno spazio di Banach dotato della norma
\begin{equation}
    \norm{f}_{\cont[k,\beta]{\Omega}}\defeq\sum_{\abs{\gamma}\le k}\norm{D^\gamma f}_\infty+\sum_{\abs{\alpha}=k}[D^\alpha f]_\beta.
    \label{eq:norma-spazio-holder}
\end{equation}
Per $k=0$ si ha lo spazio delle funzioni Hölder-continue di ordine $\beta$ come definite nella \ref{d:continuita-holder}.
Questi spazi sono importanti per determinare la regolarità in senso classico delle funzioni in $\sobW[k,p]{\Omega}$, in modo che da una funzione definita quasi ovunque si possa tornare a una funzione classica, continua e regolare.

\begin{teorema}[Morrey] \label{t:morrey}
    Sia $\Omega\subset\R^n$ aperto, limitato e con bordo lipschitziano, e siano $k,p\in\N$ tali che $kp>n$: per $0\le m<k-\frac{n}{p}<m+1$ con $m\in\N_0$ si ha $\sobW[k,p]{\Omega}\emb\cont[m,\alpha]{\Omega}$ con $0\le\alpha\le k-m-\frac{n}{p}$.
    L'immersione è inoltre compatta se $\alpha<k-m-\frac{n}{p}$.
\end{teorema}
\begin{proof}
    Come per il teorema di Sobolev, anche in questo caso dimostriamo solo il caso $k=1$, e prendiamo $\Omega=\R^n$, ossia dimostriamo la tesi $\sobW[1,p]{\R^n}\emb\cont[0,\alpha]{\R^n}$ provando che esiste $c>0$ tale che $\norm{u}_{\cont[0,\alpha]{\R^n}}\le c\norm{u}_{1,p}$ con $p>n$ e $\alpha=1-\frac{n}{p}$, per ogni $u\in\cont[1]{\R^n}$.
    Omettiamo invece la seconda parte della dimostrazione, ossia dimostriamo solo che l'inclusione è continua.

    Sia $r>0$ e consideriamo la palla $B_r(\vec x)\subset\R^n$: mostriamo innanzitutto che
    \begin{equation}
        \avint_{B_r(\vec x)}\abs{u(\vec x)-u(\vec y)}\,\dd\mu(\vec y)\le c\int_{B_r(\vec x)}\frac{\norm{\grad u(\vec y)}}{\norm{\vec x-\vec y}^{n-1}}\,\dd\mu(\vec y).
        \label{eq:dim-morrey-obiettivo}
    \end{equation}
    Sia $\vec w\in\R^n$ di norma unitaria, e $0<s<r$: allora
    \begin{equation}
        u(\vec x+s\vec w)-u(\vec x)=
        \int_0^s\drv{u}{t}(\vec x+t\vec w)\,\dd t=
        \int_0^s\scalar{\vec w}{\grad u(\vec x+t\vec w)}\,\dd t.
    \end{equation}
    In valore assoluto,
    \begin{equation}
        \abs{u(\vec x+s\vec w)-u(\vec x)}\le
        \int_0^s\abs{\scalar{\vec w}{\grad u(\vec x+t\vec w)}}\,\dd t\le
        \int_0^s\norm{\grad u(\vec x+t\vec w)}\,\dd t.
    \end{equation}
    Integrando i due membri sul bordo della palla unitaria si ha
    \begin{equation}
        \int_{\boundary B_1(\vec 0)} \abs{u(\vec x+s\vec w)-u(\vec x)}\,\dd\sigma(\vec x)\le
        \int_{\boundary B_1(\vec 0)}\int_0^s \norm{\grad u(\vec x+t\vec w)}\,\dd t\,\dd\sigma(\vec x)=
        \int_{B_s(\vec 0)} \norm{\grad u(\vec x+t\vec w)}\,\dd\mu(\vec x).
    \end{equation}
    Cambiamo le variabili di integrazione ponendo $\vec y\defeq\vec x+t\vec w$ (da cui $t=\norm{\vec y-\vec x}$), per cui
    \begin{multline}
        \int_{B_s(\vec 0)} \norm{\grad u(\vec x+t\vec w)}\,\dd\mu(\vec x)=
        \int_{B_s(\vec 0)} \frac{t^{n-1}}{t^{n-1}}\norm{\grad u(\vec x+t\vec w)}\,\dd\mu(\vec x)=\\=
        \int_{B_s(\vec 0)} \frac{\norm{\grad u(\vec y)}}{\norm{\vec x-\vec y}^{n-1}}\,\dd\mu(\vec y)\le
        \int_{B_r(\vec 0)} \frac{\norm{\grad u(\vec y)}}{\norm{\vec x-\vec y}^{n-1}}\,\dd\mu(\vec y).
    \end{multline}
    Abbiamo dunque la disuguaglianza 
    \begin{equation}
        \int_{\boundary B_1(\vec 0)} \abs{u(\vec x+s\vec w)-u(\vec x)}\,\dd\sigma(\vec x)\le
        \int_{B_r(\vec 0)} \frac{\norm{\grad u(\vec y)}}{\norm{\vec x-\vec y}^{n-1}}\,\dd\mu(\vec y):
    \end{equation}
    Moltiplicando entrambi i membri per $s^{n-1}$ e integrando in $s\in(0,r)$ otteniamo
    \begin{multline}
        \int_{B_r(\vec 0)}\abs{u(\vec y)-u(\vec x)}\,\dd\mu(\vec y)\le
        \frac{r^n}{n}\int_{B_r(\vec 0)}\frac{\norm{\grad u(\vec y)}}{\norm{\vec x-\vec y}^{n-1}}\,\dd\mu(\vec y)=\\=
        \frac{r^n\omega_n}{n\omega_n}\int_{B_r(\vec 0)}\frac{\norm{\grad u(\vec y)}}{\norm{\vec x-\vec y}^{n-1}}\,\dd\mu(\vec y)=
        \frac{r^n\omega_n}{n}\avint_{B_r(\vec 0)}\frac{\norm{\grad u(\vec y)}}{\norm{\vec x-\vec y}^{n-1}}\,\dd\mu(\vec y),
    \end{multline}
    che dimostra la \eqref{eq:dim-morrey-obiettivo} con $\frac{r^n\omega_n}{n}$ come costante.

    Per $\vec x\in\R^n$ risulta
    \begin{multline}
        \abs{u(\vec x)}=
        \abs[\bigg]{\avint_{B_1(\vec x)} u(\vec x)\,\dd\mu(\vec y)}\le
        \avint_{B_1(\vec x)}\bigl[\abs{u(\vec x)-u(\vec y)}+\abs{u(\vec y)}\bigr]\,\dd\mu(\vec y)=\\=
        \avint_{B_1(\vec x)}\abs{u(\vec x)-u(\vec y)}\,\dd\mu(\vec y)+\frac1{\mu\bigl(B_1(\vec x)\bigr)}\int_{B_1(\vec x)}\abs{u(\vec y)}\,\dd\mu(\vec y).
    \end{multline}
    Con la disuguaglianza di Hölder stimiamo l'ultimo integrale come 
    \begin{equation}
        \int_{B_1(\vec x)}\abs{u}\,\dd\mu\le
        \biggl(\int_{B_1(\vec x)}\dd\mu\biggr)^\frac{p-1}{p}\biggl(\int_{B_1(\vec x)}\abs{u}^p\,\dd\mu\biggr)^\frac1{p}
    \end{equation}
    da cui, con la \eqref{eq:dim-morrey-obiettivo}, abbiamo
    \begin{equation}
        \abs{u(\vec x)}\le c\avint_{B_1(\vec x)} \frac{\norm{\grad u(\vec y)}}{\norm{\vec x-\vec y}^{n-1}}\,\dd\mu(\vec y)+c'\norm{u}_{\leb[p]{B_1(\vec x)}}.
    \end{equation}
    Sfruttando ancora la disuguaglianza di Hölder,
    \begin{equation}
        \int_{B_1(\vec x)} \frac{\norm{\grad u(\vec y)}}{\norm{\vec x-\vec y}^{n-1}}\,\dd\mu(\vec y)\le
        \biggl(\int_{\R^n}\norm{\grad u(\vec y)}^p\,\dd\mu(\vec y)\biggr)^\frac1{p}\biggl(\int_{B_1(\vec x)}\frac1{\norm{\vec x-\vec y}^{(n-1)\frac{p}{p-1}}}\,\dd\mu(\vec y)\biggr)^\frac{p-1}{p}:
    \end{equation}
    il primo fattore è $\norm{\grad u}_{\leb[p]{\R^n}}$, mentre per il secondo effettuiamo il cambio di variabile $r\defeq\norm{\vec x-\vec y}$ (che varia tra $0$ e $1$), e data la simmetria sferica della funzione integranda (attorno al punto $\vec x$) possiamo separare l'integrale radiale in $(0,1)$ da quello angolare su $\boundary B_1(\vec 0)$, vale a dire
    \begin{multline}
        \biggl(\int_{B_1(\vec x)}\frac1{\norm{\vec x-\vec y}^{(n-1)\frac{p}{p-1}}}\,\dd\mu(\vec y)\biggr)^\frac{p-1}{p}=
        \biggl(\int_{\boundary B_1(\vec 0)}\int_0^1 \frac1{r^{(n-1)\frac{p}{p-1}}}r^{n-1}\,\dd r\,\dd\sigma\biggr)^\frac{p-1}{p}=\\=
        \biggl(\int_{\boundary B_1(\vec 0)}\dd\sigma\int_0^1 \frac1{r^{(n-1)(1-\frac{p}{p-1})}}\,\dd r\biggr)^\frac{p-1}{p}=
        \biggl(n\omega_n\frac1{n-(n-1)\frac{p}{1-p}}\biggr)^\frac{p-1}{p}.
    \end{multline}
    Ora, si dimostra che quest'ultima quantità è (una costante) finita se $(n-1)p<n(p-1)$, vale a dire $\frac{n-1}{n}<\frac{p-1}{p}$ da cui $p>n$.
    Detta $c''$ tale costante, risulta allora
    \begin{equation}
        \int_{B_1(\vec x)}\frac1{\norm{\vec x-\vec y}^{(n-1)\frac{p}{p-1}}}\,\dd\mu(\vec y)\le
        c''\norm{\grad u}_{\leb[p]{\R^n}},
    \end{equation}
    da cui $\abs{u(\vec x)}\le cc''\norm{\grad u}_{\leb[p]{\R^n}}$.

    Siano ora $\vec x,\vec y\in\R^n$, $r\defeq\norm{\vec x-\vec y}$ come prima e chiamiamo $W\defeq B_r(\vec x)\cap B_r(\vec y)$.
    Risulta
    \begin{equation}
        \abs{u(\vec x)-u(\vec y)}=
        \avint_W \abs{u(\vec x)-u(\vec y)}\,\dd\mu(\vec z)\le
        \avint_W \abs{u(\vec x)-u(\vec z)}\,\dd\mu(\vec z)+\avint_W \abs{u(\vec y)-u(\vec z)}\,\dd\mu(\vec z).
    \end{equation}
    Siccome $W\subset B_r(\vec x)$ si ha, per il primo addendo (per il secondo è analogo)
    \begin{equation}
        \avint_W \abs{u(\vec x)-u(\vec z)}\,\dd\mu(\vec z)\le
        \frac1{\mu(W)}\int_{B_r(\vec x)}\abs{u(\vec x)-u(\vec z)}\,\dd\mu(\vec z)=
        \frac{\mu\bigl(B_r(\vec x)\bigr)}{\mu(W)}\avint_{B_r(\vec x)}\abs{u(\vec x)-u(\vec z)}\,\dd\mu(\vec z).
    \end{equation}
    Con la \eqref{eq:dim-morrey-obiettivo} e la disuguaglianza di Hölder, questo è a sua volta minore o uguale a
    \begin{multline}
        c\biggl(\int_{B_r(\vec x)}\norm{\grad u}^p\,\dd\mu\biggr)^\frac1{p}\biggl(\int_{B_r(\vec x)}\frac1{\norm{\vec x-\vec z}^{(n-1)\frac{p}{p-1}}}\,\dd\mu(\vec z)\biggr)^\frac{p-1}{p}\le\\ \le
        c\norm{\grad u}_{\leb[p]{\R^n}}\biggl(n\omega_n\int_0^r \frac1{s^\frac{p}{p-1}}\,\dd s\biggr)^\frac{p-1}{p}
        \tilde{c}\norm{\grad u}_{\leb[p]{\R^n}}(r^{n-(n-1)\frac{p}{p-1}})^\frac{p-1}{p}=
        \tilde{c}\norm{\grad u}_{\leb[p]{\R^n}}r^{1-\frac{n}{p}}
    \end{multline}
    per una $\tilde{c}>0$.
    La stessa stima vale per l'addendo con $\vec y$ al posto di $\vec x$, perciò
    \begin{equation}
        \abs{u(\vec x)-u(\vec y)}\le\tilde{c}r^{1-\frac{n}{p}}\norm{\grad u}_{\leb[p]{\R^n}}.
    \end{equation}
    Dividendo per $r^{1-\frac{n}{p}}=\norm{\vec x-\vec y}^{1-\frac{n}{p}}$, quando $\vec x\ne\vec y$, otteniamo dunque che
    \begin{equation}
        \frac{\abs{u(\vec x)-u(\vec y)}}{\norm{\vec x-\vec y}^{1-\frac{n}{p}}}\le\tilde{c}\norm{\grad u}_{\leb[p]{\R^n}}
    \end{equation}
    vale a dire
    \begin{equation}
        [u]_{1-\frac{n}{p}}=\norm{u}_{\cont[0,1-\frac{n}{p}]{\R^n}}\le\tilde{c}\norm{\grad u}_{\leb[p]{\R^n}}
    \end{equation}
    che prova che $\sobW[1,p]{\R^n}\emb\cont[0,1-\frac{n}{p}]{\R^n}$.
\end{proof}
Ad esempio se $\Omega\subset\R^3$ lo spazio $\sobW[2,2]{\Omega}$ è incluso con continuità in $\cont[0,\frac12]{\Omega}$ poich\'e per $k=p=2$ e $n=3$ si ha $0\le\alpha\le 2-m-\frac32$, e dato che $0\le m\le 2-\frac32=\frac12$ e $m\in\N_0$ deve essere $m=0$, per cui $0\le\alpha\le\frac12$.

Ora però abbiamo il problema che negli spazi di Sobolev gli elementi sono classi di equivalenza di funzioni, mentre negli spazi di Hölder ci sono funzioni vere e proprie.
Passiamo dall'una all'altra tramite la seguente definizione.
\begin{definizione} \label{d:versione}
    Data una funzione $u\colon A\to B$, diciamo che $\bar{u}$ è una \emph{versione} di $u$ se $u=\bar{u}$ quasi ovunque in $A$.
\end{definizione}
\begin{teorema} \label{t:versione-holder-continua}
    Sia $\Omega\subset\R^n$ aperto e $p>n$, e $u\in\sobWc[1,p]{\Omega}$.
    Allora $u$ ammette una versione $\bar{u}\in\cont[0,\gamma]{\Omega}$ per $\gamma=1-\frac{n}{p}$, tale che $\norm{\bar{u}}_{\cont[0,\gamma]{\Omega}}\le c\norm{u}_{1,p}$ per un certo $c>0$.
\end{teorema}
\begin{proof}
   Possiamo ancora estendere $\Omega$ a tutto $\R^n$ poich\'e $\supp u\subset\Omega$, ponendo $u=0$ al di fuori dell'insieme.
   La completezza dello spazio di Sobolev e la densità di $\contsc[\infty]{\Omega}$ assicurano che esiste una successione $\{u_k\}_{k\in\N}\subset\contsc[\infty]{\Omega}$ tale che $u_k\to u$, con $u\in\sobW[1,p]{\Omega}$ ma anche in $\sobW[1,p]{\R^n}$ estendo le $u_k$ come prima.
   Anche in questo caso vale $\norm{u_k-u_l}_{\cont[0,\gamma]{\Omega}}\le\norm{u_k-u_l}_{1,p}$ quindi se $\{u_k\}$ è di Cauchy in $\sobW[1,p]{\R^n}$ allora lo è anche in $\cont[0,\gamma]{\R^n}$, ossia esiste una funzione $\bar{u}\in\cont[0,\gamma]{\R^n}$ tale per cui $u_k\to\bar{u}$.
   Ma $u_k\to u$ in $\sobW[1,p]{\R^n}$, quindi $u$ e $\bar{u}$ (doev $u$ è vista come funzione) devono coincidere quasi ovunque, per l'unicità del limite, quindi $\bar{u}$ è una versione di $u$ in $\cont[0,\gamma]{\R^n}$.
   Dalla disuguaglianza $\norm{u_k}_{\cont[0,\gamma]{\R^n}}\le c\norm{u_k}_{1,p}$ infine, al limite per $k\to+\infty$, otteniamo $\norm{\bar{u}}_{\cont[0,\gamma]{\R^n}}\le c\norm{u}_{1,p}$.
\end{proof}

