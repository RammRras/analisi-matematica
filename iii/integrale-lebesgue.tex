\chapter{Misura e integrale di Lebesgue}
Avevamo visto nel capitolo \ref{ch:integrale-riemann} la teoria dell'integrazione sviluppata da Riemann.
Essa è utile nel calcolo integrale di molte funzioni comuni, ma risulta ancora limitata: la classe delle funzioni integrabili secondo Riemann è ampia, ma non comprende ad esempio i limiti delle successioni, difficili da analizzare in tale contesto.
L'integrale di Lebesgue si comporta meglio su questo tipo di funzioni, permettendo condizioni meno restrittive, e per questo risulta molto più adatta in questo campo.
Le funzioni integrabili secondo Lebesgue comprendono anche casi una volta considerati ``patologici'' come la funzione di Dirichlet: essa ha un integrale di Lebesgue, che è anche piuttosto semplice da calcolare, ma non di Riemann.

La costruzione dell'integrale di Lebesgue si fonda su una nuova teoria della misura, che permette di definire il concetto di insieme misurabile e funzione misurabile: si vedrà che trovare insiemi (e funzioni) non misurabili è molto difficile, ma comunque sarà essenziale distinguere tra le due classi.

\section{Misura esterna}
\label{sec:misura-esterna}
Siano $\vec a=(a_1,a_2,\dots,a_n)$ e $\vec b=(b_1,b_2,\dots,b_n)$ due punti in $\R^n$: l'iperrettangolo individuato dai due punti è il prodotto cartesiano dei vari intervalli chiusi $I=[a_1,b_1]\times[a_2,b_2]\times\dots\times[a_n,b_n]$.
Esso è un insieme compatto, e indicheremo il suo volume con $\vol{I}$, che vale
\begin{equation*}
	\vol{I}=\prod_{i=1}^n(b_i-a_i).
\end{equation*}
\begin{definizione} \label{d:ricoprimento-lebesgue}
	Sia $A\subseteq\R^n$.
	Un insieme numerabile di intervalli compatti $\{I_k\}_{k\in K}$, con $K\subseteq\N$, si dice \emph{ricoprimento di Lebesgue} di $A$ se $A\subseteq\bigcup_{k\in K}I_k$.
\end{definizione}
Esiste sempre un ricoprimento di Lebesgue per ogni insieme: se prendiamo $I_{\vec m}=[m_1,m_1+1]\times[m_2,m_2+1]\times\dots\times[m_n,m_n+1]$ ossia l'ipercubo con un vertice in $\vec m\in\R^n$ e spigolo unitario, l'unione (numerabile) $\bigcup_{\vec m\in\Z^n}I_{\vec m}$ ricopre qualsiasi insieme di $\R^n$.
Cominciamo a dare una prima approssimazione di quella che sarà la misura di un insieme.
\begin{definizione} \label{d:misura-esterna}
	Si definisce \emph{misura esterna} di un insieme $A\subseteq\R^n$ la quantità
	\begin{equation*}
		\mu^*(A)=\inf\bigg\{\sum_{k\in K}\vol{I_k}\colon\{I_k\}_{k\in K}\text{ è un ricoprimento di Lebesgue di }A\bigg\},
	\end{equation*}
	dove $K$ è un insieme numerabile.
\end{definizione}
Chiaramente $\mu^*$ è un numero reale, ma può anche essere infinito, come ad esempio la misura esterna di $\R$.
Dunque possiamo dire che $\mu^*$ è una funzione che associa ad un insieme di $\R^n$, quindi un elemendo dell'insieme delle parti un numero non negativo anche infinito, cioè $\mu^*\colon\mathcal P\to[0,+\infty]$.

La misura esterna di un iperrettangolo di volume $\vol{I}$ è chiaramente $\vol{I}$ stesso, che è il più piccolo ricoprimento possibile.
Infatti, per ogni iperrettangolo $I$ (non vuoto) ne esistono $\forall\epsilon>0$ inoltre altri due $H$ e $J$, con $H\subset\interior{I}\subset I\subset\interior{J}$ tali che $\vol{J}-\epsilon<\vol{I}<\vol{H}+\epsilon$.
Dato un ricoprimento di Lebesgue $\{I_k\}_{k\in K}$ di $I$, prendiamo $\{J_k\}_{k\in K}$ tale che, per ogni $k\in K$, $I_k\subset\interior{J_k}$ e che $\vol{J_k}-\frac{\epsilon}{2^k}<\vol{I_k}$.
Otteniamo che $I\subset\bigcup_{k\in K} I_k$, e allora anche $I\subset\bigcup_{k\in K}\interior{J_k}$.
Però $I$ è compatto, perciò esiste un $N\in\N$ per cui $I\subset\bigcup_{k=1}^NI_k$.
Allora
\begin{equation}
	\vol{I}\leq\sum_{i=1}^N\bigg(\vol{I_k}+\frac{\epsilon}{2^k}\bigg)=\sum_{i=1}^N(\vol{I_k}+\epsilon)\qqq\vol{I}\leq\epsilon+\inf\sum_{i=1}^N\vol{I_k}=\epsilon+\mu^*(I).
\end{equation}

\begin{proprieta} \label{pr:misura-esterna}
	La misura esterna soddisfa la seguenti proprietà: dati $A,B,A_k\in\R^n$ per $k\in K\subseteq\N$,
	\begin{enumerate}
		\item $\mu^*(\emptyset)=0$;
		\item $\mu^*(A)\in[0,+\infty]$ per qualsiasi $A$;
		\item è monotona, cioè se $A\subseteq B$ allora $\mu^*(A)\leq\mu^*(B)$;
		\item è subadditiva (numerabile), cioè $\mu^*\big(\bigcup_{k\in K}A_k\big)\leq\sum_{k\in K}\mu^*(A_k)$.
	\end{enumerate}
\end{proprieta}
\begin{proof}
	\begin{enumerate}
		\item Per ogni $\epsilon>0$ la famiglia $\{I\}=\{[0,\epsilon]^n\}$ (è composta da un solo iperrettangolo) è un ricoprimento di Lebesgue per l'insieme vuoto di $\R^n$.
			Poich\'e il suo volume è $\epsilon^n$, l'estremo inferiore tra tutti gli $\epsilon$ positivi dà $\mu^*(\emptyset)=0$.
		\item Per qualsiasi insieme $\{I_k\}_{k\in K}$ di iperrettangoli ($K$ misurabile), risulta ovviamente $0\leq\vol{I_k}<+\infty$, di conseguenza la somma di tutti i volumi è
			\begin{equation}
				0\leq\sum_{k\in K}\vol{I_k}\leq+\infty
			\end{equation}
			quindi anche prendendo l'estremo inferiore tra tutti i ricoprimenti di un qualsiasi $A$ si può avere $0\leq\mu^*(A)\leq+\infty$.
		\item Se $A\subseteq B$ allora ogni ricoprimento di Lebesgue di $B$ lo è anche di $A$, quindi i due insiemi dei ricoprimenti $\{I^A\}$ di $A$ e $\{I^B\}$ di $B$ soddisfano sempre $\{I^A\}\subseteq\{I^B\}$ quindi l'estremo inferiore del primo (cioè $\mu^*(A)$) non può essere maggiore dell'estremo inferiore del secondo.
		\item Se per qualche $k\in K$ si ha $\mu^*(A_k)=+\infty$ la proprietà è immediata, dunque sia $\mu^*(A_k)<+\infty$.
			Dalla definizione della misura, $\forall\epsilon>0$ esiste un ricoprimento di Lebesgue $\{I^k_j\}_{j\in J}$ di $A_k$ per cui
			\begin{equation}
				\sum_{j\in J}\vol{I^k_j}<\mu^*(A_k)+\frac{\epsilon}{2^k}.
			\end{equation}
			Unendo tutti i ricoprimenti per ogni $k\in K$ si ottiene che l'insieme $\{I^k_j\}_{j\in J,k\in K}$ è un ricoprimento di $\bigcup_{k\in K}A_k$, dunque
			\begin{equation}
				\mu^*\bigg(\bigcup_{k\in K}A_k\bigg)\leq\sum_{\substack{k\in K\\j\in J}}\vol{I^k_j}=\sum_{k\in K}\sum_{j\in J}\vol{I^k_j}\leq\sum_{k\in K}\bigg[\mu^*(A_k)+\frac{\epsilon}{2^k}\bigg]=\epsilon+\sum_{k\in K}\mu^*(A_k),
			\end{equation}
			potendo scegliere l'ordine della somma (prima su $j$ poi su $k$ o viceversa) poich\'e tutti gli addendi sono positivi.
			Per l'arbitrarietà di $\epsilon$, l'estremo inferiore si ottiene per $\epsilon=0$ da cui la tesi.\qedhere
	\end{enumerate}
\end{proof}
Un insieme si dice di \emph{misura nulla} se la sua misura esterna è zero.
Eccone alcuni esempi.
\begin{itemize}
	\item Se $I$ è dato dal prodotto di vari intervalli $[a_i,b_i]$ con $i\in\{1,\dots,n\}$, e per almeno un $j$ si ha $a_j=b_j$, allora
		\begin{equation}
			\mu^*(I)=\prod_{i=1}^n(b_i-a_i)=(a_j-a_j)\prod_{\substack{i=1\\i\neq j}}^n(b_i-a_i)=0.
		\end{equation}
	\item Se $A\in\R^n$ è composto di un solo punto, cioè $A=\{\vec a\}$, può essere scritto come $A=[a_1,a_1]\times\dots\times[a_n,a_n]$ quindi per il punto precedente $\mu^*(\{\vec a\})=0$.
	\item Un insieme $B$ finito o numerabile è l'unione numerabile di tanti punti, cioè $B=\bigcup_{j\in J}\{\vec b_j\}$ con $J\in\N$, quindi per la subadditività della misura esterna e per il punto precedente risulta
		\begin{equation}
			\mu^*(B)=\mu^*\bigg(\bigcup_{j\in J}\{\vec b_j\}\bigg)\leq\sum_{j\in J}\mu^*(\{\vec b_j\})=0.
		\end{equation}
	\item L'insieme $\Q$ dei razionali è numerabile, quindi $\mu^*(\Q)=0$ cos\'i come $\mu^*(\Q^n)=0$, pur essendo densi in $\R$ e $\R^n$.
	\item Ogni sottoinsieme di un insieme di misura nulla è a sua volta di misura nulla, per la monotonia della misura.
	\item Il bordo $\partial I$ di un iperrettangolo di $\R^n$ può essere scritto come l'unione delle sue $2n$ facce $F_i$, che sono a loro volta iperrettangoli degeneri (come nel primo di questi esempi), dunque
		\begin{equation}
			\mu^*(\partial I)=\mu^*\bigg(\bigcup_{i=1}^{2n} F_i\bigg)\leq\sum_{i=1}^{2n}\mu^*(F_i)=0.
		\end{equation}
\end{itemize}

Esistono anche insiemi non numerabili ma di misura nulla, come l'insieme di Cantor, definito come limite per induzione di
\begin{equation}
	\begin{aligned}
		C_0&=[0,1]\\
		C_1&=\Big[0,\frac13\Big]\cup\Big[\frac23,1\Big]\\
		C_2&=\Big[0,\frac19\Big]\cup\Big[\frac29,\frac13\Big]\cup\Big[\frac23,\frac79\Big]\cup\Big[\frac89,1\Big]\\
		\dots
	\end{aligned}
\end{equation}
sottraendo ad ogni passo un terzo dell'insieme precedente.
Al generico $n$ si hanno dunque $2^n$ intervalli chiusi, disgiunti ciascuno di diametro $3^{-n}$ e inclusi nell'insieme $C_{n-1}$.
L'insieme di Cantor è l'insieme che si ottiene con
\begin{equation}
	C=\bigcap_{n=1}^{+\infty}C_n.
\end{equation}
Non dimostriamo che non è numerabile; si può verificare che ogni punto di $C$ è un punto di accumulazione.
Si può però vedere intuitivamente che la misura di $C_n$ è $2^n/3^n$, quindi
\begin{equation}
	\mu^*(C)\leq\mu^*(C_n)=\frac{2^n}{3^n}\to 0
\end{equation}
cioè l'insieme è di misura nulla.

Dovendo sfruttare questa teoria della misura per l'integrazione, è di fondamentale importanza (come già facevamo per l'integrale di Riemann) che l'integrale si possa scomporre nella somma di integrali su vari sottoinsiemi.
Per avere questa proprietà per gli integrali bisogna chiaramente avere una proprietà \emph{additiva} per la misura degli insiemi, ossia che la misura dell'unione (numerabile) di due insiemi disgiunti corrisponda alla somma delle misure di ciascun insieme.
In breve, per $A,B\in\R^n$ e $A\cap B=\emptyset$, vogliamo che $\mu^*(A\cup B)=\mu^*(A)+\mu^*(B)$.
Per quello che abbiamo visto finora, la misura non gode di tale proprietà, ma di una più debole, la subadditività numerabile: in pratica sappiamo solo che $\mu^*(A\cup B)$ è minore o uguale della somma delle due misure, che quindi può essere più grande.
Esistono infatti insiemi disgiunti per cui la disuguaglianza è stretta, come nel celebre paradosso di Banach-Tarski, secondo il quale data la sfera unitaria $S$ esistono due insiemi disgiunti $A_1,A_2$ per i quali
\begin{equation}
	S=A_1\cup A_2\qeq \mu^*(A_1)=\mu^*(A_2)=\mu^*(S) 
\end{equation}
e se valesse l'additività numerabile per la misura esterna si avrebbe $\mu^*(S)=\mu^*(A_1)+\mu^*(A_2)=2\mu^*(S)$.

Per risolvere queste contraddizioni dobbiamo quindi rinunciare a poter misurare (con le proprietà volute) ogni sottoinsieme dello spazio, ossia dobbiamo accettare che esistono insiemi \emph{che non si possono misurare}.

\section{Misura di Lebesgue}
\label{sec:misura-lebesgue}
Dobbiamo trovare dunque un criterio che ci permetta di capire quando un insieme si può misurare.
La seguente costruzione della misura segue le idee di Carath\'eodory.
\begin{definizione} \label{d:lebesgue-misurabile}
	Un insieme $A\in\R^n$ si dice \emph{misurabile secondo Lebesgue} se vale la relazione
	\begin{equation}
		\mu^*(E)=\mu^*(A\cap E)+\mu^*(\compl A\cap E),
		\label{eq:lebesgue-misurabile}
	\end{equation}
	per ogni insieme $E\in\R^n$.
\end{definizione}
Indicheremo la classe degli insiemi di $\R^n$ misurabili secondo Lebesgue con la scrittura $\mis(\R^n)$.
\begin{definizione} \label{d:misura-lebesgue}
	Si definisce \emph{misura di Lebesgue} la restrizione della misura esterna $\mu^*$ all'insieme $\mis(\R^n)$.
\end{definizione}
La misura di Lebesgue, che indicheremo con $\mu$, coincide (quando è definita) con la misura esterna definita nella \ref{d:misura-esterna}, quindi la definizione rimane la stessa, e ovviamente ne eredità le proprietà già dimostrate.
Avendo ristretto però l'insieme di definizione ai soli insiemi che rispettano la \eqref{eq:lebesgue-misurabile}, possiamo aggiungerne altre molto importanti.
Tra queste, ovviamente, figurerà la proprietà additiva.
D'ora in poi con \emph{misurabile} intenderemo sempre misurabile secondo Lebesgue, e con \emph{misura} la misura di Lebesgue, dove non si presenteranno ambiguità.
\begin{proprieta} \label{pr:complementare-misurabile}
	Un insieme $A\in\R^n$ è misurabile se e solo se lo è il suo complementare.
\end{proprieta}
\begin{proof}
	Usando direttamente la \eqref{eq:lebesgue-misurabile} abbiamo che $\compl A$ è misurabile se
	\begin{equation}
		\mu^*(B)=\mu^*(B\cap\compl A)+\mu^*\big(B\cap\compl{(\compl A)}\big),
	\end{equation}
	per ogni $B\in\R^n$.
Poich\'e $\compl{(\compl A)}=A$, si ha esattamente la stessa equazione per $A$ anzich\'e per $\compl A$.
\end{proof}
Una nota per le seguenti dimostrazioni: sfrutteremo spesso la relazione \eqref{eq:lebesgue-misurabile} per dimostrare che un dato insieme $A$ è misurabile.
Poich\'e si ha per qualsiasi $E\in\R^n$ che $E=(E\cap A)\cup(E\cap\compl A)$, per la subadditività della misura esterna si ha sempre $\mu^*(E)\leq\mu^*(E\cap A)+\mu^*(E\cap\compl A)$, indipendentemente che $A$ sia misurabile o meno.
Quindi per mostrare la misurabilità di $A$ ci basterà dimostrare la disuguaglianza opposta, che è più significativa, cioè che
\begin{equation}
	\mu^*(E)\geq\mu^*(E\cap A)+\mu^*(E\cap\compl A).
\end{equation}
\begin{proprieta} \label{pr:misura-nulla}
	Ogni insieme $Z\in\R^n$ tale che $\mu^*(Z)=0$ è misurabile, e la sua misura di Lebesgue è nulla.
\end{proprieta}
\begin{proof}
	Poich\'e $E\cap\compl Z\subseteq E$, per la monotonia della misura esterna abbiamo
	\begin{equation}
		\mu^*(E)\geq\mu^*(E\cap\compl Z).
	\end{equation}
	Allo stesso modo, $E\cap Z\subseteq Z$, quindi $\mu^*(E\cap Z)\leq\mu^*(Z)$, ma $\mu^*(Z)=0$ per ipotesi, dunque anche $\mu^*(E\cap Z)=0$.
	Allora aggiungiamo $0=\mu^*(E\cap Z)$ alla disequazione precedente, che ovviamente rimane vera: risulta quindi
	\begin{equation}
		\mu^*(E)\geq\mu^*(E\cap Z)+\mu^*(E\cap\compl Z)
	\end{equation}
	e ciò prova che $Z$ è misurabile.
	Segue immediatamente che $\mu(Z)=\mu^*(Z)=0$.
\end{proof}
Non dimostriamo il seguente risultato, anch'esso decisamente intuitivo.
\begin{proprieta} \label{pr:misura-iperrettangolo}
	Ogni iperrettangolo, prodotto di intervalli compatti, è misurabile, e la sua misura coincide con il suo volume.
\end{proprieta}
Passiamo ora a dimostrare come si comporta la misura di Lebesgue rispetto alle operazioni insiemistiche, cioè il complementare di un insieme, la sottrazione e le unioni e intersezioni (anche infinite, purch\'e numerabili).
\begin{proprieta} \label{pr:misura-unione-intersezione}
	Siano $A,B\in\mis(\R^n)$:
	\begin{enumerate}
		\item $A\cup B$, $A\cap B$ e $A\setminus B$ sono numerabili;
		\item se $A\cap B=\emptyset$, allora $\mu(A\cup B)=\mu(A)+\mu(B)$;
		\item se $B\subseteq A$ e $\mu(B)<+\infty$, allora $\mu(A\setminus B)=\mu(A)-\mu(B)$.
	\end{enumerate}
\end{proprieta}
\begin{proof}
	\begin{enumerate}
		\item Dimostriamo che l'unione è misurabile: preso un qualunque $E\in\R^n$, applicando la \eqref{eq:lebesgue-misurabile} ad $A$ abbiamo
			\begin{equation}
				\mu^*(E)=\mu^*(E\cap A)+\mu^*(E\cap\compl A).
			\end{equation}
			Anche $B$ è misurabile, e certamente $E\cap\compl A$ è un insieme di $\R^n$, quindi applicando ancora la definizione abbiamo
			\begin{equation}
				\mu^(E\cap\compl A)=\mu^*(E\compl A\cap B)+\mu^*(E\compl A\cap\compl B),
			\end{equation}
			e sostituendo nella prima si ha
			\begin{equation}
				\mu^*(E)=\mu^*(E\cap A)+\mu^*(E\cap\compl A\cap B)+\mu^*(E\compl A\cap\compl B).
			\end{equation}
			Ora, per la proprietà distributiva dell'unione rispetto all'intersezione abbiamo che
			\begin{equation}
				(E\cap A)\cup(E\cap\compl A\cap B)=E\cap\big[A\cup(\compl A\cap B)\big]=E\cap\big[(A\cup\compl A)\cap(A\cup B)\big]=E\cap(A\cup B),
			\end{equation}
			dunque per la subadditività della misura esterna $\mu^*(E\cap A)+\mu^*(E\cap\compl A\cap B)\leq\mu^*\big(E\cap(A\cup B)\big)$.
			Allo stesso tempo, $\compl A\cap\compl B=\compl{(A\cup B)}$, quindi
			\begin{equation}
				\mu^(E)\geq\mu^*\big(E\cap(A\cup B)\big)+\mu^*\big(E\cap\compl{(A\cup B)}\big),
			\end{equation}
			e ciò prova che $A\cup B$ è misurabile.
			
			Dalla proprietà \ref{pr:complementare-misurabile} sappiamo che $\compl A$ e $\compl B$ sono misurabili, e per quanto appena visto lo è anche $\compl A\cup\compl B$.
			Ma $\compl A\cup\compl B=\compl{(A\cap B)}$ quindi anche $A\cap B$ sempre per la proprietà \ref{pr:complementare-misurabile} è misurabile.

			Per $A\setminus B$, basta ricordare che esso è uguale $A\cap\compl B$, quindi anch'esso è misurabile.
		\item Poich\'e $A,B\in\mis(\R^n)$, $A\cup B$ è misurabile dunque $\mu(A\cup B)=\mu^*(A\cup B)$.
			Usiamo questo insieme (che ovviamente è sottoinsieme di $\R^n$) nella \eqref{eq:lebesgue-misurabile} con $A$, anch'esso misurabile, per cui
			\begin{equation}
				\begin{split}
					\mu(A\cup B)=\mu^*(A\cup B)&=\mu^*\big((A\cup B)\cap A\big)+\mu^*\big((A\cup B)\cap\compl A\big)=\\
					&=\mu^*\big((A\cap A)\cup(A\cap B)\big)+\mu^*\big((A\cup B)\setminus A\big),
				\end{split}
			\end{equation}
			e dato che $A\cap A=A$, $A\cap B=\emptyset$ e $(A\cup B)\setminus A=B$ troviamo che
			\begin{equation}
				\mu(A\cup B)=\mu^*(A\cup B)=\mu^*(A)+\mu^*(B)=\mu(A)+\mu(B).
			\end{equation}
		\item Poich\'e $B\subseteq A$, vale ovviamente $A=(A\setminus B)\cup B$.
			Gli insiemi $A\setminus B$ e $B$ hanno intersezione vuota, perciò per il punto precedente
			\begin{equation}
				\mu(A)=\mu(A\setminus B)+\mu(B)
			\end{equation}
			da cui la tesi.\qedhere
	\end{enumerate}
\end{proof}
Per induzione, segue immediatamente da questo teorema che l'unione e intersezione \emph{finite} di insiemi sono ancora insiemi numerabili, e che la misura è additiva se tutti gli insiemi sono disgiunti.
Procediamo finalmente a dimostrare la proprietà di additività numerabile che abbiamo annunciato all'inizio di questa sezione.
\begin{proprieta} \label{pr:additivita-numerabile-lebesgue}
	Sia $\{A_n\}_{n\in\N}$ una famiglia di insiemi misurabili di $\R^n$.
	Allora l'unione e l'intersezione (numerabili) $\bigcup_{n=1}^{+\infty}+A_n$ e $\bigcap_{n=1}^{+\infty}A_n$ sono insiemi numerabili.
	Se inoltre $A_i\cap A_j=\emptyset$ per ogni $i\neq j$, allora
	\begin{equation}
		\mu\bigg(\bigcup_{n=1}^{+\infty}A_n\bigg)=\sum_{n=1}^{+\infty}\mu(A_n).
		\label{eq:additivita-numerabile-lebesgue}
	\end{equation}
\end{proprieta}
\begin{proof}
	Notiamo innanzitutto che possiamo considerare gli insiemi $A_n$ mutualmente disgiunti, senza perdere generalità: se già non lo fossero, ci basterebbe prendere la famiglia $\{B_n\}_{n\in\N}$ dove
	\begin{equation}
		B_1=A_1,\ B_2=A_2\setminus A_1, B_3=A_3\setminus(A_2\cup A_1),\dots,B_k=A_m\setminus(A_1\cup\dots\cup A_{m-1}),
	\end{equation}
	che sono per costruzione mutualmente disgiunti, e tali che
	\begin{equation}
		\bigcup_{n=1}^{+\infty}B_n=\bigcup_{n=1}^{+\infty}A_n
	\end{equation}
	quindi si perviene agli stessi risultati.
	Consideriamo dunque $A_j\cap A_i=\emptyset$ per ogni $i\neq j$.

	Definiamo $F_k\defeq\bigcup_{n=1}^kA_n$, per $k\in\N$, che è misurabile per quanto visto nella proprietà \ref{pr:misura-unione-intersezione}.
	Per la \eqref{eq:lebesgue-misurabile} applicata ad $A_k$, che è misurabile per ipotesi, abbiamo $\forall k\in\N$
	\begin{equation}
		\begin{split}
			\mu^*(E\cap F_k)&=\mu^*\big( (E\cap F_k)\cap A_k\big)+\mu^*\big( (E\cap F_k)\cap\compl{A_k}\big)=\\
			&=\mu^*\big((E\cap(F_k\cap A_k)\big)+\mu^*\big(E\cap (F_k\setminus A_k)\big)=\\
			&=\mu^*(E\cap A_k)+\mu^*(E\cap F_{k-1}).
		\end{split}
	\end{equation}
	per qualsiasi $E\subseteq\R^n$.
	Iterando il procedimento con $F_{k-1}$, anch'esso ovviamente misurabile, otteniamo che $\mu^*(E\cap F_{k-1})=\mu^*(E\cap A_{k-1})+\mu^*(E\cap F_{k-1})$.
	Continuiamo dunque in questo modo fino a esaurire gli $A_n$, arrivando a $\mu^*(E\cap F_2)=\mu^*(E\cap A_2)+\mu^*(E\cap F_1)$, ma $F_1=A_1$ quindi infine
	\begin{equation}
		\mu^*(E\cap F_k)=\sum_{n=1}^k\mu^*(E\cap A_n).
	\end{equation}
	Passiamo a calcolare $\mu^*(E\cap\compl{F_k})$.
	Definiamo $F\defeq\bigcup_{n=1}^{+\infty}A_n$.
	Poich\'e $F_k\subseteq F$, passando ai complementari risulta $\compl F\subseteq\compl{F_k}$: intersecandoli entrambi con un $E\in\R^n$ qualsiasi allora $E\cap\compl F\subseteq E\cap\compl{F_k}$,  da cui per la monotonia della misura esterna $\mu^*(E\cap\compl F)\leq\mu^*(E\cap\compl{F_k})$.
	Allora possiamo affermare che
	\begin{equation}
		\begin{split}
			\mu^*(E)&=\mu^*(E\cap F_k)+\mu^*(E\cap\compl{F_k})\geq\\
			&\geq\mu^*(E\cap F_k)+\mu^*(E\cap\compl F)=\\
			&=\sum_{n=1}^k\mu^*(E\cap A_n)+\mu^*(E\cap\compl F)
		\end{split}
	\end{equation}
	per ogni $E\subset\R^n$.
	Poiche vale $\forall k\in\N$, passando al limite per $k\to+\infty$ continua a valere la disuguaglianza, cioè
	\begin{equation}
		\mu^*(E)\geq\sum_{n=1}^{+\infty}\mu^*(E\cap A_n)+\mu^*(E\cap\compl F).
		\label{eq:dim-additivita-numerabile}
	\end{equation}
	Per la subadditività numerabile, inoltre, abbiamo che
	\begin{equation}
		E\cap F=E\cap\bigg(\bigcup_{n=1}^{+\infty}A_n\bigg)=\bigcup_{n=1}^{+\infty}(E\cap A_n)\quad\then\quad\mu^*(E\cap F)\leq\sum_{n=1}^{+\infty}\mu^*(E\cap A_n),
	\end{equation}
	dunque
	\begin{equation}
		\mu^*(E)\geq\mu^*(E\cap F)+\mu^*(E\cap\compl F)
	\end{equation}
	perciò $F$ è misurabile.
	Per la seconda parte della testi, prendiamo nella \eqref{eq:dim-additivita-numerabile} proprio l'insieme $F$ al posto di $E$, per cui $\mu(F)=\mu^*(F)$ essendo misurabile:
	\begin{equation}
		\mu(F)=\mu^*(F)=\sum_{n=1}^{+\infty}\mu^*(F\cap A_n)+\mu^*(F\cap\compl F).
	\end{equation}
	Poich\'e $F\cap A_n=A_n$ e $F\cap\compl F=\emptyset$, otteniamo
	\begin{equation}
		\mu(F)=\mu\bigg(\bigcup_{n=1}^{+\infty}A_n\bigg)=\sum_{n=1}^{+\infty}\mu(A_n).
	\end{equation}

	Dimostrato il caso dell'unione, è immediato verificare anche la tesi per l'intersezione dato che
	\begin{equation}
		\bigcap_{n=1}^{+\infty}A_n=\compl{\bigg(\bigcup_{n=1}^{+\infty}\compl{A_n}\bigg)}.\qedhere
	\end{equation}
\end{proof}

Concludiamo la serie di teoremi con un corollario sulle successioni di insiemi monotone, da intendersi rispetto alle operazioni di inclusione: diremo che una successione $\{E_k\}_{k\in\N}$ di insiemi è \emph{crescente} se $A_k\subset A_{k+1}$ per ogni $k$, e analogamente diremo che è decrescente se $A_k\supseteq A_{k+1}$.
\begin{corollario} \label{cor:misura-successioni-insiemi}
	Sia $\{A_k\}_{k\in\N}$ una successione di insiemi misurabili:
	\begin{itemize}
		\item se la successione è crescente, allora
			\begin{equation}
				\mu\bigg(\bigcup_{k=1}^{+\infty}A_k\bigg)=\lim_{k\to+\infty}\mu(A_k);
			\end{equation}
		\item se la successione è decrescente, allora
			\begin{equation}
				\mu\bigg(\bigcap_{k=1}^{+\infty}A_k\bigg)=\lim_{k\to+\infty}\mu(A_k).
			\end{equation}
	\end{itemize}
\end{corollario}

Le proprietà dimostrate finora rendono la classe degli insiemi di $\R^n$ misurabili una \emph{$\sigma$-algebra}, ossia un insieme $\mathfrak S$ tale che
\begin{enumerate}
	\item l'insieme vuoto appartiene a $\mathfrak S$;
	\item se un insieme è in $\mathfrak S$, allora anche il suo complementare è in $\mathfrak S$;
	\item se gli elementi di una famiglia numerabile di insiemi $\{A_i\}_{i\in\N}$ sono in $\mathfrak S$, allora anche l'unione numerabile $\bigcup_{i\in\N}A_i$ appartiene a $\mathfrak S$.
\end{enumerate}
Se $\mathfrak S$ è una $\sigma$-algebra su un insieme $X$, la coppia $(X,\mathfrak S)$ si dice \emph{spazio misurabile}.
Dalla definizione segue immediatamente che in uno spazio misurabile
\begin{itemize}
	\item $X\in\mathfrak S$, in quanto complementare di $\emptyset$ rispetto a s\'e stesso;
	\item anche l'intersezione numerabile di insiemi di $\mathfrak S$ è un insieme di $\mathfrak S$, come visto nella dimostrazione della proprietà \ref{pr:additivita-numerabile-lebesgue} applicando le leggi di De Morgan;
	\item se due insiemi appartengono a $\mathfrak S$, anche la loro opportuna sottrazione vi appartiene.
\end{itemize}
Infine, dato uno spazio misurabile $(X,\mathfrak S)$ e una misura positiva $\lambda$ definita sulla $\sigma$-algebra $\mathfrak S$ (costituita dai sottoinsiemi misurabili di $X$), la terna $(X,\mathfrak S,\lambda)$ si chiama \emph{spazio di misura}.
Per quanto detto finora, la terna $\big(\R^n,\mis(\R^n),\mu\big)$ è proprio uno spazio di misura.

\section{Struttura degli insiemi misurabili}
\label{sec:struttura-insiemi-misurabili}
Abbiamo finora caratterizzato la misura di Lebesgue con le sue importanti proprietà, mostrando come si comporta con le operazioni tra gli insiemi.
Abbiamo inoltre ridotto la classe degli insiemi ammissibili ad un sottoinsieme di $\R^n$, ma come sono fatti questi insiemi misurabili?
\begin{teorema}
	Ogni insieme aperto, chiuso o compatto di $\R^n$ è misurabile, e la misura di un insieme compatto è sempre finita.
\end{teorema}
\begin{proof}
	Se $A\in\R^n$ è aperto, allora esiste sempre una famiglia di intervalli compatti, o iperrettangoli, $\{I_k\}_{k\in\N}$ separati, cioè per cui
	\begin{equation*}
		\interior{I_i}\cap\interior{I_j}=\emptyset\text{ per }i\neq j,\text{ e }\bigcup_{k\in\N}I_k=A.
	\end{equation*}
	Segue dalla proprietà additiva \ref{pr:additivita-numerabile-lebesgue} che $A$ è misurabile in quanto unione numerabile di insiemi numerabili.

	Un insieme chiuso, in quanto complementare di un aperto, è anch'esso misurabile.
	Infine un insieme compatto $K$ in $\R^n$ è chiuso e limitato, quindi è certamente misurabile.
	Per la limitatezza inoltre si può sempre contenere in un iperrettangolo $\mathcal I$, per cui $\mu(K)\leq\mu(\mathcal I)<+\infty$.
\end{proof}

Introduciamo ora due particolari classi di insiemi, gli insiemi di tipo $G_\delta$ e di tipo $F_\sigma$, definite come:
\begin{itemize}
	\item un insieme $G\subset\R^n$ si dice di tipo $G_\delta$ se è risultato di un'intersezione numerabile di insiemi aperti, ossia se $G=\bigcap_{n\in\N}A_n$ con $A_n$ aperto per ogni $n$;
	\item un insieme $F\subset\R^n$ si dice di tipo $F_\sigma$ se è risultato di un'unione numerabile di insiemi chiusi, cioè se $F=\bigcup_{n\in\N}C_n$ con $C_n$ chiuso per ogni $n$.
\end{itemize}
Si noti che gli insiemi di queste classi sono ovviamente misurabili, ma gli insiemi $G_\delta$ non sono necessariamente aperti, come i $F_\sigma$ non sono necessariamente chiusi.
Tramite queste classi possiamo caratterizzare gli insiemi misurabili in generale.
\begin{lemma} \label{l:aperti-chiusi-poco-differenti}
	Sia $A\in\mis(\R^n)$ e $\epsilon$ un numero positivo arbitrario: allora
	\begin{itemize}
		\item esiste un insieme $U$ aperto (in dipendenza da $\epsilon$) tale per cui $A\subset U$ e $\mu(U\setminus A)<\epsilon$;
		\item esiste un insieme $F$ chiuso (sempre in dipendenza da $\epsilon$) per il quale $F\subset A$ e $\mu(A\setminus F)<\epsilon$.
	\end{itemize}
\end{lemma}
\begin{teorema} \label{t:gdelta-fsigma-misurabili}
	Sia $E\subseteq\R^n$ un insieme misurabile qualsiasi.
	Allora
	\begin{itemize}
		\item esistono un insieme $G$ di tipo $G_\delta$ e un insieme $Z$ di misura nulla tali che $E=G\setminus Z$;
		\item esistono un insieme $F$ di tipo $F_\sigma$ e un insieme $Z$ di misura nulla tali che $E=F\cup Z$.
	\end{itemize}
\end{teorema}
\begin{proof}
	Scegliamo un $\epsilon=\frac1{k}$, e per il lemma precedente \ref{l:aperti-chiusi-poco-differenti} troviamo per ogni $k$ un insieme $G_k\supset E$ tale che $\mu(G_k\setminus E)<\frac1{k}$.
	Poniamo $G\defeq\bigcap_{k\in\N}G_k$ e $Z=G\setminus E$.
	Esso è misurabile, per come è costruito; inoltre risulta
	\begin{equation}
		G=(G\cap E)\cup(G\cap\compl E)=(G\cap E)\cup(G\setminus E)=E\cup Z,
	\end{equation}
	poich\'e $G\subseteq E$ e $G\setminus E=Z$.
	Segue quindi che $E=G\setminus Z$, prendendo l'intersezione con $\compl Z$ in entrambi i membri.
	La misura di $Z$ è quindi
	\begin{equation}
		\mu(Z)=\mu(G\setminus E)=\mu\Bigg(\bigg(\bigcap_{k\in\N}G_k\bigg)\setminus E\Bigg)=\mu\bigg(\bigcap_{k\in\N}(G_k\setminus E)\bigg)=\lim_{k\to+\infty}\mu(G_k\setminus E)<\lim_{k\to+\infty}\frac1{k}=0.
	\end{equation}

	Per dimostrare la seconda parte, prendiamo stavolta $F_k\subset E$ tali che $\mu(E\setminus F_k)<\frac1{k}$.
	La dimostrazione è del tutto analoga al caso precedente.
\end{proof}
Il seguente teorema fornisce un'ulteriore caratterizzazione.
\begin{teorema}
	Un insieme $A\subseteq\R^n$ è misurabile se e solo se $\forall\epsilon>0$ esistono un insieme $F$ chiuso e un $U$ aperto tali che $F\subseteq A\subseteq U$ e $\mu(U\setminus F)<\epsilon$.
\end{teorema}
\begin{proof}
	Dato $A$ misurabile, l'esistenza di $F$ e $U$ come dati nella tesi è garantita per il lemma \ref{l:aperti-chiusi-poco-differenti}, dunque esistono sempre $U$ aperto e $F$ chiuso per i quali $\mu(A\setminus F)<\epsilon$ e $\mu(U\setminus A)<\epsilon$ per qualsiasi scelta di $\epsilon>0$.
	Poich\'e $\mu(U\setminus F)\leq\mu(U\setminus A)+\mu(A\setminus F)$, otteniamo $\mu(U\setminus F)<2\epsilon$, da cui la tesi per l'arbitrarietà di $\epsilon$.

	Partiamo ora dall'ipotesi $\mu(U\setminus F)<\epsilon$.
	Scegliamo $\epsilon=\frac1{n}$ con $n\in\N$, e per ciascun valore di $n$ prendiamo un $F_n$ chiuso e un $U_n$ aperto tali che $F_n\subseteq A\subseteq U_n$ e $\mu(U_n\setminus F_n)<\frac1{n}$.
	Definiamo $H\defeq\bigcap_{j\in\N}U_j$ e $K\defeq\bigcup_{j\in\N}F_j$: notiamo che essi sono rispettivamente di tipo $G_\delta$ e $F_\sigma$.
	Calcoliamo la misura esterna di $M\defeq H\setminus A$: risulta
	\begin{equation}
		\mu^*(M)=\mu^*(H\setminus A)\leq\mu^*(H\setminus K)\leq\mu^*(U_j\setminus F_j)<\frac1{j}
	\end{equation}
	per ogni $j\in\N$ ed è allora di misura nulla.
	Poich\'e da $M=H\setminus A$ segue
	\begin{equation}
		M\cup A=H\qqq (M\cup A)\setminus M=H\setminus M\qqq A=H\setminus M,
	\end{equation}
	e $H$ è di tipo $G_\delta$ e $M$ ha misura nulla, $A$ soddisfa il primo punto del teorema \ref{t:gdelta-fsigma-misurabili} dunque è misurabile.
	Una dimostrazione analoga si ha per $P\defeq A\setminus K$, anch'esso di misura nulla.
\end{proof}

\section{Funzioni misurabili}
\label{sec:funzioni-misurabili}
\begin{definizione} \label{d:funzione-misurabile}
	Dato un insieme $A\in\mis(\R^n)$, una funzione $f\colon A\to\Rex$ si dice \emph{misurabile} (su $A$) se l'insieme $\{\vec x\in A\colon f(\vec x)<c\}$ è misurabile per qualsiasi $c\in\Rex$.
\end{definizione}
Osserviamo che la scelta del segno $<$ è del tutto arbitraria ai fini della definizione: mostriamo che se $\{\vec x\in A\colon f(\vec x)<c\}$ è misurabile, allora anche gli insiemi $\{\vec x\in A\colon f(\vec x)\leq c\}$, $\{\vec x\in A\colon f(\vec x)>c\}$ e $\{\vec x\in A\colon f(\vec x)\geq c\}$ lo sono.
\begin{itemize}
	\item Se $c\in\R$ possiamo scrivere $\{f(\vec x)\leq c\}$ come $\bigcap_{k=1}^{+\infty}\{f(\vec x)<c+\frac1{k}\}$, che è un insieme di tipo $G_\delta$ e dunque misurabile.
		Se $c=+\infty$, $\{f(\vec x)\leq c\}=A$ che è misurabile.
		Se $c=-\infty$, infine, scriviamo $\{f(\vec x)\leq c\}=\bigcap_{k=1}^{+\infty}\{f(\vec x)<-k\}$ che è ancora di tipo $G_\delta$ quindi misurabile.
	\item $\{f(\vec x)>c\}=A\setminus\{f(\vec x)\leq c\}$ quindi è misurabile essendo la differenza di insiemi misurabili.
	\item Per $c\in\R$, $\{f(\vec x)\geq c\}=\bigcap_{k=1}^{+\infty}\{f(\vec x)>c+\frac1{k}\}$, quindi è di tipo $G_\delta$, e misurabile.
		Se $c=+\infty$, $\{f(\vec x)\geq c\}=\bigcap_{k=1}^{+\infty}\{f(\vec x)>k\}$ che è ancora $G_\delta$, quindi misurabile.
		Se $c=-\infty$, $\{f(\vec x)\geq c\}=A$ che è misurabile.
	\item $\{f(\vec x)<c\}=A\setminus\{f(\vec x)\geq c\}$ quindi è misurabile come differenza di insiemi misurabili.
\end{itemize}
Le quattro definizioni sono quindi in realtà del tutto intercambiabili.
Passiamo ora a considerare gli insiemi \emph{di livello} della funzione.
\begin{teorema} \label{t:insiemi-livello-funzione-misurabile}
	Sia $f\colon A\to\Rex$ misurabile, con $A\in\mis(\R^n)$.
	Allora per ogni $c\in\Rex$ l'insieme $\{\vec x\in A\colon f(\vec x)=c\}$ è misurabile.
\end{teorema}
\begin{proof}
	Individuiamo tre casi: se $c\in\R$, abbiamo che $\{f(\vec x)=c\}=\{f(\vec x)\geq c\}\cap\{f(\vec x)\leq c\}$ ed è quindi misurabile.
	Se $c=+\infty$, $\{f(\vec x)=c\}=\bigcap_{k=1}^{+\infty}\{f(\vec x)\geq k\}$ mentre per $c=-\infty$ $\{f(\vec x)=c\}=\bigcap_{k=1}^{+\infty}\{f(\vec x)\leq -k\}$ dunque sono entrambi insiemi di tipo $G_\delta$, perciò misurabili.
\end{proof}
Come ci si può aspettare, non tutte le funzioni sono misurabili.
Una semplice funzione misurabile è la funzione caratteristica di un insieme misurabile: se $E\notin\mis(\R^n)$, la funzione $f\colon E\to\Rex$ definita come $f(\vec x)=\chi_E(\vec x)$ non è misurabile perch\'e l'insieme di livello $\{x\in E\colon \chi_E(\vec x)=1\}$ è proprio l'insieme $E$, dunque non è misurabile, e non lo è nemmeno la funzione per il teorema appena enunciato.

\begin{teorema} \label{t:funzioni-continue-misurabili}
	Sia $A\in\mis(\R^n)$ e $f\colon A\to\R$.
	Se $f$ è continua in $A$ allora è misurabile.
\end{teorema}
\begin{proof}
	L'insieme $\{x\in A\colon f(\vec x)<c\}$ è aperto in quanto controimmagine dell'insieme aperto $(-\infty,c)$, dunque è misurabile, perciò è misurabile anche $f$.
\end{proof}
\begin{osservazione} \label{o:funzione-misurabile-su-insieme-nullo}
	Se $A\in\mis(\R^n)$ è di misura nulla, qualsiasi funzione $f\colon A\to\Rex$ è misurabile.
\end{osservazione}
\begin{proof}
	Prendiamo infatti per un $c\in\Rex$ qualsiasi l'insieme $Z_c=\{\vec x\in A\colon f(\vec x)<c\}$.
	Poich\'e esso è incluso in $A$, risulta $\mu^*(Z_c)\leq\mu^*(A)=\mu(A)=0$, dunque $Z_c$ è misurabile per ogni $c\in\Rex$, ed è quindi misurabile $f$.
\end{proof}
Il seguente teorema ci permette di stabilire la misurabilità di una funzione a partire dalle sue restrizioni ad insiemi minori e viceversa.
\begin{teorema} \label{t:funzione-misurabile-restrizioni}
	Sia $f\colon A\to\Rex$ con $A=A_1\cup A_2$ dove $A_1$ e $A_2$ sono misurabili.
	Allora $f$ è misurabile se e solo se $f|_{A_1}$ e $f|_{A_2}$ lo sono.
\end{teorema}
\begin{proof}
	Sia $f$ misurabile: per ogni $c\in\Rex$, l'insieme $\{x\in A_1\colon f|_{A_1}<c\}=\{\vec x\in A\colon f(\vec x)<c\}\cap A_1$ è misurabile come intersezione di insiemi misurabili, dunque $f|_{A_1}$ è misurabile, e lo stesso per $f|_{A_2}$.

	Siano ora le due restrizioni misurabili: allora $\forall c\in\Rex$ $\{\vec x\in A_1\colon f|_{A_1}(\vec x)<c\}$ e $\{\vec x\in A_2\colon f|_{A_2}(\vec x)<c\}$ sono misurabili, e lo è la loro unione, ma
	\begin{equation}
		\begin{aligned}
			&\{\vec x\in A_1\colon f|_{A_1}(\vec x)<c\}\cup\{\vec x\in A_2\colon f|_{A_2}(\vec x)<c\}=\\
			&=\big(\{\vec x\in A\colon f(\vec x)<c\}\cap A_1\big)\cup\big(\{\vec x\in A\colon f(\vec x)<c\}\cap A_2\big)=\\
			&=\{\vec x\in A\colon f(\vec x)<c\}\cap(A_1\cup A_2)=\\
			&=\{\vec x\in A\colon f(\vec x)<c\}\cap A=\\
			&=\{\vec x\in A\colon f(\vec x)<c\}
		\end{aligned}
	\end{equation}
	per ogni $c\in\Rex$, quindi anche $f$ è misurabile.
\end{proof}
Introduciamo inoltre un tipo di uguaglianza ``quasi ovunque'' all'interno dello spazio delle funzioni misurabili con il seguente teorema\footnote{Ricordiamo che una proprietà è verificata \emph{quasi ovunque} (spesso abbreviato con q.o.) in un certo insieme $A$ se il sottoinsieme $B\subset A$ in cui non si verifica ha misura nulla.}.
\begin{teorema} \label{t:misurabile-qo}
	Siano $f,g\colon A\to\Rex$, con $A\in\mis(\R^n)$, tali che $f(\vec x)=g(\vec x)$ per ogni $\vec x\in A\setminus Z$ dove $\mu(Z)=0$.
	Allora $f$ è misurabile se e solo se lo è $g$.
\end{teorema}
\begin{proof}
	Sia $f$ misurabile: poniamo $B=A\setminus Z$, da cui $A=B\cap Z$.
	Sappiamo che $g|_Z$ è misurabile come visto nell'osservazione \ref{o:funzione-misurabile-su-insieme-nullo} poich\'e $\mu(Z)=0$.
	D'altra parte $g|_{B}=f|_{B}$ per ipotesi, dunque se $f$ è misurabile lo è anche $g|_B$.
	Per il teorema \ref{t:funzione-misurabile-restrizioni} $g$ è misurabile.
	Se partiamo dalla misurabilità di $g$ anzich\'e da quella di $f$ la dimostrazione è del tutto analoga.
\end{proof}
Altri esempi di proprietà che posso verificarsi quasi ovunque sono la convergenza puntuale di una successione di funzioni, o il segno di una funzione.
Mostriamo ora nei seguenti che operando con funzioni misurabili (anche attraverso limiti e estremi superiori e inferiori) otteniamo ancora una funzione misurabile, con un'eccezione solo per la composizione.
\begin{lemma}
	Siano $f,g\colon A\to\Rex$, con $A\in\mis(\R^n)$, due funzioni misurabili.
	Allora l'insieme $\{\vec x\in A\colon f(\vec x)>g(\vec x)\}$ è misurabile.
\end{lemma}
\begin{proof}
	Sia $E=\{\vec x\in A\colon f(\vec x)>g(\vec x)\}$, che è tale per cui $E\subseteq A$.
	Preso $\vec x\in E$, $f(\vec x)>g(\vec x)$ quindi per la densità dei razionali nei reali possiamo individuare un numero $r\in\Q$ tale che $f(\vec x)>r>g(\vec x)$.
	Allora $\vec x\in\{\vec x\in E\colon f(\vec x)>r\}\cap\{\vec x\in E\colon g(\vec x)<r\}$, dunque
	\begin{equation}
		E=\bigcup_{r\in\Q}\big(\{\vec x\in E\colon f(\vec x)>r\}\cap\{\vec x\in E\colon g(\vec x)<r\}\big)
	\end{equation}
	che è quindi misurabile come unione di aperti.
\end{proof}
\begin{proprieta} \label{pr:operazioni-funzioni-misurabili}
	Se le funzioni $f,g\colon A\to\Rex$, con $A\in\mis(\R^n)$, sono misurabili in $A$, allora anche le funzioni $\lambda f$ (con $\lambda\in\R$), $f+g$, $fg$ e $f/g$ (se $g\neq0$ in $A$) lo sono.
\end{proprieta}
\begin{proof}
	\begin{itemize}
		\item Se $\lambda>0$, l'insieme $\{\vec x\in A\colon \lambda f(\vec x)<c\}$ equivale per ogni $c\in\R$ a $\{\vec x\in A\colon f(\vec x)<\frac{c}{\lambda}\}$ che è misurabile per la misurabilità di $f$.
			Se $\lambda=0$ è invece equivalente all'insieme $\{\vec x\in A\colon 0<c\}$ che è o tutto $A$ se $c>0$ o l'insieme vuoto se $c\leq 0$, e in entrambi i casi sono insiemi misurabili.
			Se $\lambda<0$ è equivalente a $\{\vec x\in A\colon f(\vec x)>\frac{c}{\lambda}\}$ che è ancora misurabile come nel primo caso.
		\item L'insieme $\{\vec x\in A\colon (f+g)(\vec x)<c\}$ equivale a $\{\vec x\in A\colon f(\vec x)<c-g(\vec x)\}$.
			Chiamiamo $c-g(\vec x)=h(\vec x)$, e per il lemma precedente l'insieme $\{\vec x\in A\colon f(\vec x)<h(\vec x)\}$ è misurabile, quindi lo è $f+g$.
		\item Mostriamo prima che $f^2$ è misurabile, ossia che $\{\vec x\in A\colon f^2<c\}$ lo è per ogni $c\in\Rex$.
			Se $c\geq 0$, è equivalente a $\{\{\vec x\in A\colon f(\vec x)>\sqrt{c}\}\cup\{\vec x\in A\colon f(\vec x)<-\sqrt{c}\}$ che è misurabile come unione di misurabili.
			Se $c<0$, chiaramente $\{\vec x\in A\colon [f(\vec x)]^2>c\}=A$ quindi è ancora misurabile.
			Dunque, poich\'e $(f+g)^2-(f-g)^2=f^2+g^2+2fg-f^2-g^2+2fg=4fg$, abbiamo $fg=\frac14[(f+g)^2-(f-g)^2]$ quindi è misurabile.
		\item Lasciata come esercizio.\qedhere
	\end{itemize}
\end{proof}
\begin{proprieta} \label{pr:estremi-successioni-funzioni-misurabili}
	Sia $\{f_k\}_{k\in\N}$ una successione di funzioni misurabili su $A\in\mis(\R^n)$.
	Allora sono misurabili le funzioni $\inf_{k\in\N}f_k$, $\sup_{k\in\N}f_k$, $\liminf_{k\to+\infty}f_k$ e $\limsup_{k\to+\infty}f_k$.
\end{proprieta}
\begin{proof}
	Poich\'e $\mis(\R^n)$ è una $\sigma$-algebra, e
	\begin{equation}
		\bigg\{\vec x\in A\colon \sup_{k\in\N}f_k(\vec x)>c\bigg\}=\bigcup_{k\in\N}\{\vec x\in A\colon f_k(\vec x)>c\},
	\end{equation}
	$\sup_{k\in\N}f_k$ è misurabile in $A$.
	Anche l'estremo inferiore è misurabile in $A$ perch\'e $\inf_{k\in\N}f_k=-\sup_{k\in\N}(-f_k)$.

	Per i due limiti abbiamo infine
	\begin{equation}
		\liminf_{k\to+\infty}f_k=\sup_{j\in\N}\big(\inf_{k\geq j}f_k\big)\qeq\limsup_{k\in\N}f_k=\inf_{j\in\N}\big(\sup_{k\geq j}f_k\big)
	\end{equation}
	dunque anch'essi sono misurabili.
\end{proof}
Da queste proprietà segue immediatamente che se una successione di funzioni misurabili in un insieme $A$ converge puntualmente, la funzione limite è anch'essa misurabile in $A$, poich\'e il limite superiore e inferiore (che sono misurabili) coincidiono e sono uguali al limite.
Questo vale anche se la convergenza è quasi ovunque, in virtù del teorema \ref{t:misurabile-qo}.

Data una funzione $f$ misurabile, inoltre, per quest'ultimo teorema la sua parte positiva e la sua parte negativa sono misurabili, in quanto $F^+=\max\{f,0\}$ e $f^-=\max\{-f,0\}$, cos\'i come lo è il suo modulo $\abs{f}=f^+-f^-$ come somma di funzioni misurabili.
\begin{proprieta} \label{pr:composizione-funzioni-misurabili}
	Sia $f\colon A\to\R$, con $A\in\mis(\R^n)$, misurabile in $A$.
	Se $g\colon B\to\R$, con $f(A)\subset B\subset\R$, è continua in $B$, allora $g\circ f\colon A\to\R$ è misurabile.
\end{proprieta}
\begin{proof}
	L'insieme $\{\vec x\in A\colon (g\circ f)(\vec x)<c\}$ è la controimmagine dell'intervallo $(-\infty,c)$, cioè equivale a $(g\circ f)^{-1}\big( (-\infty,c)\big)=f^{-1}\big[g^{-1}\big((-\infty,c)\big)\big]$ per ogni $c\in\R$.
	Per la continuità di $g$, l'insieme $g^{-1}\big( (-\infty,c)\big)$ è aperto perch\'e controimmagine di un aperto, dunque possiamo esprimerlo come unione numerabile di intervalli compatti:
	\begin{equation}
		g^{-1}\big( (-\infty,c)\big)=\bigcup_{n\in\N}[a_n,b_n],
	\end{equation}
	perciò prendendo la controimmagine di $f$ abbiamo
	\begin{equation}
		\begin{split}
			\{\vec x\in A\colon (g\circ f)(\vec x)<c\}&=f^{-1}\Big((g^{-1}\big( (-\infty,c)\big)\Big)=\\
			&=f^{-1}\bigg(\bigcup_{n\in\N}[a_n,b_n]\bigg)=\\
			&=\bigcup_{n\in\N}f^{-1}\big([a_n,b_n]\big)=\\
			&=\bigcup_{n\in\N}\big(\{\vec x\in A\colon f(\vec x)\geq a_n\}\cup\{\vec x\in A\colon f(\vec x)\leq b_n\}\big)
		\end{split}
	\end{equation}
	che è un insieme misurabile, quindi $g\circ f$ è misurabile.
\end{proof}
Una facile conseguenza di questa proprietà è che se $A\in\mis(\R^n)$ e $f\colon A\to\R$ è misurabile, allora lo è anche $\abs{f}^p$ per ogni $p>0$.
Infatti basta vederla come composizione $g\circ f$ dove $g\colon\R\to\R$ è definita come
\begin{equation}
	g(x)=
	\begin{cases}
		0&x\leq 0\\
		x^p&x>0
	\end{cases}
\end{equation}
che è evidentemente continua in tutto $\R$.
\begin{osservazione} \label{o:funzione-caratteristica-misurabile}
	La funzione caratteristica di un insieme $A$ è misurabile se e solo se $A$ è misurabile.
\end{osservazione}
\begin{proof}
	Prendiamo $\chi_A\colon\R^n\to{0,1}$.
	Se $c>1$, risulta $\{\vec x\in A\colon\chi_A(\vec x)<c\}=\R^n$.
	Se $0<c\leq1$, $\{\vec x\in A\colon \chi_A(\vec x)<c\}=\compl A$, poich\'e $\chi_A(\vec x)=0$ se $\vec x\notin A\then\vec x\in\compl A$.
	Se $c\leq 0$ infine $\{\vec x\in A\colon \chi_A(\vec x)<c\}=\emptyset$.
	In tutti i tre i casi gli insiemi sono misurabili.
\end{proof}

\section{Integrale di Lebesgue}
Prima di definire l'integrale, ci serve prima capire come approssimare le funzioni misurabili con un tipo particolare di funzioni, dette \emph{semplici}.
\begin{definizione} \label{d:funzione-semplice}
	Una funzione $f\colon\R^n\to\R$ è detta \emph{semplice} se assume un numero finito di valori $\{c_1,\dots,c_n\}\subset\R$ con $n\in\N$ (finito) e $c_i\neq c_j$ se $i\neq j$.
\end{definizione}
Le funzioni semplici possono essere rappresentate in quella che è detta \emph{forma canonica} come una somma finita di funzioni caratteristiche: infatti se poniamo $A_i$ come la controimmagine di $c_i$ attraverso $f$, ossia $A_i=f^{-1}(\{c_i\})$ per ciascun $i\in\{1,\dots,n\}$, allora si deve avere necessariamente $A_i\cap A_j=\emptyset$ per $i\neq j$, poich\'e $f$ (è una funzione!) può avere solo un'immagine per ogni $\vec x\in\R^n$.
In tale insieme $A_i$ la $f$ corrisponde alla funzione $c_i\chi_{A_i}$, quindi possiamo rappresentare la funzione semplice come
\begin{equation}
	f=\sum_{i=1}^nc_i\chi_{A_i},
	\label{eq:rappresentazione-canonica-funzione-semplice}
\end{equation}
ossia come combinazione lineare di funzioni semplici, dove tutti gli insiemi $A_i$ sono mutualmente disgiunti e tali che $\bigcup_{i=1}^nA_i=\R^n$.
Chiaramente una funzione semplice è misurabile se tutti gli $A_i$ sono insiemi misurabili.
Una funzione semplice può essere definita anche solo su un sottoinsieme di $\R^n$, se essa è nulla al di fuori di tale sottoinsieme.

\begin{teorema} \label{t:funzione-semplice-misurabile}
	Sia $A\in\mis(\R^n)$: ogni funzione misurabile $f\colon A\to\Rex$ è il limite puntuale di una successione di funzioni semplici misurabili su $A$.
	Inoltre, se $f$ non è negativa su $A$, tale successione può essere scelta non negativa e crescente.
\end{teorema}
\begin{proof}
	Mostriamo prima che, posto vero il secondo punto, il primo ne è una conseguenza: poi dimostreremo il secondo punto.
	Dividiamo la funzione $f$, misurabile, in parte positiva e negativa, $f=f^+-f^-$: entrambe sono non negative e misurabili.
	Per il secondo punto, esistono dunque due successioni di funzioni semplici, che chiamiamo $\{s^+_k\}_{k\in\N}$ e $\{s^-_k\}_{k\in\N}$, crescenti e per le quali
	$s^+_k\to f^+$ e $s^-_k\to f^-$.
	Ma allora prendendo la loro differenza si ha una nuova successione, $s^+_k-s^-_k$, che converge a $f^+-f^+=f$ per $k\to+\infty$.

	Dimostriamo ora il secondo punto: sia $f$ non negativa e misurabile su $A$.
	Suddividiamo il codominio di $f$, ossia $[0,+\infty]$, in $4^k+1$ intervalli della forma
	\begin{equation*}
		B^j_k\defeq\Big[\frac{j-1}{2^k},\frac{j}{2^k}\Big]\text{ per ogni }j=1,\dots,4^k
	\end{equation*}
	e poniamo $B_k^{4^k+1}\defeq[2^k,+\infty]$.
	Definiamo inoltre $A_k^j\defeq f^{-1}(B^j_k)$ per ogni $j=1,\dots,4^k+1$: essendo controimmagini (tramite una funzione misurabile) di intervalli, che sono insiemi misurabili, questi $A^j_k$ sono tutti misurabili.
	Su questi insiemi approssimiamo $f$ per difetto, ossia poniamo
	\begin{equation}
		c^j_k=
		\begin{cases}
			\frac{j-1}{2^k} &j=1,\dots,4^k\\
			2^k &j=4^k+1
		\end{cases}.
	\end{equation}
	Prendiamo dunque la funzione
	\begin{equation}
		s_k=\sum_{j=1}^{4^k}\frac{j-1}{2^k}\chi_{A^j_k}+2^k\chi_{A^{k+1}_k},
	\end{equation}
	che chiaramente è una funzione semplice e non negativa.
	Essa inoltre non è decrescente, dato che ogni coefficiente $c^j_k$ è crescente, quindi $0\leq s_k\leq s_{k+1}\leq f$ in $A$.
	Verifichiamo infine che converge: se $f=+\infty$, allora $s_k(\vec x)=2^k$ è la successione convergente a $f$.
	Se invece $f<+\infty$, allora $0\leq f(\vec x)-s_k(\vec x)\leq \frac1{2^k}\to 0$ dunque $s_k$ converge puntualmente a $f$ in $A$.
\end{proof}

Possiamo finalmente dare la definizione di integrale di Lebesgue: lo faremo in ``tre pezzi'', cominciando dall'integrale per le funzioni semplici, proseguendo con l'integrale per funzioni misurabili non negative, e infine per funzioni misurabili qualunque.
Indicheremo, nella forma più generale, l'integrale di una funzione $f$ su un insieme $E$ con il simbolo $\int_Ef\,\dd\mu$, tralasciando la variabile $\vec x\in E$; il simbolo $\mu$ sottolinea che l'integrazione è svolta rispetto alla misura $\mu$ di Lebesgue.
Definiamo inoltre convenzionalmente $0\cdot\infty=0$.
\begin{definizione} \label{d:integrale-lebesgue-funzioni-semplici}
	Sia $s\colon\R^n\to[0,+\infty)$ una funzione semplice e misurabile.
	Data la sua rappresentazione canonica $s=\sum_{j=1}^n c_j\chi_{E_j}$ con $E_j\in\mis(\R^n)$ e $c_j\in\R$ e	$c_i\neq c_j$ per $i\neq j$, definiamo l'integrale di Lebesgue di $s$ su $\R^n$ come
	\begin{equation}
		\int_{\R^n}s\,\dd\mu\defeq \sum_{j=1}^nc_j\mu(E_j).
		\label{eq:integrale-lebesgue-funzioni-semplici}
	\end{equation}
	Definiamo inoltre l'integrale di $s$ su $A\subset\R^n$ come
	\begin{equation}
		\int_As\,\dd\mu\defeq \sum_{j=1}^nc_j\mu(E_j\cap A).
	\end{equation}
\end{definizione}
Esso è un numero in $[0,+\infty]$, dato che un $E_j$ potrebbe avere misura infinita.
Con la convenzione introdotta prima di questa definizione abbiamo inoltre che se $c_i=0$, allora $c_i\mu(E_i)=0$ indipendentemente dalla misura di $A$.

Un primo esempio immediato è la funzione di Dirichlet $\chi_{\Q}$: il suo integrale in $[0,1]$ è
\begin{equation*}
	\int_{[0,1]}\chi_{\Q}(x)\dd x=1\cdot\mu\big(\Q\cap[0,1]\big)+0\cdot\mu\big( (\R\setminus\Q)\cap[0,1]\big)
\end{equation*}
ma l'insieme $\Q\cap[0,1]$ ha misura nulla, dunque l'integrale è nullo.

Possiamo subito dimostrare alcune proprietà dell'integrale per funzioni semplici.
\begin{teorema} \label{t:integrale-funzioni-semplici-additivita-numerabile-insieme}
	Sia $s\colon A\to\R$ una funzione semplice e $A=\bigcup_{i=1}^{+\infty}A_i$, con $A_i\in\mis(\R^n)$ $\forall i\in\N$ e $A_i\cap A_j=\emptyset$ per $i\neq j$.
	Allora
	\begin{equation}
		\int_As\,\dd\mu=\sum_{i=1}^{+\infty}\int_{A_i}s\,\dd\mu
		\label{eq:integrale-funzioni-semplici-additivita-numerabile-insieme}
	\end{equation}
\end{teorema}
\begin{proof}
	Prendiamo la rappresentazione canonica di $s$ come $\sum_{j=1}^nc_j\chi_{B_j}$, con $B_j=\{\vec x\in\R^n\colon s(\vec x)=c_j\}$.
	Dalla definizione \ref{d:integrale-lebesgue-funzioni-semplici} di integrale abbiamo $\int_As\,\dd\mu=\sum_{j=1}^nc_j\mu(B_j\cap A)$, dunque per l'additività della misura
	\begin{equation}
		\int_As\,\dd\mu=\sum_{j=1}^n\sum_{i=1}^{+\infty}c_j\mu(B_j\cap A_i)=\sum_{i=1}^{+\infty}\sum_{j=1}^nc_j\mu(B_j\cap A_i)=\sum_{i=1}^{+\infty}\int_{A_i}s\,\dd\mu.\qedhere
	\end{equation}
\end{proof}
\begin{teorema} \label{t:integrale-funzioni-semplici-linearita}
	Siano $s,t\colon\R^n\to\R$ due funzioni semplici e $A\in\mis(\R^n)$: allora
	\begin{equation}
		\int_E(s+t)\dd\mu=\int_Es\,\dd\mu+\int_Et\,\dd\mu.
		\label{eq:integrale-funzioni-semplici-linearita}
	\end{equation}
\end{teorema}
\begin{proof}
	Siano $s=\sum_{i=1}^pc_i\chi_{A_i}$ e $t=\sum_{i=1}^qd_i\chi_{B_i}$ le rappresentazioni canoniche delle due funzioni, con $A_i$ e $B_i$ definiti come al solito come le controimmagini di $c_i$ e $d_i$ rispettivamente.
	Risulta $\bigcup_{i=1}^pA_i=\bigcup_{i=1}^{q}B_i=\R^n$.
	Ma allora dal teorema precedente possiamo scrivere
	\begin{equation}
		\begin{split}
			\int_E(s+t)\dd\mu&=\sum_{i=1}^p\sum_{j=1}^q\int_{E\cap A_i\cap B_j}(s+t)\dd\mu=\\
			&=\sum_{i=1}^p\sum_{j=1}^q(c_i+d_j)\mu(E\cap A_i\cap B_j)=\\
			&=\sum_{i=1}^pc_i\sum_{j=1}^q\mu(E\cap A_i\cap B_j)+\sum_{i=1}^p\sum_{j=1}^qd_i\mu(E\cap A_i\cap B_j)=\\
			&=\sum_{i=1}^pc_i\sum_{j=1}^q\mu(E\cap A_i\cap B_j)+\sum_{j=1}^qd_j\sum_{i=1}^p\mu(E\cap A_i\cap B_j)=\\
			&=\sum_{i=1}^pc_i\mu(E\cap A_i)+\sum_{j=1}^qd_j\mu(E\cap B_j)=\\
			&=\int_Es\,\dd\mu+\int_Et\,\dd\mu.\qedhere
		\end{split}
	\end{equation}
\end{proof}

Generalizziamo quindi l'integrale a funzioni misurabili non negative.
\begin{definizione} \label{d:integrale-lebesgue-funzioni-nonnegative}
	Sia $f\colon A\to[0,+\infty]$ misurabile con $A\in\mis(\R^n)$.
	L'integrale di Lebesgue di $f$ su $A$ è definito come
	\begin{equation}
		\int_Af\,\dd\mu\defeq \sup_{s\in\mathcal S_f}\int_As\,\dd\mu,
		\label{eq:integrale-lebesgue-funzioni-nonnegative}
	\end{equation}
	dove $\mathcal S_f$ è l'insieme delle funzioni semplici misurabili per le quali $0\leq s(\vec x)\leq f(\vec x)$ $\forall\vec x\in A$.
\end{definizione}
Anche in questo caso l'integrale è un numero in $[0,+\infty]$.
Eccone alcuni esempi:
\begin{itemize}
	\item se $\mu(A)=0$, l'integrale sarà sempre nullo.
		Infatti per qualsiasi $f\geq 0$ misurabile, per ogni $s\in\mathcal S_f$ si ha
		\begin{equation}
			0\leq \sum_{j=1}^nc_j\mu(E_j\cap A)
		\end{equation}
		ma $E_j\cap A$ è un sottoinsieme di $A$ quindi $\mu(E_j\cap A)\leq\mu(A)=0$ per ogni $j\in\{1,\dots,n\}$.
	\item Lo stesso discorso vale se $f$ è identicamente nulla su $A$, perch\'e in questo caso l'unica funzione semplice misurabile $s$ per cui $0\leq s\leq f$ in $A$ è anch'essa identicamente nulla, quindi $\int_Af\,\dd\mu=\int_As\,\dd\mu=0\mu(A)=0$ con la convenzione adottata.
	\item Se $f$ è limitata superiormente e la misura di $A$ è finita, allora l'integrale è finito, perch\'e per ogni $s\in\mathcal S_f$
		\begin{equation}
			\int_Af\,\dd\mu\leq\max_{\vec x\in A}f(\vec x)\sum_{j=1}^n\mu(A\cap E_j)=\max_{\vec x\in A}f(\vec x)\mu(E)<+\infty.
		\end{equation}
\end{itemize}

Concludiamo quindi con l'ultima definizione.
\begin{definizione} \label{d:integrale-lebesgue-funzioni-qualunque}
	Sia $f\colon A\to\R$ misurabile, con $A\in\mis(\R^n)$.
	Essa si dice integrabile secondo Lebesgue su $A$ se esiste \emph{finito} almeno uno degli integrali della parte positiva o negativa, ossia uno tra
	\begin{equation*}
		\int_Af^+\dd\mu\text{ e }\int_Af^-\dd\mu.
	\end{equation*}
	In tal caso, l'integrale di Lebesgue di $f$ su $A$ è definito come
	\begin{equation}
		\int_Af\,\dd\mu=\int_Af^+\dd\mu-\int_Af^-\dd\mu.
		\label{eq:integrale-lebesgue-funzioni-qualunque}
	\end{equation}
\end{definizione}
In questo caso l'integrale è un numero di $\Rex$, ma esiste certamente in quanto si evita la forma indeterminata $+\infty-\infty$, dato che uno dei due addendi sicuramente è finito.
Una funzione non negativa è sempre integrabile su qualunque insieme, perch\'e qualunque sia il valore di $f^+$ il suo integrale della parte negativa sarà sempre nullo.
\begin{definizione} \label{d:funzione-sommabile}
	Una funzione $f$ si dice \emph{sommabile} sull'insieme $A$ se entrambi gli integrali $\int_Af^+\dd\mu$ e $\int_Af^-\dd\mu$ sono finiti\footnote{L'uso di questi due termini non sempre è usata come ora: si possono trovare testi in cui ``integrabile'' significa quello che qui intendiamo come sommabile, e ``esiste l'integrale di Lebesgue'' dove qui diciamo che è integrabile.}.
\end{definizione}
In questo caso l'integrale è un numero finito, e ovviamente una funzione sommabile è integrabile ma non viceversa.
Notiamo inoltre che la sommabilità di $f$ è equivalente a quella di $\abs{f}$, perciò per verificare se $f$ è sommabile basta studiare il suo valore assoluto.
Indicheremo che una funzione $f$ è sommabile nell'insieme $E$ con la scrittura $f\in L(E)$.

L'integrale si può anche indicare, esplicitando le varie coordinate, con le scritture
\begin{equation*}
	\int_Af(x_1,\dots,x_n)\dd x_1\dots\dd x_n,\ \iint_Af(x,y)\dd x\dd y,\ \iiint_Af(x,y,z)\dd x\dd y\dd z,\ \idotsint_Af(x_1,\dots,x_n)\dd x_1\dots\dd x_n.
\end{equation*}

Come ci si può aspettare, l'integrale di Lebesgue gode delle stesse proprietà dell'integrale di Riemann: si tratta ora di dimostrarle nuovamente in luce della nuova teoria.
Lasceremo sottinteso d'ora in poi che $\mathcal S_f$ è l'insieme delle funzioni semplici $s$ tali che $0\leq s\leq f$ nell'insieme dato.
\begin{proprieta} \label{pr:integrale-lebesgue}
	Siano $f,g\colon\R^n\to\Rex$ misurabili, e $A\in\mis(\R^n)$.
	\begin{enumerate}
		\item $\int_Af\,\dd\mu=\int_{\R^n}f\chi_A\dd\mu$.
		\item Se $f(\vec x)\leq g(\vec x)$ per ogni $\vec x\in A$, allora $\int_A f\,\dd\mu\leq\int_Ag\,\dd\mu$.
		\item Se $f(\vec x)\geq 0$ per ogni $\vec x\in A$ e $c\in[0,+\infty)$, allora $\int_Acf\,\dd\mu=c\int_Af\,\dd\mu$, e se $f\in L(A)$ e $c\in\R$, allora $cf\in L(A)$.
		\item Per $E\subseteq A$ misurabile, $\int_Ef\,\dd\mu\leq\int_Af\,\dd\mu$.
	\end{enumerate}
\end{proprieta}
\begin{proof}
	\begin{enumerate}
		\item Poich\'e $\int_Af\,\dd\mu=\sup_{s\in\mathcal S_f}\int_As\,\dd\mu$, esso è anche uguale a $\sup\int_{\R^n}s\,\dd\mu$ per $0\leq s\leq f\chi_A$ in $A$, quindi è uguale a $\int_{\R^n}f\chi_A\dd\mu$.
		\item Dato che $0\leq s\leq f\leq g$ in $A$, risulta $\mathcal S_f\subseteq\mathcal S_g$, quindi
			\begin{equation}
				\int_Ad\dd\mu=\sup_{s\in\mathcal S_f}\int_As\,\dd\mu\leq\sup_{s\in\mathcal S_g}\int_As\,\dd\mu=\int_Ag\,\dd\mu.
			\end{equation}
		\item Se $c=0$ la tesi è ovvia, quindi prendiamo $c\in(0,+\infty)$.
			Risulta
			\begin{multline}
				\int_Acf\,\dd\mu=\sup_{s\in\mathcal S_{cf}}\int_As\,\dd\mu=\sup_{t\in\mathcal S_f}\int_Act\,\dd\mu=\\
				=\sup\sum_{j=1}^ncd_j\mu(A_j)=c\sup\sum_{j=1}^nd_j\mu(A_j)=c\sup_{t\in\mathcal S_f}\int_At\,\dd\mu=c\int_Af\,\dd\mu,
			\end{multline}
			dove $\sum_{j=1}^nd_j\chi_{A_j}$ è la rappresentazione canonica delle funzioni semplici $t$.
			A questo punto, per una generica funzione $f$ misurabile otteniamo $cf=c(f^+-f^-)=cf^+-cf^-$ da cui
			\begin{equation}
				\int_Acf\,\dd\mu=c\int_Af^+\dd\mu-c\int_Af^-\dd\mu=c\int_Af\,\dd\mu.
			\end{equation}
			È evidente a questo punto che se $f\in L(A)$ il suo integrale esiste finito, dunque è finito che l'integrale di $cf$, che quindi è a sua volta sommabile.
			La proprietà vale anche, ovviamente se $c<0$: basta ricordarsi che $f=f^+-f^-$ dunque $cf=cf^+-cf^-$ e applicare quanto detto alla parte positiva e negativa, che sono entrambe funzioni non negative.
		\item Si ha che $0\leq f\chi_E\leq f$ in $A$, perciò per il secondo punto
			\begin{equation}
				\int_Ef\,\dd\mu=\int_Af\chi_E\dd\mu\leq \int_Af\,\dd\mu.\qedhere
			\end{equation}
	\end{enumerate}
\end{proof}
Tra le proprietà principali manca la linearità dell'integrale, che finora abbiamo dimostrato solo per le funzioni semplici.
Per dimostrarla ci serve però il teorema della convergenza monotona, quindi rimandiamo questo punto a più avanti.

Come avevamo anticipato all'inizio del capitolo, uno dei motivi principali che hanno portato allo sviluppo dell'integrale di Lebesgue è giustificare il passaggio del limite nell'integrale con ipotesi meno restrittive che con l'integrale di Riemann.
Passiamo dunque ad elencare i teoremi più importanti in questo ambito, che ci permetteranno lo scambio tra limite e integrale con solamente la convergenza puntuale e qualche altra ipotesi più semplice da verificare.
\begin{teorema}[della convergenza monotona, di Beppo Levi] \label{t:convergenza-monotona}
	Sia $\{f_n\}_{n=1}^{+\infty}$ una successione di funzioni con $f_n\colon A\to[0,+\infty)$ e $A\in\mis(\R^n)$.
	Se la successione è crescente, cioè $f_n(\vec x)\leq f_{n+1}(\vec x)$ $\forall\vec x\in A$, e converge puntualmente in $A$ alla funzione $f$, allora
	\begin{equation}
		\lim_{n\to+\infty}\int_Af_n\dd\mu\int_Af\,\dd\mu
		\label{eq:convergenza-monotona}
	\end{equation}
\end{teorema}
\begin{proof}
	Per la monotonia dell'integrale (proprietà \ref{pr:integrale-lebesgue}, punto 2) si ha $\int_Af_n\dd\mu\leq\int_Af_{n+1}\dd\mu$, dunque la successione degli integrali è anch'essa monotona crescente, che quindi ammette limite per $n\to+\infty$.
	Allo stesso tempo, $f_n\leq f$ per ogni $n\in\N$: allora per il teorema di permanenza del segno
	\begin{equation*}
		\lim_{n\to+\infty}\int_Af_n\dd\mu\leq\int_Af\,\dd\mu.
	\end{equation*}
	Sia ora $s\in\mathcal S_f$, e definiamo $A_n\defeq\{\vec x\colon f_n(\vec x)\geq \alpha s(\vec x)\}$ con $0<\alpha<1$.
	Tutti i punti $f_n(\vec x)$ saranno definitivamente ``al di sopra'' di $\alpha s$, dato che $A_n\subseteq A_{n+1}$ da cui $\bigcup_{n=1}^nA_n=A$.
	Allora risulta
	\begin{equation}
		\int_Af_n\dd\mu\leq\int_{A_n}f\,\dd\mu\leq\alpha\int_{A_n}s\,\dd\mu=\sum_{i=1}^n\alpha\int_{A_i\setminus A_{i-1}}s\,\dd\mu.	
	\end{equation}
	Però per ogni $i>j$ si ha $(A_i\setminus A_{i-1})\cap(A_j\setminus A_{j-1})=\emptyset$, poich\'e $A_j\setminus A_{j-1}\subseteq A_{i-1}$, dunque abbiamo
	\begin{equation}
		\sum_{i=1}^n\alpha\int_{A_i\setminus A_{i-1}}s\,\dd\mu=\sum_{i=1}^{+\infty}\alpha\int_{A_i\setminus A_{i-1}}s\,\dd\mu=\alpha\int_As\,\dd\mu
	\end{equation}
	per ciascuna $s\leq f$ in $A$.
	Per $\alpha\to 1^-$, si ottiene dunque
	\begin{equation}
		\lim_{n\to+\infty}\int_Af_n\dd\mu\geq\int_As\,\dd\mu,
	\end{equation}
	ma allora se è maggiore di tutti gli integrali per ogni $s\in\mathcal S_f$ è anche maggiore dell'estremo superiore, e per la definizione dell'integrale otteniamo quindi
	\begin{equation}
		\lim_{n\to+\infty}\int_Af_n\dd\mu\geq\sup_{s\in\mathcal S_f}\int_As\,\dd\mu=\int_Af\,\dd\mu.
	\end{equation}
	Abbiamo trovato che il limite dell'integrale della successione prima non è maggiore dell'integrale del limite, poi che non è minore: allora
	\begin{equation}
		\lim_{n\to+\infty}\int_af_n\dd\mu=\int_Af\,\dd\mu.\qedhere
	\end{equation}
\end{proof}
\begin{corollario} \label{cor:serie-integrali}
	Sia $\{f_n\}_{n=1}^{+\infty}$ una successione di funzioni $f_n\colon A\to[0,+\infty]$ con $A$ misurabile: allora
	\begin{equation}
		\int_A\ser{n}f_n\dd\mu=\ser{n}\int_Af_n\dd\mu.
		\label{eq:serie-integrali}
	\end{equation}
\end{corollario}
\begin{proof}
	Poich\'e ogni $f_n$ non è negativa, la successione delle somme parziali $s_k=\sum_{n=1}^kf_n$ è monotona crescente, e ammette anche il limite per $n\to+\infty$ (eventualmente infinito).
	Per il teorema della convergenza monotona allora
	\begin{equation}
		\int_a\ser{n}f_n\dd\mu=\int_A\lim_{k\to+\infty}\sum_{n=1}^kf_n\dd\mu=\lim_{k\to+\infty}\int_A\sum_{n=1}^kf_n\dd\mu=\lim_{k\to+\infty}\sum_{n=1}^k\int_Af_n\dd\mu=\ser{n}\int_Af_n\dd\mu.\qedhere
	\end{equation}
\end{proof}
\begin{corollario}
	Sia $f\colon\R^n\to[0,+\infty]$ misurabile, e $\{A_n\}_{n=1}^{+\infty}$ una successione di insiemi misurabili.
	Detto $A\defeq\bigcup_{n=1}^{+\infty}$, risulta
	\begin{enumerate}
		\item se $A_i\cap A_j=\emptyset$ per $i\neq j$, $\int_Af\,\dd\mu=\ser{i}\int_{A_i}f\,\dd\mu$;
		\item se $A_n\subseteq A_{n+1}$ per ogni $n\in\N$, $\int_Af\,\dd\mu=\lim_{n\to+\infty}\int_{A_n}f\,\dd\mu$;
		\item se $A_n\supseteq A_{n+1}$ per ogni $n\in\N$, detto $B=\bigcap_{i=1}^{+\infty}$, se $\int_{A_1}f\,\dd\mu<+\infty$ allora $\int_Bf\,\dd\mu=\lim_{j\to+infty}\int_{A_j}f\,\dd\mu$.
	\end{enumerate}
\end{corollario}
\begin{proof}
	\begin{enumerate}
		\item Poich\'e gli $A_i$ sono mutualmente disgiunti, definiamo una successione $\{f_n\}_{n=1}^{+\infty}$ come $f_n=f\chi_{A_n}$.
			Per il corollario precedente allora
			\begin{equation}
				\int_Af\,\dd\mu=\int_A\ser{n}f_n\dd\mu=\ser{n}\int_Af_n\dd\mu=\ser{n}\int_{A_n}f\,\dd\mu.
			\end{equation}
		\item Definiamo ancora $f_n=f\chi_{A_n}$: poich\'e $A_n\subseteq A_{n+1}$, risulta $f_n\leq f_{n+1}$ in $A$ dunque la $\{f_n\}_{n=1}^{+\infty}$ è una successione monotona crescente.
			Per il teorema della convergenza monotona allora
			\begin{equation}
				\int_Af\,\dd\mu=\lim_{n\to+\infty}\int_Af_n\dd\mu=\lim_{n\to+\infty}\int_{A_n}f\,\dd\mu.
			\end{equation}
		\item ?	\qedhere
	\end{enumerate}
\end{proof}

Completiamo dunque la dimostrazione della linearità dell'integrale: ci manca da dimostrare che l'integrale della somma è la somma degli integrali (il resto è dimostrato nel punto 3 della \ref{pr:integrale-lebesgue}).
\begin{proprieta} \label{pr:linearita-integrale-lebesgue}
	Siano $f,g\colon A\to[0,+\infty]$ misurabili con $A\in\mis(\R^n)$.
	Vale l'equazione
	\begin{equation}
		\int_A(f+g)\dd\mu=\int_Af\,\dd\mu+\int_Ag\,\dd\mu.
		\label{eq:linearita-integrale-lebesgue}
	\end{equation}
\end{proprieta}
\begin{proof}
	Per la misurabilità delle due funzioni possiamo sempre trovare due successioni di funzioni semplici, $s_n$ e $t_n$, monotone crescenti e convergenti a $f$ e $g$ rispettivamente.
	Anche il limite della loro somma esiste, e chiaramente vale $\lim_{n\to+\infty}(s_n+t_n)=f+g$.
	Allora
	\begin{equation}
		\int_A(f+g)\dd\mu=\lim_{n\to+\infty}\int_A(s_n+t_n)\dd\mu=\lim_{n\to+\infty}\bigg(\int_As_n\dd\mu+\int_At_n\dd\mu\bigg)
	\end{equation}
	per il teorema \ref{t:integrale-funzioni-semplici-linearita}, dunque per il teorema della convergenza monotona risulta
	\begin{equation}
		\lim_{n\to+\infty}\bigg(\int_As_n\dd\mu+\int_At_n\dd\mu\bigg)=\int_Af\,\dd\mu+\int_Ag\,\dd\mu.\qedhere
	\end{equation}
\end{proof}

\begin{lemma} \label{l:fatou}
	Sia $\{f_n\}_{n=1}^{+\infty}$ una successione di funzioni $f_n\colon A\to[0,+\infty]$ con $A\in\mis(\R^n)$.
	Vale la relazione
	\begin{equation}
		\int_A\liminf_{n\to+\infty}f_n\dd\mu\leq\liminf_{n\to+\infty}\int_Af_n\dd\mu.
		\label{eq:fatou}
	\end{equation}
\end{lemma}
\begin{proof}
	Chiamiamo $g_n\defeq\inf_{k\geq n}f_k$ per $n\in\N$: essa è chiaramente una successione crescente, perch\'e restringendo ad ogni $n$ l'insieme delle $f_k$ da cui prendere l'estremo inferiore, esso non può certamente diminuire.
	Per come è definita, inoltre, $\lim_{n\to+\infty}g_n=\liminf_{n\to+\infty}f_n$.
	Per la monotonia dell'integrale, dato che $g_n\leq f_k$ in $A$ per ogni $k\geq n$, risulta
	\begin{equation}
		\int_Ag_n\dd\mu\leq\int_Af_k\dd\mu
	\end{equation}
	sempre per ogni $k\geq n$.
	Prendendo l'estremo inferiore rispetto a $k$ dei due membri (il primo membro non dipende da $k$ quindi rimane cos\'i com'è), e passando poi al limite per $n\to+\infty$, abbiamo
	\begin{equation}
		\lim_{n\to+\infty}\int_Ag_n\dd\mu\leq\lim_{n\to+\infty}\inf_{k\geq n}\int_Af_k\dd\mu=\liminf_{k\to+\infty}\int_Af_k\dd\mu.
	\end{equation}
	Applicando infine il teorema della convergenza monotona al primo membro troviamo
	\begin{equation}
		\int_A\lim_{n\to+\infty}g_n\dd\mu=\int_A\liminf_{n\to+\infty}f_n\dd\mu\leq\liminf_{n\to+\infty}\int_Af_n\dd\mu.\qedhere
	\end{equation}
\end{proof}
Con questo lemma abbiamo tolto l'ipotesi di monotonia della successione, ottenendo però una disuguaglianza e non più un'uguaglianza.
Notiamo inoltre che nel lemma di Fatou non è nemmeno richiesta la convergenza puntuale della successione.
La monotonia è un'ipotesi essenziale in questi casi: guardiamo ad esempio alla successione di $f_n\colon\R\to[0,+\infty)$ definite come $f_n=\frac1{k}\chi_{[0,k]}$.
Il limite puntuale (ma anche uniforme) è certamente la funzione nulla, ma la convergenza non è monotona, e infatti abbiamo
\begin{gather*}
	\lim_{n\to+\infty}\int_{\R}f_n(x)\,\dd x=\lim_{n\to+\infty}1\\
	\int_{\R}\lim_{n\to+\infty}f_n(x)\,\dd x=\int_A0\,\dd x=0.
\end{gather*}

\begin{osservazione}
	Poich\'e, per $f\colon A\to[0,+\infty]$ misurabile e $A,Z\in\mis(\R^n)$ con $\mu(Z)=0$, risulta
	\begin{equation*}
		\int_{A\cup Z}f\,\dd\mu=\int_Af\,\dd\mu=\int_{A\setminus Z}f\,\dd\mu,
	\end{equation*}
nei risultati visti finora possiamo senza problemi sostituire alle condizioni che valgono in tutto l'insieme $A$ il meno restrittivo ``quasi ovunque in $A$''.
	Ad esempio nel teorema di Beppo Levi la convergenza può essere monotona anche solo quasi ovunque, ossia se l'insieme $Z_n=\{\vec x\in A\colon f_n(\vec x)>f_{n+1}(\vec x)\}$ ha misura nulla, ma il risultato sarà lo stesso.
	Si noti che $Z_n$ non deve necessariamente essere uguale al suo successivo $Z_{n+1}$ affinch\'e questo valga: tutti questi $Z_i$ sono infatti di misura nulla, e in quanto numerabili anche la loro unione $\bigcup_{i=1}^{+\infty}Z_i$ lo è.
\end{osservazione}
Concludiamo infine la trattazione dei limiti con gli integrali con il seguente risultato.
\begin{teorema}[della convergenza dominata, di Lebesgue] \label{t:convergenza-dominata}
	Sia $\{f_n\}_{n\in\N}$ una successione di funzioni sommabili su $A\subseteq\R^n$.
	Se esiste quasi ovunque in $A$ il limite puntuale $f$ della successione, ed esiste una funzione $g\colon A\to\R$ sommabile tale che $\abs{f_n(\vec x)}\leq g(\vec x)$ $\forall n\in\N$ e quasi ovunque in $A$, allora
	\begin{equation}
		\lim_{n\to+\infty}\int_A\abs{f_n-f}\dd\mu=0
		\label{eq:convergenza-dominata}
	\end{equation}
\end{teorema}
\begin{proof}
	Poich\'e $g$ maggiora ogni termine della successione indipendentemente da $n\in\N$, per il teorema di permamenza del segno avremo anche $f\leq g$, quindi $\abs{f_n-f}\leq\abs{f_n}+\abs{f}\leq 2g$ quasi ovunque in $A$.
	Se prendiamo la successione $2g-\abs{f_n-f}$, applicando ad essa il lemma di Fatou troviamo
	\begin{equation}
		\int_A\liminf_{n\to+\infty}(2g-\abs{f_n-f})\dd\mu\leq\liminf_{n\to+\infty}\int_A(2g-\abs{f_n-f})\dd\mu,
		\label{eq:dim-lebesgue1}
	\end{equation}
	ma poich\'e $f_n\to f$ quasi ovunque, $\abs{f_n-f}\to 0$ cioè anche $\liminf_{n\to+\infty}\abs{f_n-f}=0$.
	Allora $\liminf_{n\to+\infty}(2g-\abs{f_n-f})=2g-\liminf_{n\to+\infty}\abs{f_n-f}=2g$, dunque la \eqref{eq:dim-lebesgue1} diventa
	\begin{equation}
		\int_A2g\,\dd\mu\leq\liminf_{n\to+\infty}\int_A(2g-\abs{f_n-f})\dd\mu=\int_A2g\,\dd\mu-\limsup_{n\to+\infty}\int_A\abs{f_n-f}\dd\mu
	\end{equation}
	ma allora $\limsup_{n\to+\infty}\int_A\abs{f_n-f}\dd\mu\leq 0$.
	Poich\'e l'integranda è positiva o nulla, chiaramente tale limite non potrà essere negativo, ma allora è nullo, perciò
	\begin{equation}
		0\leq\lim_{n\to+\infty}\int_A\abs{f_n-f}\dd\mu\leq\limsup_{n\to+\infty}\int_A\abs{f_n-f}\dd\mu=0.\qedhere
	\end{equation}
\end{proof}
Poich\'e stiamo considerando il limite della successione, come al solito ci interessa sapere soltanto il suo comportamento per $n$ che tende all'infinito, quindi non è strettamente necessario che le $f_n$ siano sommabili \emph{per ogni} $n$: basta ai fini del teorema che lo siano almeno definitivamente.
È importante però che la maggiorante sommabile $g$ sia indipendente da $n$.
\begin{osservazione} \label{o:convergenza-dominata}
	Poich\'e per le note proprietà degli integrali
	\begin{equation*}
		\abs{\int_Af_n\dd\mu-\int_Af\,\dd\mu}=\abs{\int_A(f_n-f)\dd\mu}\leq\int_A\abs{f_n-f}\dd\mu,
	\end{equation*}
	da questo teorema si ha anche che
	\begin{equation}
		\lim_{n\to+\infty}\abs{\int_Af_n\dd\mu-\int_Af\,\dd\mu}=0
	\end{equation}
	cioè possiamo scambiare limite e integrale.
\end{osservazione}

