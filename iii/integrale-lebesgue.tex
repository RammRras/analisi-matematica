\chapter{Misura e integrale di Lebesgue}
Avevamo visto nel capitolo \ref{ch:integrale-riemann} la teoria dell'integrazione sviluppata da Riemann.
Essa è utile nel calcolo integrale di molte funzioni comuni, ma risulta ancora limitata: la classe delle funzioni integrabili secondo Riemann è ampia, ma non comprende ad esempio i limiti delle successioni, difficili da analizzare in tale contesto.
L'integrale di Lebesgue si comporta meglio su questo tipo di funzioni, permettendo condizioni meno restrittive, e per questo risulta molto più adatta in questo campo.
Le funzioni integrabili secondo Lebesgue comprendono anche casi una volta considerati ``patologici'' come la funzione di Dirichlet: essa ha un integrale di Lebesgue, che è anche piuttosto semplice da calcolare, ma non di Riemann.

La costruzione dell'integrale di Lebesgue si fonda su una nuova teoria della misura, che permette di definire il concetto di insieme misurabile e funzione misurabile: si vedrà che trovare insiemi (e funzioni) non misurabili è molto difficile, ma comunque sarà essenziale distinguere tra le due classi.

\section{Misura esterna}
\label{sec:misura-esterna}
Siano $\vec a=(a_1,a_2,\dots,a_n)$ e $\vec b=(b_1,b_2,\dots,b_n)$ due punti in $\R^n$: l'iperrettangolo individuato dai due punti è il prodotto cartesiano dei vari intervalli chiusi $I=[a_1,b_1]\times[a_2,b_2]\times\dots\times[a_n,b_n]$.
Esso è un insieme compatto, e indicheremo il suo volume con $\vol{I}$, che vale
\begin{equation*}
	\vol{I}=\prod_{i=1}^n(b_i-a_i).
\end{equation*}
\begin{definizione} \label{d:ricoprimento-lebesgue}
	Sia $A\subseteq\R^n$.
	Un insieme numerabile di intervalli compatti $\{I_k\}_{k\in K}$, con $K\subseteq\N$, si dice \emph{ricoprimento di Lebesgue} di $A$ se $A\subseteq\bigcup_{k\in K}I_k$.
\end{definizione}
Esiste sempre un ricoprimento di Lebesgue per ogni insieme: se prendiamo $I_{\vec m}=[m_1,m_1+1]\times[m_2,m_2+1]\times\dots\times[m_n,m_n+1]$ ossia l'ipercubo con un vertice in $\vec m\in\R^n$ e spigolo unitario, l'unione (numerabile) $\bigcup_{\vec m\in\Z^n}I_{\vec m}$ ricopre qualsiasi insieme di $\R^n$.
Cominciamo a dare una prima approssimazione di quella che sarà la misura di un insieme.
\begin{definizione} \label{d:misura-esterna}
	Si definisce \emph{misura esterna} di un insieme $A\subseteq\R^n$ la quantità
	\begin{equation*}
		\mu^*(A)=\inf\bigg\{\sum_{k\in K}\vol{I_k}\colon\{I_k\}_{k\in K}\text{ è un ricoprimento di Lebesgue di }A\bigg\},
	\end{equation*}
	dove $K$ è un insieme numerabile.
\end{definizione}
Chiaramente $\mu^*$ è un numero reale, ma può anche essere infinito, come ad esempio la misura esterna di $\R$.
Dunque possiamo dire che $\mu^*$ è una funzione che associa ad un insieme di $\R^n$, quindi un elemendo dell'insieme delle parti un numero non negativo anche infinito, cioè $\mu^*\colon\mathcal P\to[0,+\infty]$.

La misura esterna di un iperrettangolo di volume $\vol{I}$ è chiaramente $\vol{I}$ stesso, che è il più piccolo ricoprimento possibile.
Infatti, per ogni iperrettangolo $I$ (non vuoto) ne esistono $\forall\epsilon>0$ inoltre altri due $H$ e $J$, con $H\subset\interior{I}\subset I\subset\interior{J}$ tali che $\vol{J}-\epsilon<\vol{I}<\vol{H}+\epsilon$.
Dato un ricoprimento di Lebesgue $\{I_k\}_{k\in K}$ di $I$, prendiamo $\{J_k\}_{k\in K}$ tale che, per ogni $k\in K$, $I_k\subset\interior{J_k}$ e che $\vol{J_k}-\frac{\epsilon}{2^k}<\vol{I_k}$.
Otteniamo che $I\subset\bigcup_{k\in K} I_k$, e allora anche $I\subset\bigcup_{k\in K}\interior{J_k}$.
Però $I$ è compatto, perciò esiste un $N\in\N$ per cui $I\subset\bigcup_{k=1}^NI_k$.
Allora
\begin{equation}
	\vol{I}\leq\sum_{i=1}^N\bigg(\vol{I_k}+\frac{\epsilon}{2^k}\bigg)=\sum_{i=1}^N(\vol{I_k}+\epsilon)\qqq\vol{I}\leq\epsilon+\inf\sum_{i=1}^N\vol{I_k}=\epsilon+\mu^*(I).
\end{equation}

\begin{proprieta} \label{pr:misura-esterna}
	La misura esterna soddisfa la seguenti proprietà: dati $A,B,A_k\in\R^n$ per $k\in K\subseteq\N$,
	\begin{enumerate}
		\item $\mu^*(\emptyset)=0$;
		\item $\mu^*(A)\in[0,+\infty]$ per qualsiasi $A$;
		\item è monotona, cioè se $A\subseteq B$ allora $\mu^*(A)\leq\mu^*(B)$;
		\item è subadditiva (numerabile), cioè $\mu^*\big(\bigcup_{k\in K}A_k\big)\leq\sum_{k\in K}\mu^*(A_k)$.
	\end{enumerate}
\end{proprieta}
\begin{proof}
	\begin{enumerate}
		\item Per ogni $\epsilon>0$ la famiglia $\{I\}=\{[0,\epsilon]^n\}$ (è composta da un solo iperrettangolo) è un ricoprimento di Lebesgue per l'insieme vuoto di $\R^n$.
			Poich\'e il suo volume è $\epsilon^n$, l'estremo inferiore tra tutti gli $\epsilon$ positivi dà $\mu^*(\emptyset)=0$.
		\item Per qualsiasi insieme $\{I_k\}_{k\in K}$ di iperrettangoli ($K$ misurabile), risulta ovviamente $0\leq\vol{I_k}<+\infty$, di conseguenza la somma di tutti i volumi è
			\begin{equation}
				0\leq\sum_{k\in K}\vol{I_k}\leq+\infty
			\end{equation}
			quindi anche prendendo l'estremo inferiore tra tutti i ricoprimenti di un qualsiasi $A$ si può avere $0\leq\mu^*(A)\leq+\infty$.
		\item Se $A\subseteq B$ allora ogni ricoprimento di Lebesgue di $B$ lo è anche di $A$, quindi i due insiemi dei ricoprimenti $\{I^A\}$ di $A$ e $\{I^B\}$ di $B$ soddisfano sempre $\{I^A\}\subseteq\{I^B\}$ quindi l'estremo inferiore del primo (cioè $\mu^*(A)$) non può essere maggiore dell'estremo inferiore del secondo.
		\item Se per qualche $k\in K$ si ha $\mu^*(A_k)=+\infty$ la proprietà è immediata, dunque sia $\mu^*(A_k)<+\infty$.
			Dalla definizione della misura, $\forall\epsilon>0$ esiste un ricoprimento di Lebesgue $\{I^k_j\}_{j\in J}$ di $A_k$ per cui
			\begin{equation}
				\sum_{j\in J}\vol{I^k_j}<\mu^*(A_k)+\frac{\epsilon}{2^k}.
			\end{equation}
			Unendo tutti i ricoprimenti per ogni $k\in K$ si ottiene che l'insieme $\{I^k_j\}_{j\in J,k\in K}$ è un ricoprimento di $\bigcup_{k\in K}A_k$, dunque
			\begin{equation}
				\mu^*\bigg(\bigcup_{k\in K}A_k\bigg)\leq\sum_{\substack{k\in K\\j\in J}}\vol{I^k_j}=\sum_{k\in K}\sum_{j\in J}\vol{I^k_j}\leq\sum_{k\in K}\bigg[\mu^*(A_k)+\frac{\epsilon}{2^k}\bigg]=\epsilon+\sum_{k\in K}\mu^*(A_k),
			\end{equation}
			potendo scegliere l'ordine della somma (prima su $j$ poi su $k$ o viceversa) poich\'e tutti gli addendi sono positivi.
			Per l'arbitrarietà di $\epsilon$, l'estremo inferiore si ottiene per $\epsilon=0$ da cui la tesi.
	\end{enumerate}
\end{proof}
Un insieme si dice di \emph{misura nulla} se la sua misura esterna è zero.
Eccone alcuni esempi.
\begin{itemize}
	\item Se $I$ è dato dal prodotto di vari intervalli $[a_i,b_i]$ con $i\in\{1,\dots,n\}$, e per almeno un $j$ si ha $a_j=b_j$, allora
		\begin{equation}
			\mu^*(I)=\prod_{i=1}^n(b_i-a_i)=(a_j-a_j)\prod_{\substack{i=1\\i\neq j}}^n(b_i-a_i)=0.
		\end{equation}
	\item Se $A\in\R^n$ è composto di un solo punto, cioè $A=\{\vec a\}$, può essere scritto come $A=[a_1,a_1]\times\dots\times[a_n,a_n]$ quindi per il punto precedente $\mu^*(\{\vec a\})=0$.
	\item Un insieme $B$ finito o numerabile è l'unione numerabile di tanti punti, cioè $B=\bigcup_{j\in J}\{\vec b_j\}$ con $J\in\N$, quindi per la subadditività della misura esterna e per il punto precedente risulta
		\begin{equation}
			\mu^*(B)=\mu^*\bigg(\bigcup_{j\in J}\{\vec b_j\}\bigg)\leq\sum_{j\in J}\mu^*(\{\vec b_j\})=0.
		\end{equation}
	\item L'insieme $\Q$ dei razionali è numerabile, quindi $\mu^*(\Q)=0$ cos\'i come $\mu^*(\Q^n)=0$, pur essendo densi in $\R$ e $\R^n$.
	\item Ogni sottoinsieme di un insieme di misura nulla è a sua volta di misura nulla, per la monotonia della misura.
	\item Il bordo $\partial I$ di un iperrettangolo di $\R^n$ può essere scritto come l'unione delle sue $2n$ facce $F_i$, che sono a loro volta iperrettangoli degeneri (come nel primo di questi esempi), dunque
		\begin{equation}
			\mu^*(\partial I)=\mu^*\bigg(\bigcup_{i=1}^{2n} F_i\bigg)\leq\sum_{i=1}^{2n}\mu^*(F_i)=0.
		\end{equation}
\end{itemize}

Esistono anche insiemi non numerabili ma di misura nulla, come l'insieme di Cantor, definito come limite per induzione di
\begin{equation}
	\begin{aligned}
		C_0&=[0,1]\\
		C_1&=\Big[0,\frac13\Big]\cup\Big[\frac23,1\Big]\\
		C_2&=\Big[0,\frac19\Big]\cup\Big[\frac29,\frac13\Big]\cup\Big[\frac23,\frac79\Big]\cup\Big[\frac89,1\Big]\\
		\dots
	\end{aligned}
\end{equation}
sottraendo ad ogni passo un terzo dell'insieme precedente.
Al generico $n$ si hanno dunque $2^n$ intervalli chiusi, disgiunti ciascuno di diametro $3^{-n}$ e inclusi nell'insieme $C_{n-1}$.
L'insieme di Cantor è l'insieme che si ottiene con
\begin{equation}
	C=\bigcap_{n=1}^{+\infty}C_n.
\end{equation}
Non dimostriamo che non è numerabile; si può verificare che ogni punto di $C$ è un punto di accumulazione.
Si può però vedere intuitivamente che la misura di $C_n$ è $2^n/3^n$, quindi
\begin{equation}
	\mu^*(C)\leq\mu^*(C_n)=\frac{2^n}{3^n}\to 0
\end{equation}
cioè l'insieme è di misura nulla.

Dovendo sfruttare questa teoria della misura per l'integrazione, è di fondamentale importanza (come già facevamo per l'integrale di Riemann) che l'integrale si possa scomporre nella somma di integrali su vari sottoinsiemi.
Per avere questa proprietà per gli integrali bisogna chiaramente avere una proprietà \emph{additiva} per la misura degli insiemi, ossia che la misura dell'unione (numerabile) di due insiemi disgiunti corrisponda alla somma delle misure di ciascun insieme.
In breve, per $A,B\in\R^n$ e $A\cap B=\emptyset$, vogliamo che $\mu^*(A\cup B)=\mu^*(A)+\mu^*(B)$.
Per quello che abbiamo visto finora, la misura non gode di tale proprietà, ma di una più debole, la subadditività numerabile: in pratica sappiamo solo che $\mu^*(A\cup B)$ è minore o uguale della somma delle due misure, che quindi può essere più grande.
Esistono infatti insiemi disgiunti per cui la disuguaglianza è stretta, come nel celebre paradosso di Banach-Tarski, secondo il quale data la sfera unitaria $S$ esistono due insiemi disgiunti $A_1,A_2$ per i quali
\begin{equation}
	S=A_1\cup A_2\qeq \mu^*(A_1)=\mu^*(A_2)=\mu^*(S) 
\end{equation}
e se valesse l'additività numerabile per la misura esterna si avrebbe $\mu^*(S)=\mu^*(A_1)+\mu^*(A_2)=2\mu^*(S)$.

Per risolvere queste contraddizioni dobbiamo quindi rinunciare a poter misurare (con le proprietà volute) ogni sottoinsieme dello spazio, ossia dobbiamo accettare che esistono insiemi \emph{che non si possono misurare}.

\section{Misura di Lebesgue}
\label{sec:misura-lebesgue}
Dobbiamo trovare dunque un criterio che ci permetta di capire quando un insieme si può misurare.
La seguente costruzione della misura segue le idee di Carath\'eodory.
\begin{definizione} \label{d:lebesgue-misurabile}
	Un insieme $A\in\R^n$ si dice \emph{misurabile secondo Lebesgue} se vale la relazione
	\begin{equation}
		\mu^*(E)=\mu^*(A\cap E)+\mu^*(\compl A\cap E),
		\label{eq:lebesgue-misurabile}
	\end{equation}
	per ogni insieme $E\in\R^n$.
\end{definizione}
Indicheremo la classe degli insiemi di $\R^n$ misurabili secondo Lebesgue con la scrittura $\mis(\R^n)$.
\begin{definizione} \label{d:misura-lebesgue}
	Si definisce \emph{misura di Lebesgue} la restrizione della misura esterna $\mu^*$ all'insieme $\mis(\R^n)$.
\end{definizione}
La misura di Lebesgue, che indicheremo con $\mu$, coincide (quando è definita) con la misura esterna definita nella \ref{d:misura-esterna}, quindi la definizione rimane la stessa, e ovviamente ne eredità le proprietà già dimostrate.
Avendo ristretto però l'insieme di definizione ai soli insiemi che rispettano la \eqref{eq:lebesgue-misurabile}, possiamo aggiungerne altre molto importanti.
Tra queste, ovviamente, figurerà la proprietà additiva.
D'ora in poi con \emph{misurabile} intenderemo sempre misurabile secondo Lebesgue, e con \emph{misura} la misura di Lebesgue, dove non si presenteranno ambiguità.
\begin{proprieta} \label{pr:complementare-misurabile}
	Un insieme $A\in\R^n$ è misurabile se e solo se lo è il suo complementare.
\end{proprieta}
\begin{proof}
	Usando direttamente la \eqref{eq:lebesgue-misurabile} abbiamo che $\compl A$ è misurabile se
	\begin{equation}
		\mu^*(B)=\mu^*(B\cap\compl A)+\mu^*\big(B\cap\compl{(\compl A)}\big),
	\end{equation}
	per ogni $B\in\R^n$.
Poich\'e $\compl{(\compl A)}=A$, si ha esattamente la stessa equazione per $A$ anzich\'e per $\compl A$.
\end{proof}
Una nota per le seguenti dimostrazioni: sfrutteremo spesso la relazione \eqref{eq:lebesgue-misurabile} per dimostrare che un dato insieme $A$ è misurabile.
Poich\'e si ha per qualsiasi $E\in\R^n$ che $E=(E\cap A)\cup(E\cap\compl A)$, per la subadditività della misura esterna si ha sempre $\mu^*(E)\leq\mu^*(E\cap A)+\mu^*(E\cap\compl A)$, indipendentemente che $A$ sia misurabile o meno.
Quindi per mostrare la misurabilità di $A$ ci basterà dimostrare la disuguaglianza opposta, che è più significativa, cioè che
\begin{equation}
	\mu^*(E)\geq\mu^*(E\cap A)+\mu^*(E\cap\compl A).
\end{equation}
\begin{proprieta} \label{pr:misura-nulla}
	Ogni insieme $Z\in\R^n$ tale che $\mu^*(Z)=0$ è misurabile, e la sua misura di Lebesgue è nulla.
\end{proprieta}
\begin{proof}
	Poich\'e $E\cap\compl Z\subseteq E$, per la monotonia della misura esterna abbiamo
	\begin{equation}
		\mu^*(E)\geq\mu^*(E\cap\compl Z).
	\end{equation}
	Allo stesso modo, $E\cap Z\subseteq Z$, quindi $\mu^*(E\cap Z)\leq\mu^*(Z)$, ma $\mu^*(Z)=0$ per ipotesi, dunque anche $\mu^*(E\cap Z)=0$.
	Allora aggiungiamo $0=\mu^*(E\cap Z)$ alla disequazione precedente, che ovviamente rimane vera: risulta quindi
	\begin{equation}
		\mu^*(E)\geq\mu^*(E\cap Z)+\mu^*(E\cap\compl Z)
	\end{equation}
	e ciò prova che $Z$ è misurabile.
	Segue immediatamente che $\mu(Z)=\mu^*(Z)=0$.
\end{proof}
Non dimostriamo il seguente risultato, anch'esso decisamente intuitivo.
\begin{proprieta} \label{pr:misura-iperrettangolo}
	Ogni iperrettangolo, prodotto di intervalli compatti, è misurabile, e la sua misura coincide con il suo volume.
\end{proprieta}
Passiamo ora a dimostrare come si comporta la misura di Lebesgue rispetto alle operazioni insiemistiche, cioè il complementare di un insieme, la sottrazione e le unioni e intersezioni (anche infinite, purch\'e numerabili).
\begin{proprieta} \label{pr:misura-unione-intersezione}
	Siano $A,B\in\mis(\R^n)$:
	\begin{enumerate}
		\item $A\cup B$, $A\cap B$ e $A\setminus B$ sono numerabili;
		\item se $A\cap B=\emptyset$, allora $\mu(A\cup B)=\mu(A)+\mu(B)$;
		\item se $B\subseteq A$ e $\mu(B)<+\infty$, allora $\mu(A\setminus B)=\mu(A)-\mu(B)$.
	\end{enumerate}
\end{proprieta}
\begin{proof}
	\begin{enumerate}
		\item Dimostriamo che l'unione è misurabile: preso un qualunque $E\in\R^n$, applicando la \eqref{eq:lebesgue-misurabile} ad $A$ abbiamo
			\begin{equation}
				\mu^*(E)=\mu^*(E\cap A)+\mu^*(E\cap\compl A).
			\end{equation}
			Anche $B$ è misurabile, e certamente $E\cap\compl A$ è un insieme di $\R^n$, quindi applicando ancora la definizione abbiamo
			\begin{equation}
				\mu^(E\cap\compl A)=\mu^*(E\compl A\cap B)+\mu^*(E\compl A\cap\compl B),
			\end{equation}
			e sostituendo nella prima si ha
			\begin{equation}
				\mu^*(E)=\mu^*(E\cap A)+\mu^*(E\cap\compl A\cap B)+\mu^*(E\compl A\cap\compl B).
			\end{equation}
			Ora, per la proprietà distributiva dell'unione rispetto all'intersezione abbiamo che
			\begin{equation}
				(E\cap A)\cup(E\cap\compl A\cap B)=E\cap\big[A\cup(\compl A\cap B)\big]=E\cap\big[(A\cup\compl A)\cap(A\cup B)\big]=E\cap(A\cup B),
			\end{equation}
			dunque per la subadditività della misura esterna $\mu^*(E\cap A)+\mu^*(E\cap\compl A\cap B)\leq\mu^*\big(E\cap(A\cup B)\big)$.
			Allo stesso tempo, $\compl A\cap\compl B=\compl{(A\cup B)}$, quindi
			\begin{equation}
				\mu^(E)\geq\mu^*\big(E\cap(A\cup B)\big)+\mu^*\big(E\cap\compl{(A\cup B)}\big),
			\end{equation}
			e ciò prova che $A\cup B$ è misurabile.
			
			Dalla proprietà \ref{pr:complementare-misurabile} sappiamo che $\compl A$ e $\compl B$ sono misurabili, e per quanto appena visto lo è anche $\compl A\cup\compl B$.
			Ma $\compl A\cup\compl B=\compl{(A\cap B)}$ quindi anche $A\cap B$ sempre per la proprietà \ref{pr:complementare-misurabile} è misurabile.

			Per $A\setminus B$, basta ricordare che esso è uguale $A\cap\compl B$, quindi anch'esso è misurabile.
		\item Poich\'e $A,B\in\mis(\R^n)$, $A\cup B$ è misurabile dunque $\mu(A\cup B)=\mu^*(A\cup B)$.
			Usiamo questo insieme (che ovviamente è sottoinsieme di $\R^n$) nella \eqref{eq:lebesgue-misurabile} con $A$, anch'esso misurabile, per cui
			\begin{equation}
				\begin{split}
					\mu(A\cup B)=\mu^*(A\cup B)&=\mu^*\big((A\cup B)\cap A\big)+\mu^*\big((A\cup B)\cap\compl A\big)=\\
					&=\mu^*\big((A\cap A)\cup(A\cap B)\big)+\mu^*\big((A\cup B)\setminus A\big),
				\end{split}
			\end{equation}
			e dato che $A\cap A=A$, $A\cap B=\emptyset$ e $(A\cup B)\setminus A=B$ troviamo che
			\begin{equation}
				\mu(A\cup B)=\mu^*(A\cup B)=\mu^*(A)+\mu^*(B)=\mu(A)+\mu(B).
			\end{equation}
		\item Poich\'e $B\subseteq A$, vale ovviamente $A=(A\setminus B)\cup B$.
			Gli insiemi $A\setminus B$ e $B$ hanno intersezione vuota, perciò per il punto precedente
			\begin{equation}
				\mu(A)=\mu(A\setminus B)+\mu(B)
			\end{equation}
			da cui la tesi.
	\end{enumerate}
\end{proof}
Per induzione, segue immediatamente da questo teorema che l'unione e intersezione \emph{finite} di insiemi sono ancora insiemi numerabili, e che la misura è additiva se tutti gli insiemi sono disgiunti.
Procediamo finalmente a dimostrare la proprietà di additività numerabile che abbiamo annunciato all'inizio di questa sezione.
\begin{proprieta} \label{pr:additivita-numerabile-lebesgue}
	Sia $\{A_n\}_{n\in\N}$ una famiglia di insiemi misurabili di $\R^n$.
	Allora l'unione e l'intersezione (numerabili) $\bigcup_{n=1}^{+\infty}+A_n$ e $\bigcap_{n=1}^{+\infty}A_n$ sono insiemi numerabili.
	Se inoltre $A_i\cap A_j=\emptyset$ per ogni $i\neq j$, allora
	\begin{equation}
		\mu\bigg(\bigcup_{n=1}^{+\infty}A_n\bigg)=\sum_{n=1}^{+\infty}\mu(A_n).
		\label{eq:additivita-numerabile-lebesgue}
	\end{equation}
\end{proprieta}
\begin{proof}
	Notiamo innanzitutto che possiamo considerare gli insiemi $A_n$ mutualmente disgiunti, senza perdere generalità: se già non lo fossero, ci basterebbe prendere la famiglia $\{B_n\}_{n\in\N}$ dove
	\begin{equation}
		B_1=A_1,\ B_2=A_2\setminus A_1, B_3=A_3\setminus(A_2\cup A_1),\dots,B_k=A_m\setminus(A_1\cup\dots\cup A_{m-1}),
	\end{equation}
	che sono per costruzione mutualmente disgiunti, e tali che
	\begin{equation}
		\bigcup_{n=1}^{+\infty}B_n=\bigcup_{n=1}^{+\infty}A_n
	\end{equation}
	quindi si perviene agli stessi risultati.
	Consideriamo dunque $A_j\cap A_i=\emptyset$ per ogni $i\neq j$.

	Definiamo $F_k\defeq\bigcup_{n=1}^kA_n$, per $k\in\N$, che è misurabile per quanto visto nella proprietà \ref{pr:misura-unione-intersezione}.
	Per la \eqref{eq:lebesgue-misurabile} applicata ad $A_k$, che è misurabile per ipotesi, abbiamo $\forall k\in\N$
	\begin{equation}
		\begin{split}
			\mu^*(E\cap F_k)&=\mu^*\big( (E\cap F_k)\cap A_k\big)+\mu^*\big( (E\cap F_k)\cap\compl{A_k}\big)=\\
			&=\mu^*\big((E\cap(F_k\cap A_k)\big)+\mu^*\big(E\cap (F_k\setminus A_k)\big)=\\
			&=\mu^*(E\cap A_k)+\mu^*(E\cap F_{k-1}).
		\end{split}
	\end{equation}
	per qualsiasi $E\subseteq\R^n$.
	Iterando il procedimento con $F_{k-1}$, anch'esso ovviamente misurabile, otteniamo che $\mu^*(E\cap F_{k-1})=\mu^*(E\cap A_{k-1})+\mu^*(E\cap F_{k-1})$.
	Continuiamo dunque in questo modo fino a esaurire gli $A_n$, arrivando a $\mu^*(E\cap F_2)=\mu^*(E\cap A_2)+\mu^*(E\cap F_1)$, ma $F_1=A_1$ quindi infine
	\begin{equation}
		\mu^*(E\cap F_k)=\sum_{n=1}^k\mu^*(E\cap A_n).
	\end{equation}
	Passiamo a calcolare $\mu^*(E\cap\compl{F_k})$.
	Definiamo $F\defeq\bigcup_{n=1}^{+\infty}A_n$.
	Poich\'e $F_k\subseteq F$, passando ai complementari risulta $\compl F\subseteq\compl{F_k}$: intersecandoli entrambi con un $E\in\R^n$ qualsiasi allora $E\cap\compl F\subseteq E\cap\compl{F_k}$,  da cui per la monotonia della misura esterna $\mu^*(E\cap\compl F)\leq\mu^*(E\cap\compl{F_k})$.
	Allora possiamo affermare che
	\begin{equation}
		\begin{split}
			\mu^*(E)&=\mu^*(E\cap F_k)+\mu^*(E\cap\compl{F_k})\geq\\
			&\geq\mu^*(E\cap F_k)+\mu^*(E\cap\compl F)=\\
			&=\sum_{n=1}^k\mu^*(E\cap A_n)+\mu^*(E\cap\compl F)
		\end{split}
	\end{equation}
	per ogni $E\subset\R^n$.
	Poiche vale $\forall k\in\N$, passando al limite per $k\to+\infty$ continua a valere la disuguaglianza, cioè
	\begin{equation}
		\mu^*(E)\geq\sum_{n=1}^{+\infty}\mu^*(E\cap A_n)+\mu^*(E\cap\compl F).
		\label{eq:dim-additivita-numerabile}
	\end{equation}
	Per la subadditività numerabile, inoltre, abbiamo che
	\begin{equation}
		E\cap F=E\cap\bigg(\bigcup_{n=1}^{+\infty}A_n\bigg)=\bigcup_{n=1}^{+\infty}(E\cap A_n)\quad\then\quad\mu^*(E\cap F)\leq\sum_{n=1}^{+\infty}\mu^*(E\cap A_n),
	\end{equation}
	dunque
	\begin{equation}
		\mu^*(E)\geq\mu^*(E\cap F)+\mu^*(E\cap\compl F)
	\end{equation}
	perciò $F$ è misurabile.
	Per la seconda parte della testi, prendiamo nella \eqref{eq:dim-additivita-numerabile} proprio l'insieme $F$ al posto di $E$, per cui $\mu(F)=\mu^*(F)$ essendo misurabile:
	\begin{equation}
		\mu(F)=\mu^*(F)=\sum_{n=1}^{+\infty}\mu^*(F\cap A_n)+\mu^*(F\cap\compl F).
	\end{equation}
	Poich\'e $F\cap A_n=A_n$ e $F\cap\compl F=\emptyset$, otteniamo
	\begin{equation}
		\mu(F)=\mu\bigg(\bigcup_{n=1}^{+\infty}A_n\bigg)=\sum_{n=1}^{+\infty}\mu(A_n).
	\end{equation}

	Dimostrato il caso dell'unione, è immediato verificare anche la tesi per l'intersezione dato che
	\begin{equation}
		\bigcap_{n=1}^{+\infty}A_n=\compl{\bigg(\bigcup_{n=1}^{+\infty}\compl{A_n}\bigg)}.
	\end{equation}
\end{proof}

Concludiamo la serie di teoremi con un corollario sulle successioni di insiemi monotone, da intendersi rispetto alle operazioni di inclusione: diremo che una successione $\{E_k\}_{k\in\N}$ di insiemi è \emph{crescente} se $A_k\subset A_{k+1}$ per ogni $k$, e analogamente diremo che è decrescente se $A_k\supseteq A_{k+1}$.
\begin{corollario} \label{cor:misura-successioni-insiemi}
	Sia $\{A_k\}_{k\in\N}$ una successione di insiemi misurabili:
	\begin{itemize}
		\item se la successione è crescente, allora
			\begin{equation}
				\mu\bigg(\bigcup_{k=1}^{+\infty}A_k\bigg)=\lim_{k\to+\infty}\mu(A_k);
			\end{equation}
		\item se la successione è decrescente, allora
			\begin{equation}
				\mu\bigg(\bigcap_{k=1}^{+\infty}A_k\bigg)=\lim_{k\to+\infty}\mu(A_k).
			\end{equation}
	\end{itemize}
\end{corollario}

Le proprietà dimostrate finora rendono la classe degli insiemi di $\R^n$ misurabili una \emph{$\sigma$-algebra}, ossia un insieme $\mathfrak S$ tale che
\begin{enumerate}
	\item l'insieme vuoto appartiene a $\mathfrak S$;
	\item se un insieme è in $\mathfrak S$, allora anche il suo complementare è in $\mathfrak S$;
	\item se gli elementi di una famiglia numerabile di insiemi $\{A_i\}_{i\in\N}$ sono in $\mathfrak S$, allora anche l'unione numerabile $\bigcup_{i\in\N}A_i$ appartiene a $\mathfrak S$.
\end{enumerate}
Se $\mathfrak S$ è una $\sigma$-algebra su un insieme $X$, la coppia $(X,\mathfrak S)$ si dice \emph{spazio misurabile}.
Dalla definizione segue immediatamente che in uno spazio misurabile
\begin{itemize}
	\item $X\in\mathfrak S$, in quanto complementare di $\emptyset$ rispetto a s\'e stesso;
	\item anche l'intersezione numerabile di insiemi di $\mathfrak S$ è un insieme di $\mathfrak S$, come visto nella dimostrazione della proprietà \ref{pr:additivita-numerabile-lebesgue} applicando le leggi di De Morgan;
	\item se due insiemi appartengono a $\mathfrak S$, anche la loro opportuna sottrazione vi appartiene.
\end{itemize}
Infine, dato uno spazio misurabile $(X,\mathfrak S)$ e una misura positiva $\lambda$ definita sulla $\sigma$-algebra $\mathfrak S$ (costituita dai sottoinsiemi misurabili di $X$), la terna $(X,\mathfrak S,\lambda)$ si chiama \emph{spazio di misura}.
Per quanto detto finora, la terna $\big(\R^n,\mis(\R^n),\mu\big)$ è proprio uno spazio di misura.
